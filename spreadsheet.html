<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="./vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SC Spreadsheet</title>
    <script type="module" crossorigin>(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))i(y);new MutationObserver(y=>{for(const h of y)if(h.type==="childList")for(const E of h.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&i(E)}).observe(document,{childList:!0,subtree:!0});function c(y){const h={};return y.integrity&&(h.integrity=y.integrity),y.referrerPolicy&&(h.referrerPolicy=y.referrerPolicy),y.crossOrigin==="use-credentials"?h.credentials="include":y.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function i(y){if(y.ep)return;y.ep=!0;const h=c(y);fetch(y.href,h)}})();function jE(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var rs={exports:{}},fr={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gE;function p0(){if(gE)return fr;gE=1;var r=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function c(i,y,h){var E=null;if(h!==void 0&&(E=""+h),y.key!==void 0&&(E=""+y.key),"key"in y){h={};for(var g in y)g!=="key"&&(h[g]=y[g])}else h=y;return y=h.ref,{$$typeof:r,type:i,key:E,ref:y!==void 0?y:null,props:h}}return fr.Fragment=s,fr.jsx=c,fr.jsxs=c,fr}var vE;function h0(){return vE||(vE=1,rs.exports=p0()),rs.exports}var N=h0(),us={exports:{}},he={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TE;function g0(){if(TE)return he;TE=1;var r=Symbol.for("react.transitional.element"),s=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),h=Symbol.for("react.consumer"),E=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),T=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),b=Symbol.iterator;function z(d){return d===null||typeof d!="object"?null:(d=b&&d[b]||d["@@iterator"],typeof d=="function"?d:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},K=Object.assign,k={};function O(d,C,U){this.props=d,this.context=C,this.refs=k,this.updater=U||F}O.prototype.isReactComponent={},O.prototype.setState=function(d,C){if(typeof d!="object"&&typeof d!="function"&&d!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,d,C,"setState")},O.prototype.forceUpdate=function(d){this.updater.enqueueForceUpdate(this,d,"forceUpdate")};function ee(){}ee.prototype=O.prototype;function le(d,C,U){this.props=d,this.context=C,this.refs=k,this.updater=U||F}var X=le.prototype=new ee;X.constructor=le,K(X,O.prototype),X.isPureReactComponent=!0;var se=Array.isArray,te={H:null,A:null,T:null,S:null,V:null},ye=Object.prototype.hasOwnProperty;function pe(d,C,U,L,q,Q){return U=Q.ref,{$$typeof:r,type:d,key:C,ref:U!==void 0?U:null,props:Q}}function me(d,C){return pe(d.type,C,void 0,void 0,void 0,d.props)}function xe(d){return typeof d=="object"&&d!==null&&d.$$typeof===r}function Ue(d){var C={"=":"=0",":":"=2"};return"$"+d.replace(/[=:]/g,function(U){return C[U]})}var ue=/\/+/g;function ie(d,C){return typeof d=="object"&&d!==null&&d.key!=null?Ue(""+d.key):C.toString(36)}function Z(){}function J(d){switch(d.status){case"fulfilled":return d.value;case"rejected":throw d.reason;default:switch(typeof d.status=="string"?d.then(Z,Z):(d.status="pending",d.then(function(C){d.status==="pending"&&(d.status="fulfilled",d.value=C)},function(C){d.status==="pending"&&(d.status="rejected",d.reason=C)})),d.status){case"fulfilled":return d.value;case"rejected":throw d.reason}}throw d}function B(d,C,U,L,q){var Q=typeof d;(Q==="undefined"||Q==="boolean")&&(d=null);var W=!1;if(d===null)W=!0;else switch(Q){case"bigint":case"string":case"number":W=!0;break;case"object":switch(d.$$typeof){case r:case s:W=!0;break;case D:return W=d._init,B(W(d._payload),C,U,L,q)}}if(W)return q=q(d),W=L===""?"."+ie(d,0):L,se(q)?(U="",W!=null&&(U=W.replace(ue,"$&/")+"/"),B(q,C,U,"",function(lt){return lt})):q!=null&&(xe(q)&&(q=me(q,U+(q.key==null||d&&d.key===q.key?"":(""+q.key).replace(ue,"$&/")+"/")+W)),C.push(q)),1;W=0;var Ve=L===""?".":L+":";if(se(d))for(var Me=0;Me<d.length;Me++)L=d[Me],Q=Ve+ie(L,Me),W+=B(L,C,U,Q,q);else if(Me=z(d),typeof Me=="function")for(d=Me.call(d),Me=0;!(L=d.next()).done;)L=L.value,Q=Ve+ie(L,Me++),W+=B(L,C,U,Q,q);else if(Q==="object"){if(typeof d.then=="function")return B(J(d),C,U,L,q);throw C=String(d),Error("Objects are not valid as a React child (found: "+(C==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":C)+"). If you meant to render a collection of children, use an array instead.")}return W}function A(d,C,U){if(d==null)return d;var L=[],q=0;return B(d,L,"","",function(Q){return C.call(U,Q,q++)}),L}function S(d){if(d._status===-1){var C=d._result;C=C(),C.then(function(U){(d._status===0||d._status===-1)&&(d._status=1,d._result=U)},function(U){(d._status===0||d._status===-1)&&(d._status=2,d._result=U)}),d._status===-1&&(d._status=0,d._result=C)}if(d._status===1)return d._result.default;throw d._result}var v=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var C=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(C))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)};function R(){}return he.Children={map:A,forEach:function(d,C,U){A(d,function(){C.apply(this,arguments)},U)},count:function(d){var C=0;return A(d,function(){C++}),C},toArray:function(d){return A(d,function(C){return C})||[]},only:function(d){if(!xe(d))throw Error("React.Children.only expected to receive a single React element child.");return d}},he.Component=O,he.Fragment=c,he.Profiler=y,he.PureComponent=le,he.StrictMode=i,he.Suspense=m,he.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=te,he.__COMPILER_RUNTIME={__proto__:null,c:function(d){return te.H.useMemoCache(d)}},he.cache=function(d){return function(){return d.apply(null,arguments)}},he.cloneElement=function(d,C,U){if(d==null)throw Error("The argument must be a React element, but you passed "+d+".");var L=K({},d.props),q=d.key,Q=void 0;if(C!=null)for(W in C.ref!==void 0&&(Q=void 0),C.key!==void 0&&(q=""+C.key),C)!ye.call(C,W)||W==="key"||W==="__self"||W==="__source"||W==="ref"&&C.ref===void 0||(L[W]=C[W]);var W=arguments.length-2;if(W===1)L.children=U;else if(1<W){for(var Ve=Array(W),Me=0;Me<W;Me++)Ve[Me]=arguments[Me+2];L.children=Ve}return pe(d.type,q,void 0,void 0,Q,L)},he.createContext=function(d){return d={$$typeof:E,_currentValue:d,_currentValue2:d,_threadCount:0,Provider:null,Consumer:null},d.Provider=d,d.Consumer={$$typeof:h,_context:d},d},he.createElement=function(d,C,U){var L,q={},Q=null;if(C!=null)for(L in C.key!==void 0&&(Q=""+C.key),C)ye.call(C,L)&&L!=="key"&&L!=="__self"&&L!=="__source"&&(q[L]=C[L]);var W=arguments.length-2;if(W===1)q.children=U;else if(1<W){for(var Ve=Array(W),Me=0;Me<W;Me++)Ve[Me]=arguments[Me+2];q.children=Ve}if(d&&d.defaultProps)for(L in W=d.defaultProps,W)q[L]===void 0&&(q[L]=W[L]);return pe(d,Q,void 0,void 0,null,q)},he.createRef=function(){return{current:null}},he.forwardRef=function(d){return{$$typeof:g,render:d}},he.isValidElement=xe,he.lazy=function(d){return{$$typeof:D,_payload:{_status:-1,_result:d},_init:S}},he.memo=function(d,C){return{$$typeof:T,type:d,compare:C===void 0?null:C}},he.startTransition=function(d){var C=te.T,U={};te.T=U;try{var L=d(),q=te.S;q!==null&&q(U,L),typeof L=="object"&&L!==null&&typeof L.then=="function"&&L.then(R,v)}catch(Q){v(Q)}finally{te.T=C}},he.unstable_useCacheRefresh=function(){return te.H.useCacheRefresh()},he.use=function(d){return te.H.use(d)},he.useActionState=function(d,C,U){return te.H.useActionState(d,C,U)},he.useCallback=function(d,C){return te.H.useCallback(d,C)},he.useContext=function(d){return te.H.useContext(d)},he.useDebugValue=function(){},he.useDeferredValue=function(d,C){return te.H.useDeferredValue(d,C)},he.useEffect=function(d,C,U){var L=te.H;if(typeof U=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return L.useEffect(d,C)},he.useId=function(){return te.H.useId()},he.useImperativeHandle=function(d,C,U){return te.H.useImperativeHandle(d,C,U)},he.useInsertionEffect=function(d,C){return te.H.useInsertionEffect(d,C)},he.useLayoutEffect=function(d,C){return te.H.useLayoutEffect(d,C)},he.useMemo=function(d,C){return te.H.useMemo(d,C)},he.useOptimistic=function(d,C){return te.H.useOptimistic(d,C)},he.useReducer=function(d,C,U){return te.H.useReducer(d,C,U)},he.useRef=function(d){return te.H.useRef(d)},he.useState=function(d){return te.H.useState(d)},he.useSyncExternalStore=function(d,C,U){return te.H.useSyncExternalStore(d,C,U)},he.useTransition=function(){return te.H.useTransition()},he.version="19.1.0",he}var RE;function Rs(){return RE||(RE=1,us.exports=g0()),us.exports}var re=Rs();const VE=jE(re);var cs={exports:{}},dr={},is={exports:{}},ss={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SE;function v0(){return SE||(SE=1,function(r){function s(A,S){var v=A.length;A.push(S);e:for(;0<v;){var R=v-1>>>1,d=A[R];if(0<y(d,S))A[R]=S,A[v]=d,v=R;else break e}}function c(A){return A.length===0?null:A[0]}function i(A){if(A.length===0)return null;var S=A[0],v=A.pop();if(v!==S){A[0]=v;e:for(var R=0,d=A.length,C=d>>>1;R<C;){var U=2*(R+1)-1,L=A[U],q=U+1,Q=A[q];if(0>y(L,v))q<d&&0>y(Q,L)?(A[R]=Q,A[q]=v,R=q):(A[R]=L,A[U]=v,R=U);else if(q<d&&0>y(Q,v))A[R]=Q,A[q]=v,R=q;else break e}}return S}function y(A,S){var v=A.sortIndex-S.sortIndex;return v!==0?v:A.id-S.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var h=performance;r.unstable_now=function(){return h.now()}}else{var E=Date,g=E.now();r.unstable_now=function(){return E.now()-g}}var m=[],T=[],D=1,b=null,z=3,F=!1,K=!1,k=!1,O=!1,ee=typeof setTimeout=="function"?setTimeout:null,le=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;function se(A){for(var S=c(T);S!==null;){if(S.callback===null)i(T);else if(S.startTime<=A)i(T),S.sortIndex=S.expirationTime,s(m,S);else break;S=c(T)}}function te(A){if(k=!1,se(A),!K)if(c(m)!==null)K=!0,ye||(ye=!0,ie());else{var S=c(T);S!==null&&B(te,S.startTime-A)}}var ye=!1,pe=-1,me=5,xe=-1;function Ue(){return O?!0:!(r.unstable_now()-xe<me)}function ue(){if(O=!1,ye){var A=r.unstable_now();xe=A;var S=!0;try{e:{K=!1,k&&(k=!1,le(pe),pe=-1),F=!0;var v=z;try{t:{for(se(A),b=c(m);b!==null&&!(b.expirationTime>A&&Ue());){var R=b.callback;if(typeof R=="function"){b.callback=null,z=b.priorityLevel;var d=R(b.expirationTime<=A);if(A=r.unstable_now(),typeof d=="function"){b.callback=d,se(A),S=!0;break t}b===c(m)&&i(m),se(A)}else i(m);b=c(m)}if(b!==null)S=!0;else{var C=c(T);C!==null&&B(te,C.startTime-A),S=!1}}break e}finally{b=null,z=v,F=!1}S=void 0}}finally{S?ie():ye=!1}}}var ie;if(typeof X=="function")ie=function(){X(ue)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,J=Z.port2;Z.port1.onmessage=ue,ie=function(){J.postMessage(null)}}else ie=function(){ee(ue,0)};function B(A,S){pe=ee(function(){A(r.unstable_now())},S)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(A){A.callback=null},r.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):me=0<A?Math.floor(1e3/A):5},r.unstable_getCurrentPriorityLevel=function(){return z},r.unstable_next=function(A){switch(z){case 1:case 2:case 3:var S=3;break;default:S=z}var v=z;z=S;try{return A()}finally{z=v}},r.unstable_requestPaint=function(){O=!0},r.unstable_runWithPriority=function(A,S){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var v=z;z=A;try{return S()}finally{z=v}},r.unstable_scheduleCallback=function(A,S,v){var R=r.unstable_now();switch(typeof v=="object"&&v!==null?(v=v.delay,v=typeof v=="number"&&0<v?R+v:R):v=R,A){case 1:var d=-1;break;case 2:d=250;break;case 5:d=1073741823;break;case 4:d=1e4;break;default:d=5e3}return d=v+d,A={id:D++,callback:S,priorityLevel:A,startTime:v,expirationTime:d,sortIndex:-1},v>R?(A.sortIndex=v,s(T,A),c(m)===null&&A===c(T)&&(k?(le(pe),pe=-1):k=!0,B(te,v-R))):(A.sortIndex=d,s(m,A),K||F||(K=!0,ye||(ye=!0,ie()))),A},r.unstable_shouldYield=Ue,r.unstable_wrapCallback=function(A){var S=z;return function(){var v=z;z=S;try{return A.apply(this,arguments)}finally{z=v}}}}(ss)),ss}var NE;function T0(){return NE||(NE=1,is.exports=v0()),is.exports}var os={exports:{}},vt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AE;function R0(){if(AE)return vt;AE=1;var r=Rs();function s(m){var T="https://react.dev/errors/"+m;if(1<arguments.length){T+="?args[]="+encodeURIComponent(arguments[1]);for(var D=2;D<arguments.length;D++)T+="&args[]="+encodeURIComponent(arguments[D])}return"Minified React error #"+m+"; visit "+T+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(){}var i={d:{f:c,r:function(){throw Error(s(522))},D:c,C:c,L:c,m:c,X:c,S:c,M:c},p:0,findDOMNode:null},y=Symbol.for("react.portal");function h(m,T,D){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:y,key:b==null?null:""+b,children:m,containerInfo:T,implementation:D}}var E=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(m,T){if(m==="font")return"";if(typeof T=="string")return T==="use-credentials"?T:""}return vt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,vt.createPortal=function(m,T){var D=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!T||T.nodeType!==1&&T.nodeType!==9&&T.nodeType!==11)throw Error(s(299));return h(m,T,null,D)},vt.flushSync=function(m){var T=E.T,D=i.p;try{if(E.T=null,i.p=2,m)return m()}finally{E.T=T,i.p=D,i.d.f()}},vt.preconnect=function(m,T){typeof m=="string"&&(T?(T=T.crossOrigin,T=typeof T=="string"?T==="use-credentials"?T:"":void 0):T=null,i.d.C(m,T))},vt.prefetchDNS=function(m){typeof m=="string"&&i.d.D(m)},vt.preinit=function(m,T){if(typeof m=="string"&&T&&typeof T.as=="string"){var D=T.as,b=g(D,T.crossOrigin),z=typeof T.integrity=="string"?T.integrity:void 0,F=typeof T.fetchPriority=="string"?T.fetchPriority:void 0;D==="style"?i.d.S(m,typeof T.precedence=="string"?T.precedence:void 0,{crossOrigin:b,integrity:z,fetchPriority:F}):D==="script"&&i.d.X(m,{crossOrigin:b,integrity:z,fetchPriority:F,nonce:typeof T.nonce=="string"?T.nonce:void 0})}},vt.preinitModule=function(m,T){if(typeof m=="string")if(typeof T=="object"&&T!==null){if(T.as==null||T.as==="script"){var D=g(T.as,T.crossOrigin);i.d.M(m,{crossOrigin:D,integrity:typeof T.integrity=="string"?T.integrity:void 0,nonce:typeof T.nonce=="string"?T.nonce:void 0})}}else T==null&&i.d.M(m)},vt.preload=function(m,T){if(typeof m=="string"&&typeof T=="object"&&T!==null&&typeof T.as=="string"){var D=T.as,b=g(D,T.crossOrigin);i.d.L(m,D,{crossOrigin:b,integrity:typeof T.integrity=="string"?T.integrity:void 0,nonce:typeof T.nonce=="string"?T.nonce:void 0,type:typeof T.type=="string"?T.type:void 0,fetchPriority:typeof T.fetchPriority=="string"?T.fetchPriority:void 0,referrerPolicy:typeof T.referrerPolicy=="string"?T.referrerPolicy:void 0,imageSrcSet:typeof T.imageSrcSet=="string"?T.imageSrcSet:void 0,imageSizes:typeof T.imageSizes=="string"?T.imageSizes:void 0,media:typeof T.media=="string"?T.media:void 0})}},vt.preloadModule=function(m,T){if(typeof m=="string")if(T){var D=g(T.as,T.crossOrigin);i.d.m(m,{as:typeof T.as=="string"&&T.as!=="script"?T.as:void 0,crossOrigin:D,integrity:typeof T.integrity=="string"?T.integrity:void 0})}else i.d.m(m)},vt.requestFormReset=function(m){i.d.r(m)},vt.unstable_batchedUpdates=function(m,T){return m(T)},vt.useFormState=function(m,T,D){return E.H.useFormState(m,T,D)},vt.useFormStatus=function(){return E.H.useHostTransitionStatus()},vt.version="19.1.0",vt}var bE;function S0(){if(bE)return os.exports;bE=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(s){console.error(s)}}return r(),os.exports=R0(),os.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CE;function N0(){if(CE)return dr;CE=1;var r=T0(),s=Rs(),c=S0();function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)t+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function y(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function h(e){var t=e,l=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(l=t.return),e=t.return;while(e)}return t.tag===3?l:null}function E(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(h(e)!==e)throw Error(i(188))}function m(e){var t=e.alternate;if(!t){if(t=h(e),t===null)throw Error(i(188));return t!==e?null:e}for(var l=e,n=t;;){var a=l.return;if(a===null)break;var u=a.alternate;if(u===null){if(n=a.return,n!==null){l=n;continue}break}if(a.child===u.child){for(u=a.child;u;){if(u===l)return g(a),e;if(u===n)return g(a),t;u=u.sibling}throw Error(i(188))}if(l.return!==n.return)l=a,n=u;else{for(var f=!1,p=a.child;p;){if(p===l){f=!0,l=a,n=u;break}if(p===n){f=!0,n=a,l=u;break}p=p.sibling}if(!f){for(p=u.child;p;){if(p===l){f=!0,l=u,n=a;break}if(p===n){f=!0,n=u,l=a;break}p=p.sibling}if(!f)throw Error(i(189))}}if(l.alternate!==n)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?e:t}function T(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=T(e),t!==null)return t;e=e.sibling}return null}var D=Object.assign,b=Symbol.for("react.element"),z=Symbol.for("react.transitional.element"),F=Symbol.for("react.portal"),K=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),ee=Symbol.for("react.provider"),le=Symbol.for("react.consumer"),X=Symbol.for("react.context"),se=Symbol.for("react.forward_ref"),te=Symbol.for("react.suspense"),ye=Symbol.for("react.suspense_list"),pe=Symbol.for("react.memo"),me=Symbol.for("react.lazy"),xe=Symbol.for("react.activity"),Ue=Symbol.for("react.memo_cache_sentinel"),ue=Symbol.iterator;function ie(e){return e===null||typeof e!="object"?null:(e=ue&&e[ue]||e["@@iterator"],typeof e=="function"?e:null)}var Z=Symbol.for("react.client.reference");function J(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Z?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case K:return"Fragment";case O:return"Profiler";case k:return"StrictMode";case te:return"Suspense";case ye:return"SuspenseList";case xe:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case F:return"Portal";case X:return(e.displayName||"Context")+".Provider";case le:return(e._context.displayName||"Context")+".Consumer";case se:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case pe:return t=e.displayName||null,t!==null?t:J(e.type)||"Memo";case me:t=e._payload,e=e._init;try{return J(e(t))}catch{}}return null}var B=Array.isArray,A=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,S=c.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,v={pending:!1,data:null,method:null,action:null},R=[],d=-1;function C(e){return{current:e}}function U(e){0>d||(e.current=R[d],R[d]=null,d--)}function L(e,t){d++,R[d]=e.current,e.current=t}var q=C(null),Q=C(null),W=C(null),Ve=C(null);function Me(e,t){switch(L(W,t),L(Q,e),L(q,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Fd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Fd(t),e=Zd(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(q),L(q,e)}function lt(){U(q),U(Q),U(W)}function mt(e){e.memoizedState!==null&&L(Ve,e);var t=q.current,l=Zd(t,e.type);t!==l&&(L(Q,e),L(q,l))}function Re(e){Q.current===e&&(U(q),U(Q)),Ve.current===e&&(U(Ve),ur._currentValue=v)}var Fe=Object.prototype.hasOwnProperty,P=r.unstable_scheduleCallback,ge=r.unstable_cancelCallback,de=r.unstable_shouldYield,Se=r.unstable_requestPaint,Oe=r.unstable_now,We=r.unstable_getCurrentPriorityLevel,Xe=r.unstable_ImmediatePriority,Ht=r.unstable_UserBlockingPriority,pt=r.unstable_NormalPriority,Ml=r.unstable_LowPriority,Ze=r.unstable_IdlePriority,rt=r.log,An=r.unstable_setDisableYieldValue,tn=null,ot=null;function Tt(e){if(typeof rt=="function"&&An(e),ot&&typeof ot.setStrictMode=="function")try{ot.setStrictMode(tn,e)}catch{}}var ft=Math.clz32?Math.clz32:ly,Zu=Math.log,ty=Math.LN2;function ly(e){return e>>>=0,e===0?32:31-(Zu(e)/ty|0)|0}var Rr=256,Sr=4194304;function ln(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Nr(e,t,l){var n=e.pendingLanes;if(n===0)return 0;var a=0,u=e.suspendedLanes,f=e.pingedLanes;e=e.warmLanes;var p=n&134217727;return p!==0?(n=p&~u,n!==0?a=ln(n):(f&=p,f!==0?a=ln(f):l||(l=p&~e,l!==0&&(a=ln(l))))):(p=n&~u,p!==0?a=ln(p):f!==0?a=ln(f):l||(l=n&~e,l!==0&&(a=ln(l)))),a===0?0:t!==0&&t!==a&&(t&u)===0&&(u=a&-a,l=t&-t,u>=l||u===32&&(l&4194048)!==0)?t:a}function ma(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function ny(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ms(){var e=Rr;return Rr<<=1,(Rr&4194048)===0&&(Rr=256),e}function Os(){var e=Sr;return Sr<<=1,(Sr&62914560)===0&&(Sr=4194304),e}function Qu(e){for(var t=[],l=0;31>l;l++)t.push(e);return t}function pa(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ay(e,t,l,n,a,u){var f=e.pendingLanes;e.pendingLanes=l,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=l,e.entangledLanes&=l,e.errorRecoveryDisabledLanes&=l,e.shellSuspendCounter=0;var p=e.entanglements,M=e.expirationTimes,I=e.hiddenUpdates;for(l=f&~l;0<l;){var j=31-ft(l),G=1<<j;p[j]=0,M[j]=-1;var Y=I[j];if(Y!==null)for(I[j]=null,j=0;j<Y.length;j++){var H=Y[j];H!==null&&(H.lane&=-536870913)}l&=~G}n!==0&&_s(e,n,0),u!==0&&a===0&&e.tag!==0&&(e.suspendedLanes|=u&~(f&~t))}function _s(e,t,l){e.pendingLanes|=t,e.suspendedLanes&=~t;var n=31-ft(t);e.entangledLanes|=t,e.entanglements[n]=e.entanglements[n]|1073741824|l&4194090}function Ds(e,t){var l=e.entangledLanes|=t;for(e=e.entanglements;l;){var n=31-ft(l),a=1<<n;a&t|e[n]&t&&(e[n]|=t),l&=~a}}function ku(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ku(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function xs(){var e=S.p;return e!==0?e:(e=window.event,e===void 0?32:dE(e.type))}function ry(e,t){var l=S.p;try{return S.p=e,t()}finally{S.p=l}}var Ol=Math.random().toString(36).slice(2),ht="__reactFiber$"+Ol,Nt="__reactProps$"+Ol,bn="__reactContainer$"+Ol,Ju="__reactEvents$"+Ol,uy="__reactListeners$"+Ol,cy="__reactHandles$"+Ol,Us="__reactResources$"+Ol,ha="__reactMarker$"+Ol;function Wu(e){delete e[ht],delete e[Nt],delete e[Ju],delete e[uy],delete e[cy]}function Cn(e){var t=e[ht];if(t)return t;for(var l=e.parentNode;l;){if(t=l[bn]||l[ht]){if(l=t.alternate,t.child!==null||l!==null&&l.child!==null)for(e=Jd(e);e!==null;){if(l=e[ht])return l;e=Jd(e)}return t}e=l,l=e.parentNode}return null}function Mn(e){if(e=e[ht]||e[bn]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function ga(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(i(33))}function On(e){var t=e[Us];return t||(t=e[Us]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function ut(e){e[ha]=!0}var ws=new Set,Ls={};function nn(e,t){_n(e,t),_n(e+"Capture",t)}function _n(e,t){for(Ls[e]=t,e=0;e<t.length;e++)ws.add(t[e])}var iy=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Is={},Ys={};function sy(e){return Fe.call(Ys,e)?!0:Fe.call(Is,e)?!1:iy.test(e)?Ys[e]=!0:(Is[e]=!0,!1)}function Ar(e,t,l){if(sy(t))if(l===null)e.removeAttribute(t);else{switch(typeof l){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var n=t.toLowerCase().slice(0,5);if(n!=="data-"&&n!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+l)}}function br(e,t,l){if(l===null)e.removeAttribute(t);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+l)}}function fl(e,t,l,n){if(n===null)e.removeAttribute(l);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(l);return}e.setAttributeNS(t,l,""+n)}}var Pu,Hs;function Dn(e){if(Pu===void 0)try{throw Error()}catch(l){var t=l.stack.trim().match(/\n( *(at )?)/);Pu=t&&t[1]||"",Hs=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Pu+e+Hs}var ec=!1;function tc(e,t){if(!e||ec)return"";ec=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(t){var G=function(){throw Error()};if(Object.defineProperty(G.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(G,[])}catch(H){var Y=H}Reflect.construct(e,[],G)}else{try{G.call()}catch(H){Y=H}e.call(G.prototype)}}else{try{throw Error()}catch(H){Y=H}(G=e())&&typeof G.catch=="function"&&G.catch(function(){})}}catch(H){if(H&&Y&&typeof H.stack=="string")return[H.stack,Y.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var u=n.DetermineComponentFrameRoot(),f=u[0],p=u[1];if(f&&p){var M=f.split(`
`),I=p.split(`
`);for(a=n=0;n<M.length&&!M[n].includes("DetermineComponentFrameRoot");)n++;for(;a<I.length&&!I[a].includes("DetermineComponentFrameRoot");)a++;if(n===M.length||a===I.length)for(n=M.length-1,a=I.length-1;1<=n&&0<=a&&M[n]!==I[a];)a--;for(;1<=n&&0<=a;n--,a--)if(M[n]!==I[a]){if(n!==1||a!==1)do if(n--,a--,0>a||M[n]!==I[a]){var j=`
`+M[n].replace(" at new "," at ");return e.displayName&&j.includes("<anonymous>")&&(j=j.replace("<anonymous>",e.displayName)),j}while(1<=n&&0<=a);break}}}finally{ec=!1,Error.prepareStackTrace=l}return(l=e?e.displayName||e.name:"")?Dn(l):""}function oy(e){switch(e.tag){case 26:case 27:case 5:return Dn(e.type);case 16:return Dn("Lazy");case 13:return Dn("Suspense");case 19:return Dn("SuspenseList");case 0:case 15:return tc(e.type,!1);case 11:return tc(e.type.render,!1);case 1:return tc(e.type,!0);case 31:return Dn("Activity");default:return""}}function zs(e){try{var t="";do t+=oy(e),e=e.return;while(e);return t}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function zt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function js(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function fy(e){var t=js(e)?"checked":"value",l=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var a=l.get,u=l.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(f){n=""+f,u.call(this,f)}}),Object.defineProperty(e,t,{enumerable:l.enumerable}),{getValue:function(){return n},setValue:function(f){n=""+f},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Cr(e){e._valueTracker||(e._valueTracker=fy(e))}function Vs(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var l=t.getValue(),n="";return e&&(n=js(e)?e.checked?"true":"false":e.value),e=n,e!==l?(t.setValue(e),!0):!1}function Mr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var dy=/[\n"\\]/g;function jt(e){return e.replace(dy,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function lc(e,t,l,n,a,u,f,p){e.name="",f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"?e.type=f:e.removeAttribute("type"),t!=null?f==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+zt(t)):e.value!==""+zt(t)&&(e.value=""+zt(t)):f!=="submit"&&f!=="reset"||e.removeAttribute("value"),t!=null?nc(e,f,zt(t)):l!=null?nc(e,f,zt(l)):n!=null&&e.removeAttribute("value"),a==null&&u!=null&&(e.defaultChecked=!!u),a!=null&&(e.checked=a&&typeof a!="function"&&typeof a!="symbol"),p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"?e.name=""+zt(p):e.removeAttribute("name")}function Gs(e,t,l,n,a,u,f,p){if(u!=null&&typeof u!="function"&&typeof u!="symbol"&&typeof u!="boolean"&&(e.type=u),t!=null||l!=null){if(!(u!=="submit"&&u!=="reset"||t!=null))return;l=l!=null?""+zt(l):"",t=t!=null?""+zt(t):l,p||t===e.value||(e.value=t),e.defaultValue=t}n=n??a,n=typeof n!="function"&&typeof n!="symbol"&&!!n,e.checked=p?e.checked:!!n,e.defaultChecked=!!n,f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(e.name=f)}function nc(e,t,l){t==="number"&&Mr(e.ownerDocument)===e||e.defaultValue===""+l||(e.defaultValue=""+l)}function xn(e,t,l,n){if(e=e.options,t){t={};for(var a=0;a<l.length;a++)t["$"+l[a]]=!0;for(l=0;l<e.length;l++)a=t.hasOwnProperty("$"+e[l].value),e[l].selected!==a&&(e[l].selected=a),a&&n&&(e[l].defaultSelected=!0)}else{for(l=""+zt(l),t=null,a=0;a<e.length;a++){if(e[a].value===l){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function $s(e,t,l){if(t!=null&&(t=""+zt(t),t!==e.value&&(e.value=t),l==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=l!=null?""+zt(l):""}function qs(e,t,l,n){if(t==null){if(n!=null){if(l!=null)throw Error(i(92));if(B(n)){if(1<n.length)throw Error(i(93));n=n[0]}l=n}l==null&&(l=""),t=l}l=zt(t),e.defaultValue=l,n=e.textContent,n===l&&n!==""&&n!==null&&(e.value=n)}function Un(e,t){if(t){var l=e.firstChild;if(l&&l===e.lastChild&&l.nodeType===3){l.nodeValue=t;return}}e.textContent=t}var Ey=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Xs(e,t,l){var n=t.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?n?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":n?e.setProperty(t,l):typeof l!="number"||l===0||Ey.has(t)?t==="float"?e.cssFloat=l:e[t]=(""+l).trim():e[t]=l+"px"}function Bs(e,t,l){if(t!=null&&typeof t!="object")throw Error(i(62));if(e=e.style,l!=null){for(var n in l)!l.hasOwnProperty(n)||t!=null&&t.hasOwnProperty(n)||(n.indexOf("--")===0?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="");for(var a in t)n=t[a],t.hasOwnProperty(a)&&l[a]!==n&&Xs(e,a,n)}else for(var u in t)t.hasOwnProperty(u)&&Xs(e,u,t[u])}function ac(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yy=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),my=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Or(e){return my.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var rc=null;function uc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var wn=null,Ln=null;function Fs(e){var t=Mn(e);if(t&&(e=t.stateNode)){var l=e[Nt]||null;e:switch(e=t.stateNode,t.type){case"input":if(lc(e,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),t=l.name,l.type==="radio"&&t!=null){for(l=e;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+jt(""+t)+'"][type="radio"]'),t=0;t<l.length;t++){var n=l[t];if(n!==e&&n.form===e.form){var a=n[Nt]||null;if(!a)throw Error(i(90));lc(n,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<l.length;t++)n=l[t],n.form===e.form&&Vs(n)}break e;case"textarea":$s(e,l.value,l.defaultValue);break e;case"select":t=l.value,t!=null&&xn(e,!!l.multiple,t,!1)}}}var cc=!1;function Zs(e,t,l){if(cc)return e(t,l);cc=!0;try{var n=e(t);return n}finally{if(cc=!1,(wn!==null||Ln!==null)&&(Eu(),wn&&(t=wn,e=Ln,Ln=wn=null,Fs(t),e)))for(t=0;t<e.length;t++)Fs(e[t])}}function va(e,t){var l=e.stateNode;if(l===null)return null;var n=l[Nt]||null;if(n===null)return null;l=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(l&&typeof l!="function")throw Error(i(231,t,typeof l));return l}var dl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ic=!1;if(dl)try{var Ta={};Object.defineProperty(Ta,"passive",{get:function(){ic=!0}}),window.addEventListener("test",Ta,Ta),window.removeEventListener("test",Ta,Ta)}catch{ic=!1}var _l=null,sc=null,_r=null;function Qs(){if(_r)return _r;var e,t=sc,l=t.length,n,a="value"in _l?_l.value:_l.textContent,u=a.length;for(e=0;e<l&&t[e]===a[e];e++);var f=l-e;for(n=1;n<=f&&t[l-n]===a[u-n];n++);return _r=a.slice(e,1<n?1-n:void 0)}function Dr(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function xr(){return!0}function ks(){return!1}function At(e){function t(l,n,a,u,f){this._reactName=l,this._targetInst=a,this.type=n,this.nativeEvent=u,this.target=f,this.currentTarget=null;for(var p in e)e.hasOwnProperty(p)&&(l=e[p],this[p]=l?l(u):u[p]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?xr:ks,this.isPropagationStopped=ks,this}return D(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=xr)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=xr)},persist:function(){},isPersistent:xr}),t}var an={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ur=At(an),Ra=D({},an,{view:0,detail:0}),py=At(Ra),oc,fc,Sa,wr=D({},Ra,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ec,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Sa&&(Sa&&e.type==="mousemove"?(oc=e.screenX-Sa.screenX,fc=e.screenY-Sa.screenY):fc=oc=0,Sa=e),oc)},movementY:function(e){return"movementY"in e?e.movementY:fc}}),Ks=At(wr),hy=D({},wr,{dataTransfer:0}),gy=At(hy),vy=D({},Ra,{relatedTarget:0}),dc=At(vy),Ty=D({},an,{animationName:0,elapsedTime:0,pseudoElement:0}),Ry=At(Ty),Sy=D({},an,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ny=At(Sy),Ay=D({},an,{data:0}),Js=At(Ay),by={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},My={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Oy(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=My[e])?!!t[e]:!1}function Ec(){return Oy}var _y=D({},Ra,{key:function(e){if(e.key){var t=by[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Dr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Cy[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ec,charCode:function(e){return e.type==="keypress"?Dr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Dr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Dy=At(_y),xy=D({},wr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ws=At(xy),Uy=D({},Ra,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ec}),wy=At(Uy),Ly=D({},an,{propertyName:0,elapsedTime:0,pseudoElement:0}),Iy=At(Ly),Yy=D({},wr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Hy=At(Yy),zy=D({},an,{newState:0,oldState:0}),jy=At(zy),Vy=[9,13,27,32],yc=dl&&"CompositionEvent"in window,Na=null;dl&&"documentMode"in document&&(Na=document.documentMode);var Gy=dl&&"TextEvent"in window&&!Na,Ps=dl&&(!yc||Na&&8<Na&&11>=Na),eo=" ",to=!1;function lo(e,t){switch(e){case"keyup":return Vy.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function no(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var In=!1;function $y(e,t){switch(e){case"compositionend":return no(t);case"keypress":return t.which!==32?null:(to=!0,eo);case"textInput":return e=t.data,e===eo&&to?null:e;default:return null}}function qy(e,t){if(In)return e==="compositionend"||!yc&&lo(e,t)?(e=Qs(),_r=sc=_l=null,In=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ps&&t.locale!=="ko"?null:t.data;default:return null}}var Xy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ao(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Xy[e.type]:t==="textarea"}function ro(e,t,l,n){wn?Ln?Ln.push(n):Ln=[n]:wn=n,t=vu(t,"onChange"),0<t.length&&(l=new Ur("onChange","change",null,l,n),e.push({event:l,listeners:t}))}var Aa=null,ba=null;function By(e){Gd(e,0)}function Lr(e){var t=ga(e);if(Vs(t))return e}function uo(e,t){if(e==="change")return t}var co=!1;if(dl){var mc;if(dl){var pc="oninput"in document;if(!pc){var io=document.createElement("div");io.setAttribute("oninput","return;"),pc=typeof io.oninput=="function"}mc=pc}else mc=!1;co=mc&&(!document.documentMode||9<document.documentMode)}function so(){Aa&&(Aa.detachEvent("onpropertychange",oo),ba=Aa=null)}function oo(e){if(e.propertyName==="value"&&Lr(ba)){var t=[];ro(t,ba,e,uc(e)),Zs(By,t)}}function Fy(e,t,l){e==="focusin"?(so(),Aa=t,ba=l,Aa.attachEvent("onpropertychange",oo)):e==="focusout"&&so()}function Zy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Lr(ba)}function Qy(e,t){if(e==="click")return Lr(t)}function ky(e,t){if(e==="input"||e==="change")return Lr(t)}function Ky(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Dt=typeof Object.is=="function"?Object.is:Ky;function Ca(e,t){if(Dt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var l=Object.keys(e),n=Object.keys(t);if(l.length!==n.length)return!1;for(n=0;n<l.length;n++){var a=l[n];if(!Fe.call(t,a)||!Dt(e[a],t[a]))return!1}return!0}function fo(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Eo(e,t){var l=fo(e);e=0;for(var n;l;){if(l.nodeType===3){if(n=e+l.textContent.length,e<=t&&n>=t)return{node:l,offset:t-e};e=n}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=fo(l)}}function yo(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?yo(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function mo(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Mr(e.document);t instanceof e.HTMLIFrameElement;){try{var l=typeof t.contentWindow.location.href=="string"}catch{l=!1}if(l)e=t.contentWindow;else break;t=Mr(e.document)}return t}function hc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Jy=dl&&"documentMode"in document&&11>=document.documentMode,Yn=null,gc=null,Ma=null,vc=!1;function po(e,t,l){var n=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;vc||Yn==null||Yn!==Mr(n)||(n=Yn,"selectionStart"in n&&hc(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ma&&Ca(Ma,n)||(Ma=n,n=vu(gc,"onSelect"),0<n.length&&(t=new Ur("onSelect","select",null,t,l),e.push({event:t,listeners:n}),t.target=Yn)))}function rn(e,t){var l={};return l[e.toLowerCase()]=t.toLowerCase(),l["Webkit"+e]="webkit"+t,l["Moz"+e]="moz"+t,l}var Hn={animationend:rn("Animation","AnimationEnd"),animationiteration:rn("Animation","AnimationIteration"),animationstart:rn("Animation","AnimationStart"),transitionrun:rn("Transition","TransitionRun"),transitionstart:rn("Transition","TransitionStart"),transitioncancel:rn("Transition","TransitionCancel"),transitionend:rn("Transition","TransitionEnd")},Tc={},ho={};dl&&(ho=document.createElement("div").style,"AnimationEvent"in window||(delete Hn.animationend.animation,delete Hn.animationiteration.animation,delete Hn.animationstart.animation),"TransitionEvent"in window||delete Hn.transitionend.transition);function un(e){if(Tc[e])return Tc[e];if(!Hn[e])return e;var t=Hn[e],l;for(l in t)if(t.hasOwnProperty(l)&&l in ho)return Tc[e]=t[l];return e}var go=un("animationend"),vo=un("animationiteration"),To=un("animationstart"),Wy=un("transitionrun"),Py=un("transitionstart"),em=un("transitioncancel"),Ro=un("transitionend"),So=new Map,Rc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Rc.push("scrollEnd");function Kt(e,t){So.set(e,t),nn(t,[e])}var No=new WeakMap;function Vt(e,t){if(typeof e=="object"&&e!==null){var l=No.get(e);return l!==void 0?l:(t={value:e,source:t,stack:zs(t)},No.set(e,t),t)}return{value:e,source:t,stack:zs(t)}}var Gt=[],zn=0,Sc=0;function Ir(){for(var e=zn,t=Sc=zn=0;t<e;){var l=Gt[t];Gt[t++]=null;var n=Gt[t];Gt[t++]=null;var a=Gt[t];Gt[t++]=null;var u=Gt[t];if(Gt[t++]=null,n!==null&&a!==null){var f=n.pending;f===null?a.next=a:(a.next=f.next,f.next=a),n.pending=a}u!==0&&Ao(l,a,u)}}function Yr(e,t,l,n){Gt[zn++]=e,Gt[zn++]=t,Gt[zn++]=l,Gt[zn++]=n,Sc|=n,e.lanes|=n,e=e.alternate,e!==null&&(e.lanes|=n)}function Nc(e,t,l,n){return Yr(e,t,l,n),Hr(e)}function jn(e,t){return Yr(e,null,null,t),Hr(e)}function Ao(e,t,l){e.lanes|=l;var n=e.alternate;n!==null&&(n.lanes|=l);for(var a=!1,u=e.return;u!==null;)u.childLanes|=l,n=u.alternate,n!==null&&(n.childLanes|=l),u.tag===22&&(e=u.stateNode,e===null||e._visibility&1||(a=!0)),e=u,u=u.return;return e.tag===3?(u=e.stateNode,a&&t!==null&&(a=31-ft(l),e=u.hiddenUpdates,n=e[a],n===null?e[a]=[t]:n.push(t),t.lane=l|536870912),u):null}function Hr(e){if(50<Wa)throw Wa=0,_i=null,Error(i(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Vn={};function tm(e,t,l,n){this.tag=e,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xt(e,t,l,n){return new tm(e,t,l,n)}function Ac(e){return e=e.prototype,!(!e||!e.isReactComponent)}function El(e,t){var l=e.alternate;return l===null?(l=xt(e.tag,t,e.key,e.mode),l.elementType=e.elementType,l.type=e.type,l.stateNode=e.stateNode,l.alternate=e,e.alternate=l):(l.pendingProps=t,l.type=e.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=e.flags&65011712,l.childLanes=e.childLanes,l.lanes=e.lanes,l.child=e.child,l.memoizedProps=e.memoizedProps,l.memoizedState=e.memoizedState,l.updateQueue=e.updateQueue,t=e.dependencies,l.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},l.sibling=e.sibling,l.index=e.index,l.ref=e.ref,l.refCleanup=e.refCleanup,l}function bo(e,t){e.flags&=65011714;var l=e.alternate;return l===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=l.childLanes,e.lanes=l.lanes,e.child=l.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=l.memoizedProps,e.memoizedState=l.memoizedState,e.updateQueue=l.updateQueue,e.type=l.type,t=l.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function zr(e,t,l,n,a,u){var f=0;if(n=e,typeof e=="function")Ac(e)&&(f=1);else if(typeof e=="string")f=n0(e,l,q.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case xe:return e=xt(31,l,t,a),e.elementType=xe,e.lanes=u,e;case K:return cn(l.children,a,u,t);case k:f=8,a|=24;break;case O:return e=xt(12,l,t,a|2),e.elementType=O,e.lanes=u,e;case te:return e=xt(13,l,t,a),e.elementType=te,e.lanes=u,e;case ye:return e=xt(19,l,t,a),e.elementType=ye,e.lanes=u,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ee:case X:f=10;break e;case le:f=9;break e;case se:f=11;break e;case pe:f=14;break e;case me:f=16,n=null;break e}f=29,l=Error(i(130,e===null?"null":typeof e,"")),n=null}return t=xt(f,l,t,a),t.elementType=e,t.type=n,t.lanes=u,t}function cn(e,t,l,n){return e=xt(7,e,n,t),e.lanes=l,e}function bc(e,t,l){return e=xt(6,e,null,t),e.lanes=l,e}function Cc(e,t,l){return t=xt(4,e.children!==null?e.children:[],e.key,t),t.lanes=l,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Gn=[],$n=0,jr=null,Vr=0,$t=[],qt=0,sn=null,yl=1,ml="";function on(e,t){Gn[$n++]=Vr,Gn[$n++]=jr,jr=e,Vr=t}function Co(e,t,l){$t[qt++]=yl,$t[qt++]=ml,$t[qt++]=sn,sn=e;var n=yl;e=ml;var a=32-ft(n)-1;n&=~(1<<a),l+=1;var u=32-ft(t)+a;if(30<u){var f=a-a%5;u=(n&(1<<f)-1).toString(32),n>>=f,a-=f,yl=1<<32-ft(t)+a|l<<a|n,ml=u+e}else yl=1<<u|l<<a|n,ml=e}function Mc(e){e.return!==null&&(on(e,1),Co(e,1,0))}function Oc(e){for(;e===jr;)jr=Gn[--$n],Gn[$n]=null,Vr=Gn[--$n],Gn[$n]=null;for(;e===sn;)sn=$t[--qt],$t[qt]=null,ml=$t[--qt],$t[qt]=null,yl=$t[--qt],$t[qt]=null}var Rt=null,Qe=null,we=!1,fn=null,Pt=!1,_c=Error(i(519));function dn(e){var t=Error(i(418,""));throw Da(Vt(t,e)),_c}function Mo(e){var t=e.stateNode,l=e.type,n=e.memoizedProps;switch(t[ht]=e,t[Nt]=n,l){case"dialog":Ae("cancel",t),Ae("close",t);break;case"iframe":case"object":case"embed":Ae("load",t);break;case"video":case"audio":for(l=0;l<er.length;l++)Ae(er[l],t);break;case"source":Ae("error",t);break;case"img":case"image":case"link":Ae("error",t),Ae("load",t);break;case"details":Ae("toggle",t);break;case"input":Ae("invalid",t),Gs(t,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0),Cr(t);break;case"select":Ae("invalid",t);break;case"textarea":Ae("invalid",t),qs(t,n.value,n.defaultValue,n.children),Cr(t)}l=n.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||t.textContent===""+l||n.suppressHydrationWarning===!0||Bd(t.textContent,l)?(n.popover!=null&&(Ae("beforetoggle",t),Ae("toggle",t)),n.onScroll!=null&&Ae("scroll",t),n.onScrollEnd!=null&&Ae("scrollend",t),n.onClick!=null&&(t.onclick=Tu),t=!0):t=!1,t||dn(e)}function Oo(e){for(Rt=e.return;Rt;)switch(Rt.tag){case 5:case 13:Pt=!1;return;case 27:case 3:Pt=!0;return;default:Rt=Rt.return}}function Oa(e){if(e!==Rt)return!1;if(!we)return Oo(e),we=!0,!1;var t=e.tag,l;if((l=t!==3&&t!==27)&&((l=t===5)&&(l=e.type,l=!(l!=="form"&&l!=="button")||Bi(e.type,e.memoizedProps)),l=!l),l&&Qe&&dn(e),Oo(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(l=e.data,l==="/$"){if(t===0){Qe=Wt(e.nextSibling);break e}t--}else l!=="$"&&l!=="$!"&&l!=="$?"||t++;e=e.nextSibling}Qe=null}}else t===27?(t=Qe,Bl(e.type)?(e=ki,ki=null,Qe=e):Qe=t):Qe=Rt?Wt(e.stateNode.nextSibling):null;return!0}function _a(){Qe=Rt=null,we=!1}function _o(){var e=fn;return e!==null&&(Mt===null?Mt=e:Mt.push.apply(Mt,e),fn=null),e}function Da(e){fn===null?fn=[e]:fn.push(e)}var Dc=C(null),En=null,pl=null;function Dl(e,t,l){L(Dc,t._currentValue),t._currentValue=l}function hl(e){e._currentValue=Dc.current,U(Dc)}function xc(e,t,l){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===l)break;e=e.return}}function Uc(e,t,l,n){var a=e.child;for(a!==null&&(a.return=e);a!==null;){var u=a.dependencies;if(u!==null){var f=a.child;u=u.firstContext;e:for(;u!==null;){var p=u;u=a;for(var M=0;M<t.length;M++)if(p.context===t[M]){u.lanes|=l,p=u.alternate,p!==null&&(p.lanes|=l),xc(u.return,l,e),n||(f=null);break e}u=p.next}}else if(a.tag===18){if(f=a.return,f===null)throw Error(i(341));f.lanes|=l,u=f.alternate,u!==null&&(u.lanes|=l),xc(f,l,e),f=null}else f=a.child;if(f!==null)f.return=a;else for(f=a;f!==null;){if(f===e){f=null;break}if(a=f.sibling,a!==null){a.return=f.return,f=a;break}f=f.return}a=f}}function xa(e,t,l,n){e=null;for(var a=t,u=!1;a!==null;){if(!u){if((a.flags&524288)!==0)u=!0;else if((a.flags&262144)!==0)break}if(a.tag===10){var f=a.alternate;if(f===null)throw Error(i(387));if(f=f.memoizedProps,f!==null){var p=a.type;Dt(a.pendingProps.value,f.value)||(e!==null?e.push(p):e=[p])}}else if(a===Ve.current){if(f=a.alternate,f===null)throw Error(i(387));f.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(e!==null?e.push(ur):e=[ur])}a=a.return}e!==null&&Uc(t,e,l,n),t.flags|=262144}function Gr(e){for(e=e.firstContext;e!==null;){if(!Dt(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function yn(e){En=e,pl=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function gt(e){return Do(En,e)}function $r(e,t){return En===null&&yn(e),Do(e,t)}function Do(e,t){var l=t._currentValue;if(t={context:t,memoizedValue:l,next:null},pl===null){if(e===null)throw Error(i(308));pl=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else pl=pl.next=t;return l}var lm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(l,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(l){return l()})}},nm=r.unstable_scheduleCallback,am=r.unstable_NormalPriority,nt={$$typeof:X,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function wc(){return{controller:new lm,data:new Map,refCount:0}}function Ua(e){e.refCount--,e.refCount===0&&nm(am,function(){e.controller.abort()})}var wa=null,Lc=0,qn=0,Xn=null;function rm(e,t){if(wa===null){var l=wa=[];Lc=0,qn=Yi(),Xn={status:"pending",value:void 0,then:function(n){l.push(n)}}}return Lc++,t.then(xo,xo),t}function xo(){if(--Lc===0&&wa!==null){Xn!==null&&(Xn.status="fulfilled");var e=wa;wa=null,qn=0,Xn=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function um(e,t){var l=[],n={status:"pending",value:null,reason:null,then:function(a){l.push(a)}};return e.then(function(){n.status="fulfilled",n.value=t;for(var a=0;a<l.length;a++)(0,l[a])(t)},function(a){for(n.status="rejected",n.reason=a,a=0;a<l.length;a++)(0,l[a])(void 0)}),n}var Uo=A.S;A.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&rm(e,t),Uo!==null&&Uo(e,t)};var mn=C(null);function Ic(){var e=mn.current;return e!==null?e:$e.pooledCache}function qr(e,t){t===null?L(mn,mn.current):L(mn,t.pool)}function wo(){var e=Ic();return e===null?null:{parent:nt._currentValue,pool:e}}var La=Error(i(460)),Lo=Error(i(474)),Xr=Error(i(542)),Yc={then:function(){}};function Io(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Br(){}function Yo(e,t,l){switch(l=e[l],l===void 0?e.push(t):l!==t&&(t.then(Br,Br),t=l),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,zo(e),e;default:if(typeof t.status=="string")t.then(Br,Br);else{if(e=$e,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=t,e.status="pending",e.then(function(n){if(t.status==="pending"){var a=t;a.status="fulfilled",a.value=n}},function(n){if(t.status==="pending"){var a=t;a.status="rejected",a.reason=n}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,zo(e),e}throw Ia=t,La}}var Ia=null;function Ho(){if(Ia===null)throw Error(i(459));var e=Ia;return Ia=null,e}function zo(e){if(e===La||e===Xr)throw Error(i(483))}var xl=!1;function Hc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function zc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Ul(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function wl(e,t,l){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,(Ie&2)!==0){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,t=Hr(e),Ao(e,null,l),t}return Yr(e,n,t,l),Hr(e)}function Ya(e,t,l){if(t=t.updateQueue,t!==null&&(t=t.shared,(l&4194048)!==0)){var n=t.lanes;n&=e.pendingLanes,l|=n,t.lanes=l,Ds(e,l)}}function jc(e,t){var l=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,l===n)){var a=null,u=null;if(l=l.firstBaseUpdate,l!==null){do{var f={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};u===null?a=u=f:u=u.next=f,l=l.next}while(l!==null);u===null?a=u=t:u=u.next=t}else a=u=t;l={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:u,shared:n.shared,callbacks:n.callbacks},e.updateQueue=l;return}e=l.lastBaseUpdate,e===null?l.firstBaseUpdate=t:e.next=t,l.lastBaseUpdate=t}var Vc=!1;function Ha(){if(Vc){var e=Xn;if(e!==null)throw e}}function za(e,t,l,n){Vc=!1;var a=e.updateQueue;xl=!1;var u=a.firstBaseUpdate,f=a.lastBaseUpdate,p=a.shared.pending;if(p!==null){a.shared.pending=null;var M=p,I=M.next;M.next=null,f===null?u=I:f.next=I,f=M;var j=e.alternate;j!==null&&(j=j.updateQueue,p=j.lastBaseUpdate,p!==f&&(p===null?j.firstBaseUpdate=I:p.next=I,j.lastBaseUpdate=M))}if(u!==null){var G=a.baseState;f=0,j=I=M=null,p=u;do{var Y=p.lane&-536870913,H=Y!==p.lane;if(H?(Ce&Y)===Y:(n&Y)===Y){Y!==0&&Y===qn&&(Vc=!0),j!==null&&(j=j.next={lane:0,tag:p.tag,payload:p.payload,callback:null,next:null});e:{var Ee=e,oe=p;Y=t;var je=l;switch(oe.tag){case 1:if(Ee=oe.payload,typeof Ee=="function"){G=Ee.call(je,G,Y);break e}G=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=oe.payload,Y=typeof Ee=="function"?Ee.call(je,G,Y):Ee,Y==null)break e;G=D({},G,Y);break e;case 2:xl=!0}}Y=p.callback,Y!==null&&(e.flags|=64,H&&(e.flags|=8192),H=a.callbacks,H===null?a.callbacks=[Y]:H.push(Y))}else H={lane:Y,tag:p.tag,payload:p.payload,callback:p.callback,next:null},j===null?(I=j=H,M=G):j=j.next=H,f|=Y;if(p=p.next,p===null){if(p=a.shared.pending,p===null)break;H=p,p=H.next,H.next=null,a.lastBaseUpdate=H,a.shared.pending=null}}while(!0);j===null&&(M=G),a.baseState=M,a.firstBaseUpdate=I,a.lastBaseUpdate=j,u===null&&(a.shared.lanes=0),Gl|=f,e.lanes=f,e.memoizedState=G}}function jo(e,t){if(typeof e!="function")throw Error(i(191,e));e.call(t)}function Vo(e,t){var l=e.callbacks;if(l!==null)for(e.callbacks=null,e=0;e<l.length;e++)jo(l[e],t)}var Bn=C(null),Fr=C(0);function Go(e,t){e=Al,L(Fr,e),L(Bn,t),Al=e|t.baseLanes}function Gc(){L(Fr,Al),L(Bn,Bn.current)}function $c(){Al=Fr.current,U(Bn),U(Fr)}var Ll=0,ve=null,He=null,Pe=null,Zr=!1,Fn=!1,pn=!1,Qr=0,ja=0,Zn=null,cm=0;function Ke(){throw Error(i(321))}function qc(e,t){if(t===null)return!1;for(var l=0;l<t.length&&l<e.length;l++)if(!Dt(e[l],t[l]))return!1;return!0}function Xc(e,t,l,n,a,u){return Ll=u,ve=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,A.H=e===null||e.memoizedState===null?bf:Cf,pn=!1,u=l(n,a),pn=!1,Fn&&(u=qo(t,l,n,a)),$o(e),u}function $o(e){A.H=eu;var t=He!==null&&He.next!==null;if(Ll=0,Pe=He=ve=null,Zr=!1,ja=0,Zn=null,t)throw Error(i(300));e===null||ct||(e=e.dependencies,e!==null&&Gr(e)&&(ct=!0))}function qo(e,t,l,n){ve=e;var a=0;do{if(Fn&&(Zn=null),ja=0,Fn=!1,25<=a)throw Error(i(301));if(a+=1,Pe=He=null,e.updateQueue!=null){var u=e.updateQueue;u.lastEffect=null,u.events=null,u.stores=null,u.memoCache!=null&&(u.memoCache.index=0)}A.H=ym,u=t(l,n)}while(Fn);return u}function im(){var e=A.H,t=e.useState()[0];return t=typeof t.then=="function"?Va(t):t,e=e.useState()[0],(He!==null?He.memoizedState:null)!==e&&(ve.flags|=1024),t}function Bc(){var e=Qr!==0;return Qr=0,e}function Fc(e,t,l){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l}function Zc(e){if(Zr){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Zr=!1}Ll=0,Pe=He=ve=null,Fn=!1,ja=Qr=0,Zn=null}function bt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pe===null?ve.memoizedState=Pe=e:Pe=Pe.next=e,Pe}function et(){if(He===null){var e=ve.alternate;e=e!==null?e.memoizedState:null}else e=He.next;var t=Pe===null?ve.memoizedState:Pe.next;if(t!==null)Pe=t,He=e;else{if(e===null)throw ve.alternate===null?Error(i(467)):Error(i(310));He=e,e={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},Pe===null?ve.memoizedState=Pe=e:Pe=Pe.next=e}return Pe}function Qc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Va(e){var t=ja;return ja+=1,Zn===null&&(Zn=[]),e=Yo(Zn,e,t),t=ve,(Pe===null?t.memoizedState:Pe.next)===null&&(t=t.alternate,A.H=t===null||t.memoizedState===null?bf:Cf),e}function kr(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Va(e);if(e.$$typeof===X)return gt(e)}throw Error(i(438,String(e)))}function kc(e){var t=null,l=ve.updateQueue;if(l!==null&&(t=l.memoCache),t==null){var n=ve.alternate;n!==null&&(n=n.updateQueue,n!==null&&(n=n.memoCache,n!=null&&(t={data:n.data.map(function(a){return a.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),l===null&&(l=Qc(),ve.updateQueue=l),l.memoCache=t,l=t.data[t.index],l===void 0)for(l=t.data[t.index]=Array(e),n=0;n<e;n++)l[n]=Ue;return t.index++,l}function gl(e,t){return typeof t=="function"?t(e):t}function Kr(e){var t=et();return Kc(t,He,e)}function Kc(e,t,l){var n=e.queue;if(n===null)throw Error(i(311));n.lastRenderedReducer=l;var a=e.baseQueue,u=n.pending;if(u!==null){if(a!==null){var f=a.next;a.next=u.next,u.next=f}t.baseQueue=a=u,n.pending=null}if(u=e.baseState,a===null)e.memoizedState=u;else{t=a.next;var p=f=null,M=null,I=t,j=!1;do{var G=I.lane&-536870913;if(G!==I.lane?(Ce&G)===G:(Ll&G)===G){var Y=I.revertLane;if(Y===0)M!==null&&(M=M.next={lane:0,revertLane:0,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null}),G===qn&&(j=!0);else if((Ll&Y)===Y){I=I.next,Y===qn&&(j=!0);continue}else G={lane:0,revertLane:I.revertLane,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null},M===null?(p=M=G,f=u):M=M.next=G,ve.lanes|=Y,Gl|=Y;G=I.action,pn&&l(u,G),u=I.hasEagerState?I.eagerState:l(u,G)}else Y={lane:G,revertLane:I.revertLane,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null},M===null?(p=M=Y,f=u):M=M.next=Y,ve.lanes|=G,Gl|=G;I=I.next}while(I!==null&&I!==t);if(M===null?f=u:M.next=p,!Dt(u,e.memoizedState)&&(ct=!0,j&&(l=Xn,l!==null)))throw l;e.memoizedState=u,e.baseState=f,e.baseQueue=M,n.lastRenderedState=u}return a===null&&(n.lanes=0),[e.memoizedState,n.dispatch]}function Jc(e){var t=et(),l=t.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=e;var n=l.dispatch,a=l.pending,u=t.memoizedState;if(a!==null){l.pending=null;var f=a=a.next;do u=e(u,f.action),f=f.next;while(f!==a);Dt(u,t.memoizedState)||(ct=!0),t.memoizedState=u,t.baseQueue===null&&(t.baseState=u),l.lastRenderedState=u}return[u,n]}function Xo(e,t,l){var n=ve,a=et(),u=we;if(u){if(l===void 0)throw Error(i(407));l=l()}else l=t();var f=!Dt((He||a).memoizedState,l);f&&(a.memoizedState=l,ct=!0),a=a.queue;var p=Zo.bind(null,n,a,e);if(Ga(2048,8,p,[e]),a.getSnapshot!==t||f||Pe!==null&&Pe.memoizedState.tag&1){if(n.flags|=2048,Qn(9,Jr(),Fo.bind(null,n,a,l,t),null),$e===null)throw Error(i(349));u||(Ll&124)!==0||Bo(n,t,l)}return l}function Bo(e,t,l){e.flags|=16384,e={getSnapshot:t,value:l},t=ve.updateQueue,t===null?(t=Qc(),ve.updateQueue=t,t.stores=[e]):(l=t.stores,l===null?t.stores=[e]:l.push(e))}function Fo(e,t,l,n){t.value=l,t.getSnapshot=n,Qo(t)&&ko(e)}function Zo(e,t,l){return l(function(){Qo(t)&&ko(e)})}function Qo(e){var t=e.getSnapshot;e=e.value;try{var l=t();return!Dt(e,l)}catch{return!0}}function ko(e){var t=jn(e,2);t!==null&&Yt(t,e,2)}function Wc(e){var t=bt();if(typeof e=="function"){var l=e;if(e=l(),pn){Tt(!0);try{l()}finally{Tt(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gl,lastRenderedState:e},t}function Ko(e,t,l,n){return e.baseState=l,Kc(e,He,typeof n=="function"?n:gl)}function sm(e,t,l,n,a){if(Pr(e))throw Error(i(485));if(e=t.action,e!==null){var u={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(f){u.listeners.push(f)}};A.T!==null?l(!0):u.isTransition=!1,n(u),l=t.pending,l===null?(u.next=t.pending=u,Jo(t,u)):(u.next=l.next,t.pending=l.next=u)}}function Jo(e,t){var l=t.action,n=t.payload,a=e.state;if(t.isTransition){var u=A.T,f={};A.T=f;try{var p=l(a,n),M=A.S;M!==null&&M(f,p),Wo(e,t,p)}catch(I){Pc(e,t,I)}finally{A.T=u}}else try{u=l(a,n),Wo(e,t,u)}catch(I){Pc(e,t,I)}}function Wo(e,t,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(n){Po(e,t,n)},function(n){return Pc(e,t,n)}):Po(e,t,l)}function Po(e,t,l){t.status="fulfilled",t.value=l,ef(t),e.state=l,t=e.pending,t!==null&&(l=t.next,l===t?e.pending=null:(l=l.next,t.next=l,Jo(e,l)))}function Pc(e,t,l){var n=e.pending;if(e.pending=null,n!==null){n=n.next;do t.status="rejected",t.reason=l,ef(t),t=t.next;while(t!==n)}e.action=null}function ef(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function tf(e,t){return t}function lf(e,t){if(we){var l=$e.formState;if(l!==null){e:{var n=ve;if(we){if(Qe){t:{for(var a=Qe,u=Pt;a.nodeType!==8;){if(!u){a=null;break t}if(a=Wt(a.nextSibling),a===null){a=null;break t}}u=a.data,a=u==="F!"||u==="F"?a:null}if(a){Qe=Wt(a.nextSibling),n=a.data==="F!";break e}}dn(n)}n=!1}n&&(t=l[0])}}return l=bt(),l.memoizedState=l.baseState=t,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tf,lastRenderedState:t},l.queue=n,l=Sf.bind(null,ve,n),n.dispatch=l,n=Wc(!1),u=ai.bind(null,ve,!1,n.queue),n=bt(),a={state:t,dispatch:null,action:e,pending:null},n.queue=a,l=sm.bind(null,ve,a,u,l),a.dispatch=l,n.memoizedState=e,[t,l,!1]}function nf(e){var t=et();return af(t,He,e)}function af(e,t,l){if(t=Kc(e,t,tf)[0],e=Kr(gl)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var n=Va(t)}catch(f){throw f===La?Xr:f}else n=t;t=et();var a=t.queue,u=a.dispatch;return l!==t.memoizedState&&(ve.flags|=2048,Qn(9,Jr(),om.bind(null,a,l),null)),[n,u,e]}function om(e,t){e.action=t}function rf(e){var t=et(),l=He;if(l!==null)return af(t,l,e);et(),t=t.memoizedState,l=et();var n=l.queue.dispatch;return l.memoizedState=e,[t,n,!1]}function Qn(e,t,l,n){return e={tag:e,create:l,deps:n,inst:t,next:null},t=ve.updateQueue,t===null&&(t=Qc(),ve.updateQueue=t),l=t.lastEffect,l===null?t.lastEffect=e.next=e:(n=l.next,l.next=e,e.next=n,t.lastEffect=e),e}function Jr(){return{destroy:void 0,resource:void 0}}function uf(){return et().memoizedState}function Wr(e,t,l,n){var a=bt();n=n===void 0?null:n,ve.flags|=e,a.memoizedState=Qn(1|t,Jr(),l,n)}function Ga(e,t,l,n){var a=et();n=n===void 0?null:n;var u=a.memoizedState.inst;He!==null&&n!==null&&qc(n,He.memoizedState.deps)?a.memoizedState=Qn(t,u,l,n):(ve.flags|=e,a.memoizedState=Qn(1|t,u,l,n))}function cf(e,t){Wr(8390656,8,e,t)}function sf(e,t){Ga(2048,8,e,t)}function of(e,t){return Ga(4,2,e,t)}function ff(e,t){return Ga(4,4,e,t)}function df(e,t){if(typeof t=="function"){e=e();var l=t(e);return function(){typeof l=="function"?l():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Ef(e,t,l){l=l!=null?l.concat([e]):null,Ga(4,4,df.bind(null,t,e),l)}function ei(){}function yf(e,t){var l=et();t=t===void 0?null:t;var n=l.memoizedState;return t!==null&&qc(t,n[1])?n[0]:(l.memoizedState=[e,t],e)}function mf(e,t){var l=et();t=t===void 0?null:t;var n=l.memoizedState;if(t!==null&&qc(t,n[1]))return n[0];if(n=e(),pn){Tt(!0);try{e()}finally{Tt(!1)}}return l.memoizedState=[n,t],n}function ti(e,t,l){return l===void 0||(Ll&1073741824)!==0?e.memoizedState=t:(e.memoizedState=l,e=gd(),ve.lanes|=e,Gl|=e,l)}function pf(e,t,l,n){return Dt(l,t)?l:Bn.current!==null?(e=ti(e,l,n),Dt(e,t)||(ct=!0),e):(Ll&42)===0?(ct=!0,e.memoizedState=l):(e=gd(),ve.lanes|=e,Gl|=e,t)}function hf(e,t,l,n,a){var u=S.p;S.p=u!==0&&8>u?u:8;var f=A.T,p={};A.T=p,ai(e,!1,t,l);try{var M=a(),I=A.S;if(I!==null&&I(p,M),M!==null&&typeof M=="object"&&typeof M.then=="function"){var j=um(M,n);$a(e,t,j,It(e))}else $a(e,t,n,It(e))}catch(G){$a(e,t,{then:function(){},status:"rejected",reason:G},It())}finally{S.p=u,A.T=f}}function fm(){}function li(e,t,l,n){if(e.tag!==5)throw Error(i(476));var a=gf(e).queue;hf(e,a,t,v,l===null?fm:function(){return vf(e),l(n)})}function gf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:v,baseState:v,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gl,lastRenderedState:v},next:null};var l={};return t.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gl,lastRenderedState:l},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function vf(e){var t=gf(e).next.queue;$a(e,t,{},It())}function ni(){return gt(ur)}function Tf(){return et().memoizedState}function Rf(){return et().memoizedState}function dm(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var l=It();e=Ul(l);var n=wl(t,e,l);n!==null&&(Yt(n,t,l),Ya(n,t,l)),t={cache:wc()},e.payload=t;return}t=t.return}}function Em(e,t,l){var n=It();l={lane:n,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},Pr(e)?Nf(t,l):(l=Nc(e,t,l,n),l!==null&&(Yt(l,e,n),Af(l,t,n)))}function Sf(e,t,l){var n=It();$a(e,t,l,n)}function $a(e,t,l,n){var a={lane:n,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(Pr(e))Nf(t,a);else{var u=e.alternate;if(e.lanes===0&&(u===null||u.lanes===0)&&(u=t.lastRenderedReducer,u!==null))try{var f=t.lastRenderedState,p=u(f,l);if(a.hasEagerState=!0,a.eagerState=p,Dt(p,f))return Yr(e,t,a,0),$e===null&&Ir(),!1}catch{}finally{}if(l=Nc(e,t,a,n),l!==null)return Yt(l,e,n),Af(l,t,n),!0}return!1}function ai(e,t,l,n){if(n={lane:2,revertLane:Yi(),action:n,hasEagerState:!1,eagerState:null,next:null},Pr(e)){if(t)throw Error(i(479))}else t=Nc(e,l,n,2),t!==null&&Yt(t,e,2)}function Pr(e){var t=e.alternate;return e===ve||t!==null&&t===ve}function Nf(e,t){Fn=Zr=!0;var l=e.pending;l===null?t.next=t:(t.next=l.next,l.next=t),e.pending=t}function Af(e,t,l){if((l&4194048)!==0){var n=t.lanes;n&=e.pendingLanes,l|=n,t.lanes=l,Ds(e,l)}}var eu={readContext:gt,use:kr,useCallback:Ke,useContext:Ke,useEffect:Ke,useImperativeHandle:Ke,useLayoutEffect:Ke,useInsertionEffect:Ke,useMemo:Ke,useReducer:Ke,useRef:Ke,useState:Ke,useDebugValue:Ke,useDeferredValue:Ke,useTransition:Ke,useSyncExternalStore:Ke,useId:Ke,useHostTransitionStatus:Ke,useFormState:Ke,useActionState:Ke,useOptimistic:Ke,useMemoCache:Ke,useCacheRefresh:Ke},bf={readContext:gt,use:kr,useCallback:function(e,t){return bt().memoizedState=[e,t===void 0?null:t],e},useContext:gt,useEffect:cf,useImperativeHandle:function(e,t,l){l=l!=null?l.concat([e]):null,Wr(4194308,4,df.bind(null,t,e),l)},useLayoutEffect:function(e,t){return Wr(4194308,4,e,t)},useInsertionEffect:function(e,t){Wr(4,2,e,t)},useMemo:function(e,t){var l=bt();t=t===void 0?null:t;var n=e();if(pn){Tt(!0);try{e()}finally{Tt(!1)}}return l.memoizedState=[n,t],n},useReducer:function(e,t,l){var n=bt();if(l!==void 0){var a=l(t);if(pn){Tt(!0);try{l(t)}finally{Tt(!1)}}}else a=t;return n.memoizedState=n.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},n.queue=e,e=e.dispatch=Em.bind(null,ve,e),[n.memoizedState,e]},useRef:function(e){var t=bt();return e={current:e},t.memoizedState=e},useState:function(e){e=Wc(e);var t=e.queue,l=Sf.bind(null,ve,t);return t.dispatch=l,[e.memoizedState,l]},useDebugValue:ei,useDeferredValue:function(e,t){var l=bt();return ti(l,e,t)},useTransition:function(){var e=Wc(!1);return e=hf.bind(null,ve,e.queue,!0,!1),bt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,l){var n=ve,a=bt();if(we){if(l===void 0)throw Error(i(407));l=l()}else{if(l=t(),$e===null)throw Error(i(349));(Ce&124)!==0||Bo(n,t,l)}a.memoizedState=l;var u={value:l,getSnapshot:t};return a.queue=u,cf(Zo.bind(null,n,u,e),[e]),n.flags|=2048,Qn(9,Jr(),Fo.bind(null,n,u,l,t),null),l},useId:function(){var e=bt(),t=$e.identifierPrefix;if(we){var l=ml,n=yl;l=(n&~(1<<32-ft(n)-1)).toString(32)+l,t=""+t+"R"+l,l=Qr++,0<l&&(t+="H"+l.toString(32)),t+=""}else l=cm++,t=""+t+"r"+l.toString(32)+"";return e.memoizedState=t},useHostTransitionStatus:ni,useFormState:lf,useActionState:lf,useOptimistic:function(e){var t=bt();t.memoizedState=t.baseState=e;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=l,t=ai.bind(null,ve,!0,l),l.dispatch=t,[e,t]},useMemoCache:kc,useCacheRefresh:function(){return bt().memoizedState=dm.bind(null,ve)}},Cf={readContext:gt,use:kr,useCallback:yf,useContext:gt,useEffect:sf,useImperativeHandle:Ef,useInsertionEffect:of,useLayoutEffect:ff,useMemo:mf,useReducer:Kr,useRef:uf,useState:function(){return Kr(gl)},useDebugValue:ei,useDeferredValue:function(e,t){var l=et();return pf(l,He.memoizedState,e,t)},useTransition:function(){var e=Kr(gl)[0],t=et().memoizedState;return[typeof e=="boolean"?e:Va(e),t]},useSyncExternalStore:Xo,useId:Tf,useHostTransitionStatus:ni,useFormState:nf,useActionState:nf,useOptimistic:function(e,t){var l=et();return Ko(l,He,e,t)},useMemoCache:kc,useCacheRefresh:Rf},ym={readContext:gt,use:kr,useCallback:yf,useContext:gt,useEffect:sf,useImperativeHandle:Ef,useInsertionEffect:of,useLayoutEffect:ff,useMemo:mf,useReducer:Jc,useRef:uf,useState:function(){return Jc(gl)},useDebugValue:ei,useDeferredValue:function(e,t){var l=et();return He===null?ti(l,e,t):pf(l,He.memoizedState,e,t)},useTransition:function(){var e=Jc(gl)[0],t=et().memoizedState;return[typeof e=="boolean"?e:Va(e),t]},useSyncExternalStore:Xo,useId:Tf,useHostTransitionStatus:ni,useFormState:rf,useActionState:rf,useOptimistic:function(e,t){var l=et();return He!==null?Ko(l,He,e,t):(l.baseState=e,[e,l.queue.dispatch])},useMemoCache:kc,useCacheRefresh:Rf},kn=null,qa=0;function tu(e){var t=qa;return qa+=1,kn===null&&(kn=[]),Yo(kn,e,t)}function Xa(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function lu(e,t){throw t.$$typeof===b?Error(i(525)):(e=Object.prototype.toString.call(t),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Mf(e){var t=e._init;return t(e._payload)}function Of(e){function t(x,_){if(e){var w=x.deletions;w===null?(x.deletions=[_],x.flags|=16):w.push(_)}}function l(x,_){if(!e)return null;for(;_!==null;)t(x,_),_=_.sibling;return null}function n(x){for(var _=new Map;x!==null;)x.key!==null?_.set(x.key,x):_.set(x.index,x),x=x.sibling;return _}function a(x,_){return x=El(x,_),x.index=0,x.sibling=null,x}function u(x,_,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<_?(x.flags|=67108866,_):w):(x.flags|=67108866,_)):(x.flags|=1048576,_)}function f(x){return e&&x.alternate===null&&(x.flags|=67108866),x}function p(x,_,w,V){return _===null||_.tag!==6?(_=bc(w,x.mode,V),_.return=x,_):(_=a(_,w),_.return=x,_)}function M(x,_,w,V){var ae=w.type;return ae===K?j(x,_,w.props.children,V,w.key):_!==null&&(_.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===me&&Mf(ae)===_.type)?(_=a(_,w.props),Xa(_,w),_.return=x,_):(_=zr(w.type,w.key,w.props,null,x.mode,V),Xa(_,w),_.return=x,_)}function I(x,_,w,V){return _===null||_.tag!==4||_.stateNode.containerInfo!==w.containerInfo||_.stateNode.implementation!==w.implementation?(_=Cc(w,x.mode,V),_.return=x,_):(_=a(_,w.children||[]),_.return=x,_)}function j(x,_,w,V,ae){return _===null||_.tag!==7?(_=cn(w,x.mode,V,ae),_.return=x,_):(_=a(_,w),_.return=x,_)}function G(x,_,w){if(typeof _=="string"&&_!==""||typeof _=="number"||typeof _=="bigint")return _=bc(""+_,x.mode,w),_.return=x,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case z:return w=zr(_.type,_.key,_.props,null,x.mode,w),Xa(w,_),w.return=x,w;case F:return _=Cc(_,x.mode,w),_.return=x,_;case me:var V=_._init;return _=V(_._payload),G(x,_,w)}if(B(_)||ie(_))return _=cn(_,x.mode,w,null),_.return=x,_;if(typeof _.then=="function")return G(x,tu(_),w);if(_.$$typeof===X)return G(x,$r(x,_),w);lu(x,_)}return null}function Y(x,_,w,V){var ae=_!==null?_.key:null;if(typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint")return ae!==null?null:p(x,_,""+w,V);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case z:return w.key===ae?M(x,_,w,V):null;case F:return w.key===ae?I(x,_,w,V):null;case me:return ae=w._init,w=ae(w._payload),Y(x,_,w,V)}if(B(w)||ie(w))return ae!==null?null:j(x,_,w,V,null);if(typeof w.then=="function")return Y(x,_,tu(w),V);if(w.$$typeof===X)return Y(x,_,$r(x,w),V);lu(x,w)}return null}function H(x,_,w,V,ae){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return x=x.get(w)||null,p(_,x,""+V,ae);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case z:return x=x.get(V.key===null?w:V.key)||null,M(_,x,V,ae);case F:return x=x.get(V.key===null?w:V.key)||null,I(_,x,V,ae);case me:var Te=V._init;return V=Te(V._payload),H(x,_,w,V,ae)}if(B(V)||ie(V))return x=x.get(w)||null,j(_,x,V,ae,null);if(typeof V.then=="function")return H(x,_,w,tu(V),ae);if(V.$$typeof===X)return H(x,_,w,$r(_,V),ae);lu(_,V)}return null}function Ee(x,_,w,V){for(var ae=null,Te=null,ce=_,fe=_=0,st=null;ce!==null&&fe<w.length;fe++){ce.index>fe?(st=ce,ce=null):st=ce.sibling;var _e=Y(x,ce,w[fe],V);if(_e===null){ce===null&&(ce=st);break}e&&ce&&_e.alternate===null&&t(x,ce),_=u(_e,_,fe),Te===null?ae=_e:Te.sibling=_e,Te=_e,ce=st}if(fe===w.length)return l(x,ce),we&&on(x,fe),ae;if(ce===null){for(;fe<w.length;fe++)ce=G(x,w[fe],V),ce!==null&&(_=u(ce,_,fe),Te===null?ae=ce:Te.sibling=ce,Te=ce);return we&&on(x,fe),ae}for(ce=n(ce);fe<w.length;fe++)st=H(ce,x,fe,w[fe],V),st!==null&&(e&&st.alternate!==null&&ce.delete(st.key===null?fe:st.key),_=u(st,_,fe),Te===null?ae=st:Te.sibling=st,Te=st);return e&&ce.forEach(function(Kl){return t(x,Kl)}),we&&on(x,fe),ae}function oe(x,_,w,V){if(w==null)throw Error(i(151));for(var ae=null,Te=null,ce=_,fe=_=0,st=null,_e=w.next();ce!==null&&!_e.done;fe++,_e=w.next()){ce.index>fe?(st=ce,ce=null):st=ce.sibling;var Kl=Y(x,ce,_e.value,V);if(Kl===null){ce===null&&(ce=st);break}e&&ce&&Kl.alternate===null&&t(x,ce),_=u(Kl,_,fe),Te===null?ae=Kl:Te.sibling=Kl,Te=Kl,ce=st}if(_e.done)return l(x,ce),we&&on(x,fe),ae;if(ce===null){for(;!_e.done;fe++,_e=w.next())_e=G(x,_e.value,V),_e!==null&&(_=u(_e,_,fe),Te===null?ae=_e:Te.sibling=_e,Te=_e);return we&&on(x,fe),ae}for(ce=n(ce);!_e.done;fe++,_e=w.next())_e=H(ce,x,fe,_e.value,V),_e!==null&&(e&&_e.alternate!==null&&ce.delete(_e.key===null?fe:_e.key),_=u(_e,_,fe),Te===null?ae=_e:Te.sibling=_e,Te=_e);return e&&ce.forEach(function(m0){return t(x,m0)}),we&&on(x,fe),ae}function je(x,_,w,V){if(typeof w=="object"&&w!==null&&w.type===K&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case z:e:{for(var ae=w.key;_!==null;){if(_.key===ae){if(ae=w.type,ae===K){if(_.tag===7){l(x,_.sibling),V=a(_,w.props.children),V.return=x,x=V;break e}}else if(_.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===me&&Mf(ae)===_.type){l(x,_.sibling),V=a(_,w.props),Xa(V,w),V.return=x,x=V;break e}l(x,_);break}else t(x,_);_=_.sibling}w.type===K?(V=cn(w.props.children,x.mode,V,w.key),V.return=x,x=V):(V=zr(w.type,w.key,w.props,null,x.mode,V),Xa(V,w),V.return=x,x=V)}return f(x);case F:e:{for(ae=w.key;_!==null;){if(_.key===ae)if(_.tag===4&&_.stateNode.containerInfo===w.containerInfo&&_.stateNode.implementation===w.implementation){l(x,_.sibling),V=a(_,w.children||[]),V.return=x,x=V;break e}else{l(x,_);break}else t(x,_);_=_.sibling}V=Cc(w,x.mode,V),V.return=x,x=V}return f(x);case me:return ae=w._init,w=ae(w._payload),je(x,_,w,V)}if(B(w))return Ee(x,_,w,V);if(ie(w)){if(ae=ie(w),typeof ae!="function")throw Error(i(150));return w=ae.call(w),oe(x,_,w,V)}if(typeof w.then=="function")return je(x,_,tu(w),V);if(w.$$typeof===X)return je(x,_,$r(x,w),V);lu(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint"?(w=""+w,_!==null&&_.tag===6?(l(x,_.sibling),V=a(_,w),V.return=x,x=V):(l(x,_),V=bc(w,x.mode,V),V.return=x,x=V),f(x)):l(x,_)}return function(x,_,w,V){try{qa=0;var ae=je(x,_,w,V);return kn=null,ae}catch(ce){if(ce===La||ce===Xr)throw ce;var Te=xt(29,ce,null,x.mode);return Te.lanes=V,Te.return=x,Te}finally{}}}var Kn=Of(!0),_f=Of(!1),Xt=C(null),el=null;function Il(e){var t=e.alternate;L(at,at.current&1),L(Xt,e),el===null&&(t===null||Bn.current!==null||t.memoizedState!==null)&&(el=e)}function Df(e){if(e.tag===22){if(L(at,at.current),L(Xt,e),el===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(el=e)}}else Yl()}function Yl(){L(at,at.current),L(Xt,Xt.current)}function vl(e){U(Xt),el===e&&(el=null),U(at)}var at=C(0);function nu(e){for(var t=e;t!==null;){if(t.tag===13){var l=t.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||Qi(l)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function ri(e,t,l,n){t=e.memoizedState,l=l(n,t),l=l==null?t:D({},t,l),e.memoizedState=l,e.lanes===0&&(e.updateQueue.baseState=l)}var ui={enqueueSetState:function(e,t,l){e=e._reactInternals;var n=It(),a=Ul(n);a.payload=t,l!=null&&(a.callback=l),t=wl(e,a,n),t!==null&&(Yt(t,e,n),Ya(t,e,n))},enqueueReplaceState:function(e,t,l){e=e._reactInternals;var n=It(),a=Ul(n);a.tag=1,a.payload=t,l!=null&&(a.callback=l),t=wl(e,a,n),t!==null&&(Yt(t,e,n),Ya(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var l=It(),n=Ul(l);n.tag=2,t!=null&&(n.callback=t),t=wl(e,n,l),t!==null&&(Yt(t,e,l),Ya(t,e,l))}};function xf(e,t,l,n,a,u,f){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,u,f):t.prototype&&t.prototype.isPureReactComponent?!Ca(l,n)||!Ca(a,u):!0}function Uf(e,t,l,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(l,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(l,n),t.state!==e&&ui.enqueueReplaceState(t,t.state,null)}function hn(e,t){var l=t;if("ref"in t){l={};for(var n in t)n!=="ref"&&(l[n]=t[n])}if(e=e.defaultProps){l===t&&(l=D({},l));for(var a in e)l[a]===void 0&&(l[a]=e[a])}return l}var au=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function wf(e){au(e)}function Lf(e){console.error(e)}function If(e){au(e)}function ru(e,t){try{var l=e.onUncaughtError;l(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Yf(e,t,l){try{var n=e.onCaughtError;n(l.value,{componentStack:l.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(a){setTimeout(function(){throw a})}}function ci(e,t,l){return l=Ul(l),l.tag=3,l.payload={element:null},l.callback=function(){ru(e,t)},l}function Hf(e){return e=Ul(e),e.tag=3,e}function zf(e,t,l,n){var a=l.type.getDerivedStateFromError;if(typeof a=="function"){var u=n.value;e.payload=function(){return a(u)},e.callback=function(){Yf(t,l,n)}}var f=l.stateNode;f!==null&&typeof f.componentDidCatch=="function"&&(e.callback=function(){Yf(t,l,n),typeof a!="function"&&($l===null?$l=new Set([this]):$l.add(this));var p=n.stack;this.componentDidCatch(n.value,{componentStack:p!==null?p:""})})}function mm(e,t,l,n,a){if(l.flags|=32768,n!==null&&typeof n=="object"&&typeof n.then=="function"){if(t=l.alternate,t!==null&&xa(t,l,a,!0),l=Xt.current,l!==null){switch(l.tag){case 13:return el===null?xi():l.alternate===null&&ke===0&&(ke=3),l.flags&=-257,l.flags|=65536,l.lanes=a,n===Yc?l.flags|=16384:(t=l.updateQueue,t===null?l.updateQueue=new Set([n]):t.add(n),wi(e,n,a)),!1;case 22:return l.flags|=65536,n===Yc?l.flags|=16384:(t=l.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([n])},l.updateQueue=t):(l=t.retryQueue,l===null?t.retryQueue=new Set([n]):l.add(n)),wi(e,n,a)),!1}throw Error(i(435,l.tag))}return wi(e,n,a),xi(),!1}if(we)return t=Xt.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=a,n!==_c&&(e=Error(i(422),{cause:n}),Da(Vt(e,l)))):(n!==_c&&(t=Error(i(423),{cause:n}),Da(Vt(t,l))),e=e.current.alternate,e.flags|=65536,a&=-a,e.lanes|=a,n=Vt(n,l),a=ci(e.stateNode,n,a),jc(e,a),ke!==4&&(ke=2)),!1;var u=Error(i(520),{cause:n});if(u=Vt(u,l),Ja===null?Ja=[u]:Ja.push(u),ke!==4&&(ke=2),t===null)return!0;n=Vt(n,l),l=t;do{switch(l.tag){case 3:return l.flags|=65536,e=a&-a,l.lanes|=e,e=ci(l.stateNode,n,e),jc(l,e),!1;case 1:if(t=l.type,u=l.stateNode,(l.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||u!==null&&typeof u.componentDidCatch=="function"&&($l===null||!$l.has(u))))return l.flags|=65536,a&=-a,l.lanes|=a,a=Hf(a),zf(a,e,l,n),jc(l,a),!1}l=l.return}while(l!==null);return!1}var jf=Error(i(461)),ct=!1;function dt(e,t,l,n){t.child=e===null?_f(t,null,l,n):Kn(t,e.child,l,n)}function Vf(e,t,l,n,a){l=l.render;var u=t.ref;if("ref"in n){var f={};for(var p in n)p!=="ref"&&(f[p]=n[p])}else f=n;return yn(t),n=Xc(e,t,l,f,u,a),p=Bc(),e!==null&&!ct?(Fc(e,t,a),Tl(e,t,a)):(we&&p&&Mc(t),t.flags|=1,dt(e,t,n,a),t.child)}function Gf(e,t,l,n,a){if(e===null){var u=l.type;return typeof u=="function"&&!Ac(u)&&u.defaultProps===void 0&&l.compare===null?(t.tag=15,t.type=u,$f(e,t,u,n,a)):(e=zr(l.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(u=e.child,!mi(e,a)){var f=u.memoizedProps;if(l=l.compare,l=l!==null?l:Ca,l(f,n)&&e.ref===t.ref)return Tl(e,t,a)}return t.flags|=1,e=El(u,n),e.ref=t.ref,e.return=t,t.child=e}function $f(e,t,l,n,a){if(e!==null){var u=e.memoizedProps;if(Ca(u,n)&&e.ref===t.ref)if(ct=!1,t.pendingProps=n=u,mi(e,a))(e.flags&131072)!==0&&(ct=!0);else return t.lanes=e.lanes,Tl(e,t,a)}return ii(e,t,l,n,a)}function qf(e,t,l){var n=t.pendingProps,a=n.children,u=e!==null?e.memoizedState:null;if(n.mode==="hidden"){if((t.flags&128)!==0){if(n=u!==null?u.baseLanes|l:l,e!==null){for(a=t.child=e.child,u=0;a!==null;)u=u|a.lanes|a.childLanes,a=a.sibling;t.childLanes=u&~n}else t.childLanes=0,t.child=null;return Xf(e,t,n,l)}if((l&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&qr(t,u!==null?u.cachePool:null),u!==null?Go(t,u):Gc(),Df(t);else return t.lanes=t.childLanes=536870912,Xf(e,t,u!==null?u.baseLanes|l:l,l)}else u!==null?(qr(t,u.cachePool),Go(t,u),Yl(),t.memoizedState=null):(e!==null&&qr(t,null),Gc(),Yl());return dt(e,t,a,l),t.child}function Xf(e,t,l,n){var a=Ic();return a=a===null?null:{parent:nt._currentValue,pool:a},t.memoizedState={baseLanes:l,cachePool:a},e!==null&&qr(t,null),Gc(),Df(t),e!==null&&xa(e,t,n,!0),null}function uu(e,t){var l=t.ref;if(l===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(e===null||e.ref!==l)&&(t.flags|=4194816)}}function ii(e,t,l,n,a){return yn(t),l=Xc(e,t,l,n,void 0,a),n=Bc(),e!==null&&!ct?(Fc(e,t,a),Tl(e,t,a)):(we&&n&&Mc(t),t.flags|=1,dt(e,t,l,a),t.child)}function Bf(e,t,l,n,a,u){return yn(t),t.updateQueue=null,l=qo(t,n,l,a),$o(e),n=Bc(),e!==null&&!ct?(Fc(e,t,u),Tl(e,t,u)):(we&&n&&Mc(t),t.flags|=1,dt(e,t,l,u),t.child)}function Ff(e,t,l,n,a){if(yn(t),t.stateNode===null){var u=Vn,f=l.contextType;typeof f=="object"&&f!==null&&(u=gt(f)),u=new l(n,u),t.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=ui,t.stateNode=u,u._reactInternals=t,u=t.stateNode,u.props=n,u.state=t.memoizedState,u.refs={},Hc(t),f=l.contextType,u.context=typeof f=="object"&&f!==null?gt(f):Vn,u.state=t.memoizedState,f=l.getDerivedStateFromProps,typeof f=="function"&&(ri(t,l,f,n),u.state=t.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(f=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),f!==u.state&&ui.enqueueReplaceState(u,u.state,null),za(t,n,u,a),Ha(),u.state=t.memoizedState),typeof u.componentDidMount=="function"&&(t.flags|=4194308),n=!0}else if(e===null){u=t.stateNode;var p=t.memoizedProps,M=hn(l,p);u.props=M;var I=u.context,j=l.contextType;f=Vn,typeof j=="object"&&j!==null&&(f=gt(j));var G=l.getDerivedStateFromProps;j=typeof G=="function"||typeof u.getSnapshotBeforeUpdate=="function",p=t.pendingProps!==p,j||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(p||I!==f)&&Uf(t,u,n,f),xl=!1;var Y=t.memoizedState;u.state=Y,za(t,n,u,a),Ha(),I=t.memoizedState,p||Y!==I||xl?(typeof G=="function"&&(ri(t,l,G,n),I=t.memoizedState),(M=xl||xf(t,l,M,n,Y,I,f))?(j||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(t.flags|=4194308)):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=I),u.props=n,u.state=I,u.context=f,n=M):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{u=t.stateNode,zc(e,t),f=t.memoizedProps,j=hn(l,f),u.props=j,G=t.pendingProps,Y=u.context,I=l.contextType,M=Vn,typeof I=="object"&&I!==null&&(M=gt(I)),p=l.getDerivedStateFromProps,(I=typeof p=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(f!==G||Y!==M)&&Uf(t,u,n,M),xl=!1,Y=t.memoizedState,u.state=Y,za(t,n,u,a),Ha();var H=t.memoizedState;f!==G||Y!==H||xl||e!==null&&e.dependencies!==null&&Gr(e.dependencies)?(typeof p=="function"&&(ri(t,l,p,n),H=t.memoizedState),(j=xl||xf(t,l,j,n,Y,H,M)||e!==null&&e.dependencies!==null&&Gr(e.dependencies))?(I||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(n,H,M),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(n,H,M)),typeof u.componentDidUpdate=="function"&&(t.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof u.componentDidUpdate!="function"||f===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||f===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=H),u.props=n,u.state=H,u.context=M,n=j):(typeof u.componentDidUpdate!="function"||f===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||f===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),n=!1)}return u=n,uu(e,t),n=(t.flags&128)!==0,u||n?(u=t.stateNode,l=n&&typeof l.getDerivedStateFromError!="function"?null:u.render(),t.flags|=1,e!==null&&n?(t.child=Kn(t,e.child,null,a),t.child=Kn(t,null,l,a)):dt(e,t,l,a),t.memoizedState=u.state,e=t.child):e=Tl(e,t,a),e}function Zf(e,t,l,n){return _a(),t.flags|=256,dt(e,t,l,n),t.child}var si={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function oi(e){return{baseLanes:e,cachePool:wo()}}function fi(e,t,l){return e=e!==null?e.childLanes&~l:0,t&&(e|=Bt),e}function Qf(e,t,l){var n=t.pendingProps,a=!1,u=(t.flags&128)!==0,f;if((f=u)||(f=e!==null&&e.memoizedState===null?!1:(at.current&2)!==0),f&&(a=!0,t.flags&=-129),f=(t.flags&32)!==0,t.flags&=-33,e===null){if(we){if(a?Il(t):Yl(),we){var p=Qe,M;if(M=p){e:{for(M=p,p=Pt;M.nodeType!==8;){if(!p){p=null;break e}if(M=Wt(M.nextSibling),M===null){p=null;break e}}p=M}p!==null?(t.memoizedState={dehydrated:p,treeContext:sn!==null?{id:yl,overflow:ml}:null,retryLane:536870912,hydrationErrors:null},M=xt(18,null,null,0),M.stateNode=p,M.return=t,t.child=M,Rt=t,Qe=null,M=!0):M=!1}M||dn(t)}if(p=t.memoizedState,p!==null&&(p=p.dehydrated,p!==null))return Qi(p)?t.lanes=32:t.lanes=536870912,null;vl(t)}return p=n.children,n=n.fallback,a?(Yl(),a=t.mode,p=cu({mode:"hidden",children:p},a),n=cn(n,a,l,null),p.return=t,n.return=t,p.sibling=n,t.child=p,a=t.child,a.memoizedState=oi(l),a.childLanes=fi(e,f,l),t.memoizedState=si,n):(Il(t),di(t,p))}if(M=e.memoizedState,M!==null&&(p=M.dehydrated,p!==null)){if(u)t.flags&256?(Il(t),t.flags&=-257,t=Ei(e,t,l)):t.memoizedState!==null?(Yl(),t.child=e.child,t.flags|=128,t=null):(Yl(),a=n.fallback,p=t.mode,n=cu({mode:"visible",children:n.children},p),a=cn(a,p,l,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,Kn(t,e.child,null,l),n=t.child,n.memoizedState=oi(l),n.childLanes=fi(e,f,l),t.memoizedState=si,t=a);else if(Il(t),Qi(p)){if(f=p.nextSibling&&p.nextSibling.dataset,f)var I=f.dgst;f=I,n=Error(i(419)),n.stack="",n.digest=f,Da({value:n,source:null,stack:null}),t=Ei(e,t,l)}else if(ct||xa(e,t,l,!1),f=(l&e.childLanes)!==0,ct||f){if(f=$e,f!==null&&(n=l&-l,n=(n&42)!==0?1:ku(n),n=(n&(f.suspendedLanes|l))!==0?0:n,n!==0&&n!==M.retryLane))throw M.retryLane=n,jn(e,n),Yt(f,e,n),jf;p.data==="$?"||xi(),t=Ei(e,t,l)}else p.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=M.treeContext,Qe=Wt(p.nextSibling),Rt=t,we=!0,fn=null,Pt=!1,e!==null&&($t[qt++]=yl,$t[qt++]=ml,$t[qt++]=sn,yl=e.id,ml=e.overflow,sn=t),t=di(t,n.children),t.flags|=4096);return t}return a?(Yl(),a=n.fallback,p=t.mode,M=e.child,I=M.sibling,n=El(M,{mode:"hidden",children:n.children}),n.subtreeFlags=M.subtreeFlags&65011712,I!==null?a=El(I,a):(a=cn(a,p,l,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,p=e.child.memoizedState,p===null?p=oi(l):(M=p.cachePool,M!==null?(I=nt._currentValue,M=M.parent!==I?{parent:I,pool:I}:M):M=wo(),p={baseLanes:p.baseLanes|l,cachePool:M}),a.memoizedState=p,a.childLanes=fi(e,f,l),t.memoizedState=si,n):(Il(t),l=e.child,e=l.sibling,l=El(l,{mode:"visible",children:n.children}),l.return=t,l.sibling=null,e!==null&&(f=t.deletions,f===null?(t.deletions=[e],t.flags|=16):f.push(e)),t.child=l,t.memoizedState=null,l)}function di(e,t){return t=cu({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function cu(e,t){return e=xt(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Ei(e,t,l){return Kn(t,e.child,null,l),e=di(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function kf(e,t,l){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),xc(e.return,t,l)}function yi(e,t,l,n,a){var u=e.memoizedState;u===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:l,tailMode:a}:(u.isBackwards=t,u.rendering=null,u.renderingStartTime=0,u.last=n,u.tail=l,u.tailMode=a)}function Kf(e,t,l){var n=t.pendingProps,a=n.revealOrder,u=n.tail;if(dt(e,t,n.children,l),n=at.current,(n&2)!==0)n=n&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&kf(e,l,t);else if(e.tag===19)kf(e,l,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}switch(L(at,n),a){case"forwards":for(l=t.child,a=null;l!==null;)e=l.alternate,e!==null&&nu(e)===null&&(a=l),l=l.sibling;l=a,l===null?(a=t.child,t.child=null):(a=l.sibling,l.sibling=null),yi(t,!1,a,l,u);break;case"backwards":for(l=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&nu(e)===null){t.child=a;break}e=a.sibling,a.sibling=l,l=a,a=e}yi(t,!0,l,null,u);break;case"together":yi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Tl(e,t,l){if(e!==null&&(t.dependencies=e.dependencies),Gl|=t.lanes,(l&t.childLanes)===0)if(e!==null){if(xa(e,t,l,!1),(l&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(i(153));if(t.child!==null){for(e=t.child,l=El(e,e.pendingProps),t.child=l,l.return=t;e.sibling!==null;)e=e.sibling,l=l.sibling=El(e,e.pendingProps),l.return=t;l.sibling=null}return t.child}function mi(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Gr(e)))}function pm(e,t,l){switch(t.tag){case 3:Me(t,t.stateNode.containerInfo),Dl(t,nt,e.memoizedState.cache),_a();break;case 27:case 5:mt(t);break;case 4:Me(t,t.stateNode.containerInfo);break;case 10:Dl(t,t.type,t.memoizedProps.value);break;case 13:var n=t.memoizedState;if(n!==null)return n.dehydrated!==null?(Il(t),t.flags|=128,null):(l&t.child.childLanes)!==0?Qf(e,t,l):(Il(t),e=Tl(e,t,l),e!==null?e.sibling:null);Il(t);break;case 19:var a=(e.flags&128)!==0;if(n=(l&t.childLanes)!==0,n||(xa(e,t,l,!1),n=(l&t.childLanes)!==0),a){if(n)return Kf(e,t,l);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),L(at,at.current),n)break;return null;case 22:case 23:return t.lanes=0,qf(e,t,l);case 24:Dl(t,nt,e.memoizedState.cache)}return Tl(e,t,l)}function Jf(e,t,l){if(e!==null)if(e.memoizedProps!==t.pendingProps)ct=!0;else{if(!mi(e,l)&&(t.flags&128)===0)return ct=!1,pm(e,t,l);ct=(e.flags&131072)!==0}else ct=!1,we&&(t.flags&1048576)!==0&&Co(t,Vr,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var n=t.elementType,a=n._init;if(n=a(n._payload),t.type=n,typeof n=="function")Ac(n)?(e=hn(n,e),t.tag=1,t=Ff(null,t,n,e,l)):(t.tag=0,t=ii(null,t,n,e,l));else{if(n!=null){if(a=n.$$typeof,a===se){t.tag=11,t=Vf(null,t,n,e,l);break e}else if(a===pe){t.tag=14,t=Gf(null,t,n,e,l);break e}}throw t=J(n)||n,Error(i(306,t,""))}}return t;case 0:return ii(e,t,t.type,t.pendingProps,l);case 1:return n=t.type,a=hn(n,t.pendingProps),Ff(e,t,n,a,l);case 3:e:{if(Me(t,t.stateNode.containerInfo),e===null)throw Error(i(387));n=t.pendingProps;var u=t.memoizedState;a=u.element,zc(e,t),za(t,n,null,l);var f=t.memoizedState;if(n=f.cache,Dl(t,nt,n),n!==u.cache&&Uc(t,[nt],l,!0),Ha(),n=f.element,u.isDehydrated)if(u={element:n,isDehydrated:!1,cache:f.cache},t.updateQueue.baseState=u,t.memoizedState=u,t.flags&256){t=Zf(e,t,n,l);break e}else if(n!==a){a=Vt(Error(i(424)),t),Da(a),t=Zf(e,t,n,l);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Qe=Wt(e.firstChild),Rt=t,we=!0,fn=null,Pt=!0,l=_f(t,null,n,l),t.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(_a(),n===a){t=Tl(e,t,l);break e}dt(e,t,n,l)}t=t.child}return t;case 26:return uu(e,t),e===null?(l=tE(t.type,null,t.pendingProps,null))?t.memoizedState=l:we||(l=t.type,e=t.pendingProps,n=Ru(W.current).createElement(l),n[ht]=t,n[Nt]=e,yt(n,l,e),ut(n),t.stateNode=n):t.memoizedState=tE(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return mt(t),e===null&&we&&(n=t.stateNode=Wd(t.type,t.pendingProps,W.current),Rt=t,Pt=!0,a=Qe,Bl(t.type)?(ki=a,Qe=Wt(n.firstChild)):Qe=a),dt(e,t,t.pendingProps.children,l),uu(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&we&&((a=n=Qe)&&(n=Xm(n,t.type,t.pendingProps,Pt),n!==null?(t.stateNode=n,Rt=t,Qe=Wt(n.firstChild),Pt=!1,a=!0):a=!1),a||dn(t)),mt(t),a=t.type,u=t.pendingProps,f=e!==null?e.memoizedProps:null,n=u.children,Bi(a,u)?n=null:f!==null&&Bi(a,f)&&(t.flags|=32),t.memoizedState!==null&&(a=Xc(e,t,im,null,null,l),ur._currentValue=a),uu(e,t),dt(e,t,n,l),t.child;case 6:return e===null&&we&&((e=l=Qe)&&(l=Bm(l,t.pendingProps,Pt),l!==null?(t.stateNode=l,Rt=t,Qe=null,e=!0):e=!1),e||dn(t)),null;case 13:return Qf(e,t,l);case 4:return Me(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Kn(t,null,n,l):dt(e,t,n,l),t.child;case 11:return Vf(e,t,t.type,t.pendingProps,l);case 7:return dt(e,t,t.pendingProps,l),t.child;case 8:return dt(e,t,t.pendingProps.children,l),t.child;case 12:return dt(e,t,t.pendingProps.children,l),t.child;case 10:return n=t.pendingProps,Dl(t,t.type,n.value),dt(e,t,n.children,l),t.child;case 9:return a=t.type._context,n=t.pendingProps.children,yn(t),a=gt(a),n=n(a),t.flags|=1,dt(e,t,n,l),t.child;case 14:return Gf(e,t,t.type,t.pendingProps,l);case 15:return $f(e,t,t.type,t.pendingProps,l);case 19:return Kf(e,t,l);case 31:return n=t.pendingProps,l=t.mode,n={mode:n.mode,children:n.children},e===null?(l=cu(n,l),l.ref=t.ref,t.child=l,l.return=t,t=l):(l=El(e.child,n),l.ref=t.ref,t.child=l,l.return=t,t=l),t;case 22:return qf(e,t,l);case 24:return yn(t),n=gt(nt),e===null?(a=Ic(),a===null&&(a=$e,u=wc(),a.pooledCache=u,u.refCount++,u!==null&&(a.pooledCacheLanes|=l),a=u),t.memoizedState={parent:n,cache:a},Hc(t),Dl(t,nt,a)):((e.lanes&l)!==0&&(zc(e,t),za(t,null,null,l),Ha()),a=e.memoizedState,u=t.memoizedState,a.parent!==n?(a={parent:n,cache:n},t.memoizedState=a,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=a),Dl(t,nt,n)):(n=u.cache,Dl(t,nt,n),n!==a.cache&&Uc(t,[nt],l,!0))),dt(e,t,t.pendingProps.children,l),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function Rl(e){e.flags|=4}function Wf(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!uE(t)){if(t=Xt.current,t!==null&&((Ce&4194048)===Ce?el!==null:(Ce&62914560)!==Ce&&(Ce&536870912)===0||t!==el))throw Ia=Yc,Lo;e.flags|=8192}}function iu(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Os():536870912,e.lanes|=t,ea|=t)}function Ba(e,t){if(!we)switch(e.tailMode){case"hidden":t=e.tail;for(var l=null;t!==null;)t.alternate!==null&&(l=t),t=t.sibling;l===null?e.tail=null:l.sibling=null;break;case"collapsed":l=e.tail;for(var n=null;l!==null;)l.alternate!==null&&(n=l),l=l.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Be(e){var t=e.alternate!==null&&e.alternate.child===e.child,l=0,n=0;if(t)for(var a=e.child;a!==null;)l|=a.lanes|a.childLanes,n|=a.subtreeFlags&65011712,n|=a.flags&65011712,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)l|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=l,t}function hm(e,t,l){var n=t.pendingProps;switch(Oc(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Be(t),null;case 1:return Be(t),null;case 3:return l=t.stateNode,n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),hl(nt),lt(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(Oa(t)?Rl(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,_o())),Be(t),null;case 26:return l=t.memoizedState,e===null?(Rl(t),l!==null?(Be(t),Wf(t,l)):(Be(t),t.flags&=-16777217)):l?l!==e.memoizedState?(Rl(t),Be(t),Wf(t,l)):(Be(t),t.flags&=-16777217):(e.memoizedProps!==n&&Rl(t),Be(t),t.flags&=-16777217),null;case 27:Re(t),l=W.current;var a=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==n&&Rl(t);else{if(!n){if(t.stateNode===null)throw Error(i(166));return Be(t),null}e=q.current,Oa(t)?Mo(t):(e=Wd(a,n,l),t.stateNode=e,Rl(t))}return Be(t),null;case 5:if(Re(t),l=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==n&&Rl(t);else{if(!n){if(t.stateNode===null)throw Error(i(166));return Be(t),null}if(e=q.current,Oa(t))Mo(t);else{switch(a=Ru(W.current),e){case 1:e=a.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:e=a.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":e=a.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":e=a.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof n.is=="string"?a.createElement("select",{is:n.is}):a.createElement("select"),n.multiple?e.multiple=!0:n.size&&(e.size=n.size);break;default:e=typeof n.is=="string"?a.createElement(l,{is:n.is}):a.createElement(l)}}e[ht]=t,e[Nt]=n;e:for(a=t.child;a!==null;){if(a.tag===5||a.tag===6)e.appendChild(a.stateNode);else if(a.tag!==4&&a.tag!==27&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;a.sibling===null;){if(a.return===null||a.return===t)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}t.stateNode=e;e:switch(yt(e,l,n),l){case"button":case"input":case"select":case"textarea":e=!!n.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Rl(t)}}return Be(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==n&&Rl(t);else{if(typeof n!="string"&&t.stateNode===null)throw Error(i(166));if(e=W.current,Oa(t)){if(e=t.stateNode,l=t.memoizedProps,n=null,a=Rt,a!==null)switch(a.tag){case 27:case 5:n=a.memoizedProps}e[ht]=t,e=!!(e.nodeValue===l||n!==null&&n.suppressHydrationWarning===!0||Bd(e.nodeValue,l)),e||dn(t)}else e=Ru(e).createTextNode(n),e[ht]=t,t.stateNode=e}return Be(t),null;case 13:if(n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(a=Oa(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(i(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(i(317));a[ht]=t}else _a(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Be(t),a=!1}else a=_o(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return t.flags&256?(vl(t),t):(vl(t),null)}if(vl(t),(t.flags&128)!==0)return t.lanes=l,t;if(l=n!==null,e=e!==null&&e.memoizedState!==null,l){n=t.child,a=null,n.alternate!==null&&n.alternate.memoizedState!==null&&n.alternate.memoizedState.cachePool!==null&&(a=n.alternate.memoizedState.cachePool.pool);var u=null;n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(u=n.memoizedState.cachePool.pool),u!==a&&(n.flags|=2048)}return l!==e&&l&&(t.child.flags|=8192),iu(t,t.updateQueue),Be(t),null;case 4:return lt(),e===null&&Vi(t.stateNode.containerInfo),Be(t),null;case 10:return hl(t.type),Be(t),null;case 19:if(U(at),a=t.memoizedState,a===null)return Be(t),null;if(n=(t.flags&128)!==0,u=a.rendering,u===null)if(n)Ba(a,!1);else{if(ke!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(u=nu(e),u!==null){for(t.flags|=128,Ba(a,!1),e=u.updateQueue,t.updateQueue=e,iu(t,e),t.subtreeFlags=0,e=l,l=t.child;l!==null;)bo(l,e),l=l.sibling;return L(at,at.current&1|2),t.child}e=e.sibling}a.tail!==null&&Oe()>fu&&(t.flags|=128,n=!0,Ba(a,!1),t.lanes=4194304)}else{if(!n)if(e=nu(u),e!==null){if(t.flags|=128,n=!0,e=e.updateQueue,t.updateQueue=e,iu(t,e),Ba(a,!0),a.tail===null&&a.tailMode==="hidden"&&!u.alternate&&!we)return Be(t),null}else 2*Oe()-a.renderingStartTime>fu&&l!==536870912&&(t.flags|=128,n=!0,Ba(a,!1),t.lanes=4194304);a.isBackwards?(u.sibling=t.child,t.child=u):(e=a.last,e!==null?e.sibling=u:t.child=u,a.last=u)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Oe(),t.sibling=null,e=at.current,L(at,n?e&1|2:e&1),t):(Be(t),null);case 22:case 23:return vl(t),$c(),n=t.memoizedState!==null,e!==null?e.memoizedState!==null!==n&&(t.flags|=8192):n&&(t.flags|=8192),n?(l&536870912)!==0&&(t.flags&128)===0&&(Be(t),t.subtreeFlags&6&&(t.flags|=8192)):Be(t),l=t.updateQueue,l!==null&&iu(t,l.retryQueue),l=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(l=e.memoizedState.cachePool.pool),n=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),n!==l&&(t.flags|=2048),e!==null&&U(mn),null;case 24:return l=null,e!==null&&(l=e.memoizedState.cache),t.memoizedState.cache!==l&&(t.flags|=2048),hl(nt),Be(t),null;case 25:return null;case 30:return null}throw Error(i(156,t.tag))}function gm(e,t){switch(Oc(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return hl(nt),lt(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Re(t),null;case 13:if(vl(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(i(340));_a()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return U(at),null;case 4:return lt(),null;case 10:return hl(t.type),null;case 22:case 23:return vl(t),$c(),e!==null&&U(mn),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return hl(nt),null;case 25:return null;default:return null}}function Pf(e,t){switch(Oc(t),t.tag){case 3:hl(nt),lt();break;case 26:case 27:case 5:Re(t);break;case 4:lt();break;case 13:vl(t);break;case 19:U(at);break;case 10:hl(t.type);break;case 22:case 23:vl(t),$c(),e!==null&&U(mn);break;case 24:hl(nt)}}function Fa(e,t){try{var l=t.updateQueue,n=l!==null?l.lastEffect:null;if(n!==null){var a=n.next;l=a;do{if((l.tag&e)===e){n=void 0;var u=l.create,f=l.inst;n=u(),f.destroy=n}l=l.next}while(l!==a)}}catch(p){Ge(t,t.return,p)}}function Hl(e,t,l){try{var n=t.updateQueue,a=n!==null?n.lastEffect:null;if(a!==null){var u=a.next;n=u;do{if((n.tag&e)===e){var f=n.inst,p=f.destroy;if(p!==void 0){f.destroy=void 0,a=t;var M=l,I=p;try{I()}catch(j){Ge(a,M,j)}}}n=n.next}while(n!==u)}}catch(j){Ge(t,t.return,j)}}function ed(e){var t=e.updateQueue;if(t!==null){var l=e.stateNode;try{Vo(t,l)}catch(n){Ge(e,e.return,n)}}}function td(e,t,l){l.props=hn(e.type,e.memoizedProps),l.state=e.memoizedState;try{l.componentWillUnmount()}catch(n){Ge(e,t,n)}}function Za(e,t){try{var l=e.ref;if(l!==null){switch(e.tag){case 26:case 27:case 5:var n=e.stateNode;break;case 30:n=e.stateNode;break;default:n=e.stateNode}typeof l=="function"?e.refCleanup=l(n):l.current=n}}catch(a){Ge(e,t,a)}}function tl(e,t){var l=e.ref,n=e.refCleanup;if(l!==null)if(typeof n=="function")try{n()}catch(a){Ge(e,t,a)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(a){Ge(e,t,a)}else l.current=null}function ld(e){var t=e.type,l=e.memoizedProps,n=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break e;case"img":l.src?n.src=l.src:l.srcSet&&(n.srcset=l.srcSet)}}catch(a){Ge(e,e.return,a)}}function pi(e,t,l){try{var n=e.stateNode;jm(n,e.type,l,t),n[Nt]=t}catch(a){Ge(e,e.return,a)}}function nd(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Bl(e.type)||e.tag===4}function hi(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||nd(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Bl(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function gi(e,t,l){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(e,t):(t=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,t.appendChild(e),l=l._reactRootContainer,l!=null||t.onclick!==null||(t.onclick=Tu));else if(n!==4&&(n===27&&Bl(e.type)&&(l=e.stateNode,t=null),e=e.child,e!==null))for(gi(e,t,l),e=e.sibling;e!==null;)gi(e,t,l),e=e.sibling}function su(e,t,l){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?l.insertBefore(e,t):l.appendChild(e);else if(n!==4&&(n===27&&Bl(e.type)&&(l=e.stateNode),e=e.child,e!==null))for(su(e,t,l),e=e.sibling;e!==null;)su(e,t,l),e=e.sibling}function ad(e){var t=e.stateNode,l=e.memoizedProps;try{for(var n=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);yt(t,n,l),t[ht]=e,t[Nt]=l}catch(u){Ge(e,e.return,u)}}var Sl=!1,Je=!1,vi=!1,rd=typeof WeakSet=="function"?WeakSet:Set,it=null;function vm(e,t){if(e=e.containerInfo,qi=Mu,e=mo(e),hc(e)){if("selectionStart"in e)var l={start:e.selectionStart,end:e.selectionEnd};else e:{l=(l=e.ownerDocument)&&l.defaultView||window;var n=l.getSelection&&l.getSelection();if(n&&n.rangeCount!==0){l=n.anchorNode;var a=n.anchorOffset,u=n.focusNode;n=n.focusOffset;try{l.nodeType,u.nodeType}catch{l=null;break e}var f=0,p=-1,M=-1,I=0,j=0,G=e,Y=null;t:for(;;){for(var H;G!==l||a!==0&&G.nodeType!==3||(p=f+a),G!==u||n!==0&&G.nodeType!==3||(M=f+n),G.nodeType===3&&(f+=G.nodeValue.length),(H=G.firstChild)!==null;)Y=G,G=H;for(;;){if(G===e)break t;if(Y===l&&++I===a&&(p=f),Y===u&&++j===n&&(M=f),(H=G.nextSibling)!==null)break;G=Y,Y=G.parentNode}G=H}l=p===-1||M===-1?null:{start:p,end:M}}else l=null}l=l||{start:0,end:0}}else l=null;for(Xi={focusedElem:e,selectionRange:l},Mu=!1,it=t;it!==null;)if(t=it,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,it=e;else for(;it!==null;){switch(t=it,u=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&u!==null){e=void 0,l=t,a=u.memoizedProps,u=u.memoizedState,n=l.stateNode;try{var Ee=hn(l.type,a,l.elementType===l.type);e=n.getSnapshotBeforeUpdate(Ee,u),n.__reactInternalSnapshotBeforeUpdate=e}catch(oe){Ge(l,l.return,oe)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,l=e.nodeType,l===9)Zi(e);else if(l===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Zi(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=t.sibling,e!==null){e.return=t.return,it=e;break}it=t.return}}function ud(e,t,l){var n=l.flags;switch(l.tag){case 0:case 11:case 15:zl(e,l),n&4&&Fa(5,l);break;case 1:if(zl(e,l),n&4)if(e=l.stateNode,t===null)try{e.componentDidMount()}catch(f){Ge(l,l.return,f)}else{var a=hn(l.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(f){Ge(l,l.return,f)}}n&64&&ed(l),n&512&&Za(l,l.return);break;case 3:if(zl(e,l),n&64&&(e=l.updateQueue,e!==null)){if(t=null,l.child!==null)switch(l.child.tag){case 27:case 5:t=l.child.stateNode;break;case 1:t=l.child.stateNode}try{Vo(e,t)}catch(f){Ge(l,l.return,f)}}break;case 27:t===null&&n&4&&ad(l);case 26:case 5:zl(e,l),t===null&&n&4&&ld(l),n&512&&Za(l,l.return);break;case 12:zl(e,l);break;case 13:zl(e,l),n&4&&sd(e,l),n&64&&(e=l.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(l=Om.bind(null,l),Fm(e,l))));break;case 22:if(n=l.memoizedState!==null||Sl,!n){t=t!==null&&t.memoizedState!==null||Je,a=Sl;var u=Je;Sl=n,(Je=t)&&!u?jl(e,l,(l.subtreeFlags&8772)!==0):zl(e,l),Sl=a,Je=u}break;case 30:break;default:zl(e,l)}}function cd(e){var t=e.alternate;t!==null&&(e.alternate=null,cd(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Wu(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var qe=null,Ct=!1;function Nl(e,t,l){for(l=l.child;l!==null;)id(e,t,l),l=l.sibling}function id(e,t,l){if(ot&&typeof ot.onCommitFiberUnmount=="function")try{ot.onCommitFiberUnmount(tn,l)}catch{}switch(l.tag){case 26:Je||tl(l,t),Nl(e,t,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Je||tl(l,t);var n=qe,a=Ct;Bl(l.type)&&(qe=l.stateNode,Ct=!1),Nl(e,t,l),lr(l.stateNode),qe=n,Ct=a;break;case 5:Je||tl(l,t);case 6:if(n=qe,a=Ct,qe=null,Nl(e,t,l),qe=n,Ct=a,qe!==null)if(Ct)try{(qe.nodeType===9?qe.body:qe.nodeName==="HTML"?qe.ownerDocument.body:qe).removeChild(l.stateNode)}catch(u){Ge(l,t,u)}else try{qe.removeChild(l.stateNode)}catch(u){Ge(l,t,u)}break;case 18:qe!==null&&(Ct?(e=qe,Kd(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,l.stateNode),or(e)):Kd(qe,l.stateNode));break;case 4:n=qe,a=Ct,qe=l.stateNode.containerInfo,Ct=!0,Nl(e,t,l),qe=n,Ct=a;break;case 0:case 11:case 14:case 15:Je||Hl(2,l,t),Je||Hl(4,l,t),Nl(e,t,l);break;case 1:Je||(tl(l,t),n=l.stateNode,typeof n.componentWillUnmount=="function"&&td(l,t,n)),Nl(e,t,l);break;case 21:Nl(e,t,l);break;case 22:Je=(n=Je)||l.memoizedState!==null,Nl(e,t,l),Je=n;break;default:Nl(e,t,l)}}function sd(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{or(e)}catch(l){Ge(t,t.return,l)}}function Tm(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new rd),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new rd),t;default:throw Error(i(435,e.tag))}}function Ti(e,t){var l=Tm(e);t.forEach(function(n){var a=_m.bind(null,e,n);l.has(n)||(l.add(n),n.then(a,a))})}function Ut(e,t){var l=t.deletions;if(l!==null)for(var n=0;n<l.length;n++){var a=l[n],u=e,f=t,p=f;e:for(;p!==null;){switch(p.tag){case 27:if(Bl(p.type)){qe=p.stateNode,Ct=!1;break e}break;case 5:qe=p.stateNode,Ct=!1;break e;case 3:case 4:qe=p.stateNode.containerInfo,Ct=!0;break e}p=p.return}if(qe===null)throw Error(i(160));id(u,f,a),qe=null,Ct=!1,u=a.alternate,u!==null&&(u.return=null),a.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)od(t,e),t=t.sibling}var Jt=null;function od(e,t){var l=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ut(t,e),wt(e),n&4&&(Hl(3,e,e.return),Fa(3,e),Hl(5,e,e.return));break;case 1:Ut(t,e),wt(e),n&512&&(Je||l===null||tl(l,l.return)),n&64&&Sl&&(e=e.updateQueue,e!==null&&(n=e.callbacks,n!==null&&(l=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=l===null?n:l.concat(n))));break;case 26:var a=Jt;if(Ut(t,e),wt(e),n&512&&(Je||l===null||tl(l,l.return)),n&4){var u=l!==null?l.memoizedState:null;if(n=e.memoizedState,l===null)if(n===null)if(e.stateNode===null){e:{n=e.type,l=e.memoizedProps,a=a.ownerDocument||a;t:switch(n){case"title":u=a.getElementsByTagName("title")[0],(!u||u[ha]||u[ht]||u.namespaceURI==="http://www.w3.org/2000/svg"||u.hasAttribute("itemprop"))&&(u=a.createElement(n),a.head.insertBefore(u,a.querySelector("head > title"))),yt(u,n,l),u[ht]=e,ut(u),n=u;break e;case"link":var f=aE("link","href",a).get(n+(l.href||""));if(f){for(var p=0;p<f.length;p++)if(u=f[p],u.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&u.getAttribute("rel")===(l.rel==null?null:l.rel)&&u.getAttribute("title")===(l.title==null?null:l.title)&&u.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){f.splice(p,1);break t}}u=a.createElement(n),yt(u,n,l),a.head.appendChild(u);break;case"meta":if(f=aE("meta","content",a).get(n+(l.content||""))){for(p=0;p<f.length;p++)if(u=f[p],u.getAttribute("content")===(l.content==null?null:""+l.content)&&u.getAttribute("name")===(l.name==null?null:l.name)&&u.getAttribute("property")===(l.property==null?null:l.property)&&u.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&u.getAttribute("charset")===(l.charSet==null?null:l.charSet)){f.splice(p,1);break t}}u=a.createElement(n),yt(u,n,l),a.head.appendChild(u);break;default:throw Error(i(468,n))}u[ht]=e,ut(u),n=u}e.stateNode=n}else rE(a,e.type,e.stateNode);else e.stateNode=nE(a,n,e.memoizedProps);else u!==n?(u===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):u.count--,n===null?rE(a,e.type,e.stateNode):nE(a,n,e.memoizedProps)):n===null&&e.stateNode!==null&&pi(e,e.memoizedProps,l.memoizedProps)}break;case 27:Ut(t,e),wt(e),n&512&&(Je||l===null||tl(l,l.return)),l!==null&&n&4&&pi(e,e.memoizedProps,l.memoizedProps);break;case 5:if(Ut(t,e),wt(e),n&512&&(Je||l===null||tl(l,l.return)),e.flags&32){a=e.stateNode;try{Un(a,"")}catch(H){Ge(e,e.return,H)}}n&4&&e.stateNode!=null&&(a=e.memoizedProps,pi(e,a,l!==null?l.memoizedProps:a)),n&1024&&(vi=!0);break;case 6:if(Ut(t,e),wt(e),n&4){if(e.stateNode===null)throw Error(i(162));n=e.memoizedProps,l=e.stateNode;try{l.nodeValue=n}catch(H){Ge(e,e.return,H)}}break;case 3:if(Au=null,a=Jt,Jt=Su(t.containerInfo),Ut(t,e),Jt=a,wt(e),n&4&&l!==null&&l.memoizedState.isDehydrated)try{or(t.containerInfo)}catch(H){Ge(e,e.return,H)}vi&&(vi=!1,fd(e));break;case 4:n=Jt,Jt=Su(e.stateNode.containerInfo),Ut(t,e),wt(e),Jt=n;break;case 12:Ut(t,e),wt(e);break;case 13:Ut(t,e),wt(e),e.child.flags&8192&&e.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Ci=Oe()),n&4&&(n=e.updateQueue,n!==null&&(e.updateQueue=null,Ti(e,n)));break;case 22:a=e.memoizedState!==null;var M=l!==null&&l.memoizedState!==null,I=Sl,j=Je;if(Sl=I||a,Je=j||M,Ut(t,e),Je=j,Sl=I,wt(e),n&8192)e:for(t=e.stateNode,t._visibility=a?t._visibility&-2:t._visibility|1,a&&(l===null||M||Sl||Je||gn(e)),l=null,t=e;;){if(t.tag===5||t.tag===26){if(l===null){M=l=t;try{if(u=M.stateNode,a)f=u.style,typeof f.setProperty=="function"?f.setProperty("display","none","important"):f.display="none";else{p=M.stateNode;var G=M.memoizedProps.style,Y=G!=null&&G.hasOwnProperty("display")?G.display:null;p.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(H){Ge(M,M.return,H)}}}else if(t.tag===6){if(l===null){M=t;try{M.stateNode.nodeValue=a?"":M.memoizedProps}catch(H){Ge(M,M.return,H)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;l===t&&(l=null),t=t.return}l===t&&(l=null),t.sibling.return=t.return,t=t.sibling}n&4&&(n=e.updateQueue,n!==null&&(l=n.retryQueue,l!==null&&(n.retryQueue=null,Ti(e,l))));break;case 19:Ut(t,e),wt(e),n&4&&(n=e.updateQueue,n!==null&&(e.updateQueue=null,Ti(e,n)));break;case 30:break;case 21:break;default:Ut(t,e),wt(e)}}function wt(e){var t=e.flags;if(t&2){try{for(var l,n=e.return;n!==null;){if(nd(n)){l=n;break}n=n.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var a=l.stateNode,u=hi(e);su(e,u,a);break;case 5:var f=l.stateNode;l.flags&32&&(Un(f,""),l.flags&=-33);var p=hi(e);su(e,p,f);break;case 3:case 4:var M=l.stateNode.containerInfo,I=hi(e);gi(e,I,M);break;default:throw Error(i(161))}}catch(j){Ge(e,e.return,j)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function fd(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;fd(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function zl(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)ud(e,t.alternate,t),t=t.sibling}function gn(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Hl(4,t,t.return),gn(t);break;case 1:tl(t,t.return);var l=t.stateNode;typeof l.componentWillUnmount=="function"&&td(t,t.return,l),gn(t);break;case 27:lr(t.stateNode);case 26:case 5:tl(t,t.return),gn(t);break;case 22:t.memoizedState===null&&gn(t);break;case 30:gn(t);break;default:gn(t)}e=e.sibling}}function jl(e,t,l){for(l=l&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var n=t.alternate,a=e,u=t,f=u.flags;switch(u.tag){case 0:case 11:case 15:jl(a,u,l),Fa(4,u);break;case 1:if(jl(a,u,l),n=u,a=n.stateNode,typeof a.componentDidMount=="function")try{a.componentDidMount()}catch(I){Ge(n,n.return,I)}if(n=u,a=n.updateQueue,a!==null){var p=n.stateNode;try{var M=a.shared.hiddenCallbacks;if(M!==null)for(a.shared.hiddenCallbacks=null,a=0;a<M.length;a++)jo(M[a],p)}catch(I){Ge(n,n.return,I)}}l&&f&64&&ed(u),Za(u,u.return);break;case 27:ad(u);case 26:case 5:jl(a,u,l),l&&n===null&&f&4&&ld(u),Za(u,u.return);break;case 12:jl(a,u,l);break;case 13:jl(a,u,l),l&&f&4&&sd(a,u);break;case 22:u.memoizedState===null&&jl(a,u,l),Za(u,u.return);break;case 30:break;default:jl(a,u,l)}t=t.sibling}}function Ri(e,t){var l=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(l=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==l&&(e!=null&&e.refCount++,l!=null&&Ua(l))}function Si(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Ua(e))}function ll(e,t,l,n){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)dd(e,t,l,n),t=t.sibling}function dd(e,t,l,n){var a=t.flags;switch(t.tag){case 0:case 11:case 15:ll(e,t,l,n),a&2048&&Fa(9,t);break;case 1:ll(e,t,l,n);break;case 3:ll(e,t,l,n),a&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Ua(e)));break;case 12:if(a&2048){ll(e,t,l,n),e=t.stateNode;try{var u=t.memoizedProps,f=u.id,p=u.onPostCommit;typeof p=="function"&&p(f,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(M){Ge(t,t.return,M)}}else ll(e,t,l,n);break;case 13:ll(e,t,l,n);break;case 23:break;case 22:u=t.stateNode,f=t.alternate,t.memoizedState!==null?u._visibility&2?ll(e,t,l,n):Qa(e,t):u._visibility&2?ll(e,t,l,n):(u._visibility|=2,Jn(e,t,l,n,(t.subtreeFlags&10256)!==0)),a&2048&&Ri(f,t);break;case 24:ll(e,t,l,n),a&2048&&Si(t.alternate,t);break;default:ll(e,t,l,n)}}function Jn(e,t,l,n,a){for(a=a&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var u=e,f=t,p=l,M=n,I=f.flags;switch(f.tag){case 0:case 11:case 15:Jn(u,f,p,M,a),Fa(8,f);break;case 23:break;case 22:var j=f.stateNode;f.memoizedState!==null?j._visibility&2?Jn(u,f,p,M,a):Qa(u,f):(j._visibility|=2,Jn(u,f,p,M,a)),a&&I&2048&&Ri(f.alternate,f);break;case 24:Jn(u,f,p,M,a),a&&I&2048&&Si(f.alternate,f);break;default:Jn(u,f,p,M,a)}t=t.sibling}}function Qa(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var l=e,n=t,a=n.flags;switch(n.tag){case 22:Qa(l,n),a&2048&&Ri(n.alternate,n);break;case 24:Qa(l,n),a&2048&&Si(n.alternate,n);break;default:Qa(l,n)}t=t.sibling}}var ka=8192;function Wn(e){if(e.subtreeFlags&ka)for(e=e.child;e!==null;)Ed(e),e=e.sibling}function Ed(e){switch(e.tag){case 26:Wn(e),e.flags&ka&&e.memoizedState!==null&&r0(Jt,e.memoizedState,e.memoizedProps);break;case 5:Wn(e);break;case 3:case 4:var t=Jt;Jt=Su(e.stateNode.containerInfo),Wn(e),Jt=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=ka,ka=16777216,Wn(e),ka=t):Wn(e));break;default:Wn(e)}}function yd(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Ka(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var l=0;l<t.length;l++){var n=t[l];it=n,pd(n,e)}yd(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)md(e),e=e.sibling}function md(e){switch(e.tag){case 0:case 11:case 15:Ka(e),e.flags&2048&&Hl(9,e,e.return);break;case 3:Ka(e);break;case 12:Ka(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,ou(e)):Ka(e);break;default:Ka(e)}}function ou(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var l=0;l<t.length;l++){var n=t[l];it=n,pd(n,e)}yd(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Hl(8,t,t.return),ou(t);break;case 22:l=t.stateNode,l._visibility&2&&(l._visibility&=-3,ou(t));break;default:ou(t)}e=e.sibling}}function pd(e,t){for(;it!==null;){var l=it;switch(l.tag){case 0:case 11:case 15:Hl(8,l,t);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var n=l.memoizedState.cachePool.pool;n!=null&&n.refCount++}break;case 24:Ua(l.memoizedState.cache)}if(n=l.child,n!==null)n.return=l,it=n;else e:for(l=e;it!==null;){n=it;var a=n.sibling,u=n.return;if(cd(n),n===l){it=null;break e}if(a!==null){a.return=u,it=a;break e}it=u}}}var Rm={getCacheForType:function(e){var t=gt(nt),l=t.data.get(e);return l===void 0&&(l=e(),t.data.set(e,l)),l}},Sm=typeof WeakMap=="function"?WeakMap:Map,Ie=0,$e=null,Ne=null,Ce=0,Ye=0,Lt=null,Vl=!1,Pn=!1,Ni=!1,Al=0,ke=0,Gl=0,vn=0,Ai=0,Bt=0,ea=0,Ja=null,Mt=null,bi=!1,Ci=0,fu=1/0,du=null,$l=null,Et=0,ql=null,ta=null,la=0,Mi=0,Oi=null,hd=null,Wa=0,_i=null;function It(){if((Ie&2)!==0&&Ce!==0)return Ce&-Ce;if(A.T!==null){var e=qn;return e!==0?e:Yi()}return xs()}function gd(){Bt===0&&(Bt=(Ce&536870912)===0||we?Ms():536870912);var e=Xt.current;return e!==null&&(e.flags|=32),Bt}function Yt(e,t,l){(e===$e&&(Ye===2||Ye===9)||e.cancelPendingCommit!==null)&&(na(e,0),Xl(e,Ce,Bt,!1)),pa(e,l),((Ie&2)===0||e!==$e)&&(e===$e&&((Ie&2)===0&&(vn|=l),ke===4&&Xl(e,Ce,Bt,!1)),nl(e))}function vd(e,t,l){if((Ie&6)!==0)throw Error(i(327));var n=!l&&(t&124)===0&&(t&e.expiredLanes)===0||ma(e,t),a=n?bm(e,t):Ui(e,t,!0),u=n;do{if(a===0){Pn&&!n&&Xl(e,t,0,!1);break}else{if(l=e.current.alternate,u&&!Nm(l)){a=Ui(e,t,!1),u=!1;continue}if(a===2){if(u=t,e.errorRecoveryDisabledLanes&u)var f=0;else f=e.pendingLanes&-536870913,f=f!==0?f:f&536870912?536870912:0;if(f!==0){t=f;e:{var p=e;a=Ja;var M=p.current.memoizedState.isDehydrated;if(M&&(na(p,f).flags|=256),f=Ui(p,f,!1),f!==2){if(Ni&&!M){p.errorRecoveryDisabledLanes|=u,vn|=u,a=4;break e}u=Mt,Mt=a,u!==null&&(Mt===null?Mt=u:Mt.push.apply(Mt,u))}a=f}if(u=!1,a!==2)continue}}if(a===1){na(e,0),Xl(e,t,0,!0);break}e:{switch(n=e,u=a,u){case 0:case 1:throw Error(i(345));case 4:if((t&4194048)!==t)break;case 6:Xl(n,t,Bt,!Vl);break e;case 2:Mt=null;break;case 3:case 5:break;default:throw Error(i(329))}if((t&62914560)===t&&(a=Ci+300-Oe(),10<a)){if(Xl(n,t,Bt,!Vl),Nr(n,0,!0)!==0)break e;n.timeoutHandle=Qd(Td.bind(null,n,l,Mt,du,bi,t,Bt,vn,ea,Vl,u,2,-0,0),a);break e}Td(n,l,Mt,du,bi,t,Bt,vn,ea,Vl,u,0,-0,0)}}break}while(!0);nl(e)}function Td(e,t,l,n,a,u,f,p,M,I,j,G,Y,H){if(e.timeoutHandle=-1,G=t.subtreeFlags,(G&8192||(G&16785408)===16785408)&&(rr={stylesheets:null,count:0,unsuspend:a0},Ed(t),G=u0(),G!==null)){e.cancelPendingCommit=G(Md.bind(null,e,t,u,l,n,a,f,p,M,j,1,Y,H)),Xl(e,u,f,!I);return}Md(e,t,u,l,n,a,f,p,M)}function Nm(e){for(var t=e;;){var l=t.tag;if((l===0||l===11||l===15)&&t.flags&16384&&(l=t.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var n=0;n<l.length;n++){var a=l[n],u=a.getSnapshot;a=a.value;try{if(!Dt(u(),a))return!1}catch{return!1}}if(l=t.child,t.subtreeFlags&16384&&l!==null)l.return=t,t=l;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xl(e,t,l,n){t&=~Ai,t&=~vn,e.suspendedLanes|=t,e.pingedLanes&=~t,n&&(e.warmLanes|=t),n=e.expirationTimes;for(var a=t;0<a;){var u=31-ft(a),f=1<<u;n[u]=-1,a&=~f}l!==0&&_s(e,l,t)}function Eu(){return(Ie&6)===0?(Pa(0),!1):!0}function Di(){if(Ne!==null){if(Ye===0)var e=Ne.return;else e=Ne,pl=En=null,Zc(e),kn=null,qa=0,e=Ne;for(;e!==null;)Pf(e.alternate,e),e=e.return;Ne=null}}function na(e,t){var l=e.timeoutHandle;l!==-1&&(e.timeoutHandle=-1,Gm(l)),l=e.cancelPendingCommit,l!==null&&(e.cancelPendingCommit=null,l()),Di(),$e=e,Ne=l=El(e.current,null),Ce=t,Ye=0,Lt=null,Vl=!1,Pn=ma(e,t),Ni=!1,ea=Bt=Ai=vn=Gl=ke=0,Mt=Ja=null,bi=!1,(t&8)!==0&&(t|=t&32);var n=e.entangledLanes;if(n!==0)for(e=e.entanglements,n&=t;0<n;){var a=31-ft(n),u=1<<a;t|=e[a],n&=~u}return Al=t,Ir(),l}function Rd(e,t){ve=null,A.H=eu,t===La||t===Xr?(t=Ho(),Ye=3):t===Lo?(t=Ho(),Ye=4):Ye=t===jf?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Lt=t,Ne===null&&(ke=1,ru(e,Vt(t,e.current)))}function Sd(){var e=A.H;return A.H=eu,e===null?eu:e}function Nd(){var e=A.A;return A.A=Rm,e}function xi(){ke=4,Vl||(Ce&4194048)!==Ce&&Xt.current!==null||(Pn=!0),(Gl&134217727)===0&&(vn&134217727)===0||$e===null||Xl($e,Ce,Bt,!1)}function Ui(e,t,l){var n=Ie;Ie|=2;var a=Sd(),u=Nd();($e!==e||Ce!==t)&&(du=null,na(e,t)),t=!1;var f=ke;e:do try{if(Ye!==0&&Ne!==null){var p=Ne,M=Lt;switch(Ye){case 8:Di(),f=6;break e;case 3:case 2:case 9:case 6:Xt.current===null&&(t=!0);var I=Ye;if(Ye=0,Lt=null,aa(e,p,M,I),l&&Pn){f=0;break e}break;default:I=Ye,Ye=0,Lt=null,aa(e,p,M,I)}}Am(),f=ke;break}catch(j){Rd(e,j)}while(!0);return t&&e.shellSuspendCounter++,pl=En=null,Ie=n,A.H=a,A.A=u,Ne===null&&($e=null,Ce=0,Ir()),f}function Am(){for(;Ne!==null;)Ad(Ne)}function bm(e,t){var l=Ie;Ie|=2;var n=Sd(),a=Nd();$e!==e||Ce!==t?(du=null,fu=Oe()+500,na(e,t)):Pn=ma(e,t);e:do try{if(Ye!==0&&Ne!==null){t=Ne;var u=Lt;t:switch(Ye){case 1:Ye=0,Lt=null,aa(e,t,u,1);break;case 2:case 9:if(Io(u)){Ye=0,Lt=null,bd(t);break}t=function(){Ye!==2&&Ye!==9||$e!==e||(Ye=7),nl(e)},u.then(t,t);break e;case 3:Ye=7;break e;case 4:Ye=5;break e;case 7:Io(u)?(Ye=0,Lt=null,bd(t)):(Ye=0,Lt=null,aa(e,t,u,7));break;case 5:var f=null;switch(Ne.tag){case 26:f=Ne.memoizedState;case 5:case 27:var p=Ne;if(!f||uE(f)){Ye=0,Lt=null;var M=p.sibling;if(M!==null)Ne=M;else{var I=p.return;I!==null?(Ne=I,yu(I)):Ne=null}break t}}Ye=0,Lt=null,aa(e,t,u,5);break;case 6:Ye=0,Lt=null,aa(e,t,u,6);break;case 8:Di(),ke=6;break e;default:throw Error(i(462))}}Cm();break}catch(j){Rd(e,j)}while(!0);return pl=En=null,A.H=n,A.A=a,Ie=l,Ne!==null?0:($e=null,Ce=0,Ir(),ke)}function Cm(){for(;Ne!==null&&!de();)Ad(Ne)}function Ad(e){var t=Jf(e.alternate,e,Al);e.memoizedProps=e.pendingProps,t===null?yu(e):Ne=t}function bd(e){var t=e,l=t.alternate;switch(t.tag){case 15:case 0:t=Bf(l,t,t.pendingProps,t.type,void 0,Ce);break;case 11:t=Bf(l,t,t.pendingProps,t.type.render,t.ref,Ce);break;case 5:Zc(t);default:Pf(l,t),t=Ne=bo(t,Al),t=Jf(l,t,Al)}e.memoizedProps=e.pendingProps,t===null?yu(e):Ne=t}function aa(e,t,l,n){pl=En=null,Zc(t),kn=null,qa=0;var a=t.return;try{if(mm(e,a,t,l,Ce)){ke=1,ru(e,Vt(l,e.current)),Ne=null;return}}catch(u){if(a!==null)throw Ne=a,u;ke=1,ru(e,Vt(l,e.current)),Ne=null;return}t.flags&32768?(we||n===1?e=!0:Pn||(Ce&536870912)!==0?e=!1:(Vl=e=!0,(n===2||n===9||n===3||n===6)&&(n=Xt.current,n!==null&&n.tag===13&&(n.flags|=16384))),Cd(t,e)):yu(t)}function yu(e){var t=e;do{if((t.flags&32768)!==0){Cd(t,Vl);return}e=t.return;var l=hm(t.alternate,t,Al);if(l!==null){Ne=l;return}if(t=t.sibling,t!==null){Ne=t;return}Ne=t=e}while(t!==null);ke===0&&(ke=5)}function Cd(e,t){do{var l=gm(e.alternate,e);if(l!==null){l.flags&=32767,Ne=l;return}if(l=e.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!t&&(e=e.sibling,e!==null)){Ne=e;return}Ne=e=l}while(e!==null);ke=6,Ne=null}function Md(e,t,l,n,a,u,f,p,M){e.cancelPendingCommit=null;do mu();while(Et!==0);if((Ie&6)!==0)throw Error(i(327));if(t!==null){if(t===e.current)throw Error(i(177));if(u=t.lanes|t.childLanes,u|=Sc,ay(e,l,u,f,p,M),e===$e&&(Ne=$e=null,Ce=0),ta=t,ql=e,la=l,Mi=u,Oi=a,hd=n,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Dm(pt,function(){return Ud(),null})):(e.callbackNode=null,e.callbackPriority=0),n=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||n){n=A.T,A.T=null,a=S.p,S.p=2,f=Ie,Ie|=4;try{vm(e,t,l)}finally{Ie=f,S.p=a,A.T=n}}Et=1,Od(),_d(),Dd()}}function Od(){if(Et===1){Et=0;var e=ql,t=ta,l=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||l){l=A.T,A.T=null;var n=S.p;S.p=2;var a=Ie;Ie|=4;try{od(t,e);var u=Xi,f=mo(e.containerInfo),p=u.focusedElem,M=u.selectionRange;if(f!==p&&p&&p.ownerDocument&&yo(p.ownerDocument.documentElement,p)){if(M!==null&&hc(p)){var I=M.start,j=M.end;if(j===void 0&&(j=I),"selectionStart"in p)p.selectionStart=I,p.selectionEnd=Math.min(j,p.value.length);else{var G=p.ownerDocument||document,Y=G&&G.defaultView||window;if(Y.getSelection){var H=Y.getSelection(),Ee=p.textContent.length,oe=Math.min(M.start,Ee),je=M.end===void 0?oe:Math.min(M.end,Ee);!H.extend&&oe>je&&(f=je,je=oe,oe=f);var x=Eo(p,oe),_=Eo(p,je);if(x&&_&&(H.rangeCount!==1||H.anchorNode!==x.node||H.anchorOffset!==x.offset||H.focusNode!==_.node||H.focusOffset!==_.offset)){var w=G.createRange();w.setStart(x.node,x.offset),H.removeAllRanges(),oe>je?(H.addRange(w),H.extend(_.node,_.offset)):(w.setEnd(_.node,_.offset),H.addRange(w))}}}}for(G=[],H=p;H=H.parentNode;)H.nodeType===1&&G.push({element:H,left:H.scrollLeft,top:H.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<G.length;p++){var V=G[p];V.element.scrollLeft=V.left,V.element.scrollTop=V.top}}Mu=!!qi,Xi=qi=null}finally{Ie=a,S.p=n,A.T=l}}e.current=t,Et=2}}function _d(){if(Et===2){Et=0;var e=ql,t=ta,l=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||l){l=A.T,A.T=null;var n=S.p;S.p=2;var a=Ie;Ie|=4;try{ud(e,t.alternate,t)}finally{Ie=a,S.p=n,A.T=l}}Et=3}}function Dd(){if(Et===4||Et===3){Et=0,Se();var e=ql,t=ta,l=la,n=hd;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Et=5:(Et=0,ta=ql=null,xd(e,e.pendingLanes));var a=e.pendingLanes;if(a===0&&($l=null),Ku(l),t=t.stateNode,ot&&typeof ot.onCommitFiberRoot=="function")try{ot.onCommitFiberRoot(tn,t,void 0,(t.current.flags&128)===128)}catch{}if(n!==null){t=A.T,a=S.p,S.p=2,A.T=null;try{for(var u=e.onRecoverableError,f=0;f<n.length;f++){var p=n[f];u(p.value,{componentStack:p.stack})}}finally{A.T=t,S.p=a}}(la&3)!==0&&mu(),nl(e),a=e.pendingLanes,(l&4194090)!==0&&(a&42)!==0?e===_i?Wa++:(Wa=0,_i=e):Wa=0,Pa(0)}}function xd(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Ua(t)))}function mu(e){return Od(),_d(),Dd(),Ud()}function Ud(){if(Et!==5)return!1;var e=ql,t=Mi;Mi=0;var l=Ku(la),n=A.T,a=S.p;try{S.p=32>l?32:l,A.T=null,l=Oi,Oi=null;var u=ql,f=la;if(Et=0,ta=ql=null,la=0,(Ie&6)!==0)throw Error(i(331));var p=Ie;if(Ie|=4,md(u.current),dd(u,u.current,f,l),Ie=p,Pa(0,!1),ot&&typeof ot.onPostCommitFiberRoot=="function")try{ot.onPostCommitFiberRoot(tn,u)}catch{}return!0}finally{S.p=a,A.T=n,xd(e,t)}}function wd(e,t,l){t=Vt(l,t),t=ci(e.stateNode,t,2),e=wl(e,t,2),e!==null&&(pa(e,2),nl(e))}function Ge(e,t,l){if(e.tag===3)wd(e,e,l);else for(;t!==null;){if(t.tag===3){wd(t,e,l);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&($l===null||!$l.has(n))){e=Vt(l,e),l=Hf(2),n=wl(t,l,2),n!==null&&(zf(l,n,t,e),pa(n,2),nl(n));break}}t=t.return}}function wi(e,t,l){var n=e.pingCache;if(n===null){n=e.pingCache=new Sm;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(l)||(Ni=!0,a.add(l),e=Mm.bind(null,e,t,l),t.then(e,e))}function Mm(e,t,l){var n=e.pingCache;n!==null&&n.delete(t),e.pingedLanes|=e.suspendedLanes&l,e.warmLanes&=~l,$e===e&&(Ce&l)===l&&(ke===4||ke===3&&(Ce&62914560)===Ce&&300>Oe()-Ci?(Ie&2)===0&&na(e,0):Ai|=l,ea===Ce&&(ea=0)),nl(e)}function Ld(e,t){t===0&&(t=Os()),e=jn(e,t),e!==null&&(pa(e,t),nl(e))}function Om(e){var t=e.memoizedState,l=0;t!==null&&(l=t.retryLane),Ld(e,l)}function _m(e,t){var l=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(l=a.retryLane);break;case 19:n=e.stateNode;break;case 22:n=e.stateNode._retryCache;break;default:throw Error(i(314))}n!==null&&n.delete(t),Ld(e,l)}function Dm(e,t){return P(e,t)}var pu=null,ra=null,Li=!1,hu=!1,Ii=!1,Tn=0;function nl(e){e!==ra&&e.next===null&&(ra===null?pu=ra=e:ra=ra.next=e),hu=!0,Li||(Li=!0,Um())}function Pa(e,t){if(!Ii&&hu){Ii=!0;do for(var l=!1,n=pu;n!==null;){if(e!==0){var a=n.pendingLanes;if(a===0)var u=0;else{var f=n.suspendedLanes,p=n.pingedLanes;u=(1<<31-ft(42|e)+1)-1,u&=a&~(f&~p),u=u&201326741?u&201326741|1:u?u|2:0}u!==0&&(l=!0,zd(n,u))}else u=Ce,u=Nr(n,n===$e?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),(u&3)===0||ma(n,u)||(l=!0,zd(n,u));n=n.next}while(l);Ii=!1}}function xm(){Id()}function Id(){hu=Li=!1;var e=0;Tn!==0&&(Vm()&&(e=Tn),Tn=0);for(var t=Oe(),l=null,n=pu;n!==null;){var a=n.next,u=Yd(n,t);u===0?(n.next=null,l===null?pu=a:l.next=a,a===null&&(ra=l)):(l=n,(e!==0||(u&3)!==0)&&(hu=!0)),n=a}Pa(e)}function Yd(e,t){for(var l=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,u=e.pendingLanes&-62914561;0<u;){var f=31-ft(u),p=1<<f,M=a[f];M===-1?((p&l)===0||(p&n)!==0)&&(a[f]=ny(p,t)):M<=t&&(e.expiredLanes|=p),u&=~p}if(t=$e,l=Ce,l=Nr(e,e===t?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),n=e.callbackNode,l===0||e===t&&(Ye===2||Ye===9)||e.cancelPendingCommit!==null)return n!==null&&n!==null&&ge(n),e.callbackNode=null,e.callbackPriority=0;if((l&3)===0||ma(e,l)){if(t=l&-l,t===e.callbackPriority)return t;switch(n!==null&&ge(n),Ku(l)){case 2:case 8:l=Ht;break;case 32:l=pt;break;case 268435456:l=Ze;break;default:l=pt}return n=Hd.bind(null,e),l=P(l,n),e.callbackPriority=t,e.callbackNode=l,t}return n!==null&&n!==null&&ge(n),e.callbackPriority=2,e.callbackNode=null,2}function Hd(e,t){if(Et!==0&&Et!==5)return e.callbackNode=null,e.callbackPriority=0,null;var l=e.callbackNode;if(mu()&&e.callbackNode!==l)return null;var n=Ce;return n=Nr(e,e===$e?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),n===0?null:(vd(e,n,t),Yd(e,Oe()),e.callbackNode!=null&&e.callbackNode===l?Hd.bind(null,e):null)}function zd(e,t){if(mu())return null;vd(e,t,!0)}function Um(){$m(function(){(Ie&6)!==0?P(Xe,xm):Id()})}function Yi(){return Tn===0&&(Tn=Ms()),Tn}function jd(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Or(""+e)}function Vd(e,t){var l=t.ownerDocument.createElement("input");return l.name=t.name,l.value=t.value,e.id&&l.setAttribute("form",e.id),t.parentNode.insertBefore(l,t),e=new FormData(e),l.parentNode.removeChild(l),e}function wm(e,t,l,n,a){if(t==="submit"&&l&&l.stateNode===a){var u=jd((a[Nt]||null).action),f=n.submitter;f&&(t=(t=f[Nt]||null)?jd(t.formAction):f.getAttribute("formAction"),t!==null&&(u=t,f=null));var p=new Ur("action","action",null,n,a);e.push({event:p,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(Tn!==0){var M=f?Vd(a,f):new FormData(a);li(l,{pending:!0,data:M,method:a.method,action:u},null,M)}}else typeof u=="function"&&(p.preventDefault(),M=f?Vd(a,f):new FormData(a),li(l,{pending:!0,data:M,method:a.method,action:u},u,M))},currentTarget:a}]})}}for(var Hi=0;Hi<Rc.length;Hi++){var zi=Rc[Hi],Lm=zi.toLowerCase(),Im=zi[0].toUpperCase()+zi.slice(1);Kt(Lm,"on"+Im)}Kt(go,"onAnimationEnd"),Kt(vo,"onAnimationIteration"),Kt(To,"onAnimationStart"),Kt("dblclick","onDoubleClick"),Kt("focusin","onFocus"),Kt("focusout","onBlur"),Kt(Wy,"onTransitionRun"),Kt(Py,"onTransitionStart"),Kt(em,"onTransitionCancel"),Kt(Ro,"onTransitionEnd"),_n("onMouseEnter",["mouseout","mouseover"]),_n("onMouseLeave",["mouseout","mouseover"]),_n("onPointerEnter",["pointerout","pointerover"]),_n("onPointerLeave",["pointerout","pointerover"]),nn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),nn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),nn("onBeforeInput",["compositionend","keypress","textInput","paste"]),nn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),nn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),nn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var er="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ym=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(er));function Gd(e,t){t=(t&4)!==0;for(var l=0;l<e.length;l++){var n=e[l],a=n.event;n=n.listeners;e:{var u=void 0;if(t)for(var f=n.length-1;0<=f;f--){var p=n[f],M=p.instance,I=p.currentTarget;if(p=p.listener,M!==u&&a.isPropagationStopped())break e;u=p,a.currentTarget=I;try{u(a)}catch(j){au(j)}a.currentTarget=null,u=M}else for(f=0;f<n.length;f++){if(p=n[f],M=p.instance,I=p.currentTarget,p=p.listener,M!==u&&a.isPropagationStopped())break e;u=p,a.currentTarget=I;try{u(a)}catch(j){au(j)}a.currentTarget=null,u=M}}}}function Ae(e,t){var l=t[Ju];l===void 0&&(l=t[Ju]=new Set);var n=e+"__bubble";l.has(n)||($d(t,e,2,!1),l.add(n))}function ji(e,t,l){var n=0;t&&(n|=4),$d(l,e,n,t)}var gu="_reactListening"+Math.random().toString(36).slice(2);function Vi(e){if(!e[gu]){e[gu]=!0,ws.forEach(function(l){l!=="selectionchange"&&(Ym.has(l)||ji(l,!1,e),ji(l,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[gu]||(t[gu]=!0,ji("selectionchange",!1,t))}}function $d(e,t,l,n){switch(dE(t)){case 2:var a=s0;break;case 8:a=o0;break;default:a=es}l=a.bind(null,t,l,e),a=void 0,!ic||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,l,{capture:!0,passive:a}):e.addEventListener(t,l,!0):a!==void 0?e.addEventListener(t,l,{passive:a}):e.addEventListener(t,l,!1)}function Gi(e,t,l,n,a){var u=n;if((t&1)===0&&(t&2)===0&&n!==null)e:for(;;){if(n===null)return;var f=n.tag;if(f===3||f===4){var p=n.stateNode.containerInfo;if(p===a)break;if(f===4)for(f=n.return;f!==null;){var M=f.tag;if((M===3||M===4)&&f.stateNode.containerInfo===a)return;f=f.return}for(;p!==null;){if(f=Cn(p),f===null)return;if(M=f.tag,M===5||M===6||M===26||M===27){n=u=f;continue e}p=p.parentNode}}n=n.return}Zs(function(){var I=u,j=uc(l),G=[];e:{var Y=So.get(e);if(Y!==void 0){var H=Ur,Ee=e;switch(e){case"keypress":if(Dr(l)===0)break e;case"keydown":case"keyup":H=Dy;break;case"focusin":Ee="focus",H=dc;break;case"focusout":Ee="blur",H=dc;break;case"beforeblur":case"afterblur":H=dc;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":H=Ks;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":H=gy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":H=wy;break;case go:case vo:case To:H=Ry;break;case Ro:H=Iy;break;case"scroll":case"scrollend":H=py;break;case"wheel":H=Hy;break;case"copy":case"cut":case"paste":H=Ny;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":H=Ws;break;case"toggle":case"beforetoggle":H=jy}var oe=(t&4)!==0,je=!oe&&(e==="scroll"||e==="scrollend"),x=oe?Y!==null?Y+"Capture":null:Y;oe=[];for(var _=I,w;_!==null;){var V=_;if(w=V.stateNode,V=V.tag,V!==5&&V!==26&&V!==27||w===null||x===null||(V=va(_,x),V!=null&&oe.push(tr(_,V,w))),je)break;_=_.return}0<oe.length&&(Y=new H(Y,Ee,null,l,j),G.push({event:Y,listeners:oe}))}}if((t&7)===0){e:{if(Y=e==="mouseover"||e==="pointerover",H=e==="mouseout"||e==="pointerout",Y&&l!==rc&&(Ee=l.relatedTarget||l.fromElement)&&(Cn(Ee)||Ee[bn]))break e;if((H||Y)&&(Y=j.window===j?j:(Y=j.ownerDocument)?Y.defaultView||Y.parentWindow:window,H?(Ee=l.relatedTarget||l.toElement,H=I,Ee=Ee?Cn(Ee):null,Ee!==null&&(je=h(Ee),oe=Ee.tag,Ee!==je||oe!==5&&oe!==27&&oe!==6)&&(Ee=null)):(H=null,Ee=I),H!==Ee)){if(oe=Ks,V="onMouseLeave",x="onMouseEnter",_="mouse",(e==="pointerout"||e==="pointerover")&&(oe=Ws,V="onPointerLeave",x="onPointerEnter",_="pointer"),je=H==null?Y:ga(H),w=Ee==null?Y:ga(Ee),Y=new oe(V,_+"leave",H,l,j),Y.target=je,Y.relatedTarget=w,V=null,Cn(j)===I&&(oe=new oe(x,_+"enter",Ee,l,j),oe.target=w,oe.relatedTarget=je,V=oe),je=V,H&&Ee)t:{for(oe=H,x=Ee,_=0,w=oe;w;w=ua(w))_++;for(w=0,V=x;V;V=ua(V))w++;for(;0<_-w;)oe=ua(oe),_--;for(;0<w-_;)x=ua(x),w--;for(;_--;){if(oe===x||x!==null&&oe===x.alternate)break t;oe=ua(oe),x=ua(x)}oe=null}else oe=null;H!==null&&qd(G,Y,H,oe,!1),Ee!==null&&je!==null&&qd(G,je,Ee,oe,!0)}}e:{if(Y=I?ga(I):window,H=Y.nodeName&&Y.nodeName.toLowerCase(),H==="select"||H==="input"&&Y.type==="file")var ae=uo;else if(ao(Y))if(co)ae=ky;else{ae=Zy;var Te=Fy}else H=Y.nodeName,!H||H.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?I&&ac(I.elementType)&&(ae=uo):ae=Qy;if(ae&&(ae=ae(e,I))){ro(G,ae,l,j);break e}Te&&Te(e,Y,I),e==="focusout"&&I&&Y.type==="number"&&I.memoizedProps.value!=null&&nc(Y,"number",Y.value)}switch(Te=I?ga(I):window,e){case"focusin":(ao(Te)||Te.contentEditable==="true")&&(Yn=Te,gc=I,Ma=null);break;case"focusout":Ma=gc=Yn=null;break;case"mousedown":vc=!0;break;case"contextmenu":case"mouseup":case"dragend":vc=!1,po(G,l,j);break;case"selectionchange":if(Jy)break;case"keydown":case"keyup":po(G,l,j)}var ce;if(yc)e:{switch(e){case"compositionstart":var fe="onCompositionStart";break e;case"compositionend":fe="onCompositionEnd";break e;case"compositionupdate":fe="onCompositionUpdate";break e}fe=void 0}else In?lo(e,l)&&(fe="onCompositionEnd"):e==="keydown"&&l.keyCode===229&&(fe="onCompositionStart");fe&&(Ps&&l.locale!=="ko"&&(In||fe!=="onCompositionStart"?fe==="onCompositionEnd"&&In&&(ce=Qs()):(_l=j,sc="value"in _l?_l.value:_l.textContent,In=!0)),Te=vu(I,fe),0<Te.length&&(fe=new Js(fe,e,null,l,j),G.push({event:fe,listeners:Te}),ce?fe.data=ce:(ce=no(l),ce!==null&&(fe.data=ce)))),(ce=Gy?$y(e,l):qy(e,l))&&(fe=vu(I,"onBeforeInput"),0<fe.length&&(Te=new Js("onBeforeInput","beforeinput",null,l,j),G.push({event:Te,listeners:fe}),Te.data=ce)),wm(G,e,I,l,j)}Gd(G,t)})}function tr(e,t,l){return{instance:e,listener:t,currentTarget:l}}function vu(e,t){for(var l=t+"Capture",n=[];e!==null;){var a=e,u=a.stateNode;if(a=a.tag,a!==5&&a!==26&&a!==27||u===null||(a=va(e,l),a!=null&&n.unshift(tr(e,a,u)),a=va(e,t),a!=null&&n.push(tr(e,a,u))),e.tag===3)return n;e=e.return}return[]}function ua(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function qd(e,t,l,n,a){for(var u=t._reactName,f=[];l!==null&&l!==n;){var p=l,M=p.alternate,I=p.stateNode;if(p=p.tag,M!==null&&M===n)break;p!==5&&p!==26&&p!==27||I===null||(M=I,a?(I=va(l,u),I!=null&&f.unshift(tr(l,I,M))):a||(I=va(l,u),I!=null&&f.push(tr(l,I,M)))),l=l.return}f.length!==0&&e.push({event:t,listeners:f})}var Hm=/\r\n?/g,zm=/\u0000|\uFFFD/g;function Xd(e){return(typeof e=="string"?e:""+e).replace(Hm,`
`).replace(zm,"")}function Bd(e,t){return t=Xd(t),Xd(e)===t}function Tu(){}function ze(e,t,l,n,a,u){switch(l){case"children":typeof n=="string"?t==="body"||t==="textarea"&&n===""||Un(e,n):(typeof n=="number"||typeof n=="bigint")&&t!=="body"&&Un(e,""+n);break;case"className":br(e,"class",n);break;case"tabIndex":br(e,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":br(e,l,n);break;case"style":Bs(e,n,u);break;case"data":if(t!=="object"){br(e,"data",n);break}case"src":case"href":if(n===""&&(t!=="a"||l!=="href")){e.removeAttribute(l);break}if(n==null||typeof n=="function"||typeof n=="symbol"||typeof n=="boolean"){e.removeAttribute(l);break}n=Or(""+n),e.setAttribute(l,n);break;case"action":case"formAction":if(typeof n=="function"){e.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof u=="function"&&(l==="formAction"?(t!=="input"&&ze(e,t,"name",a.name,a,null),ze(e,t,"formEncType",a.formEncType,a,null),ze(e,t,"formMethod",a.formMethod,a,null),ze(e,t,"formTarget",a.formTarget,a,null)):(ze(e,t,"encType",a.encType,a,null),ze(e,t,"method",a.method,a,null),ze(e,t,"target",a.target,a,null)));if(n==null||typeof n=="symbol"||typeof n=="boolean"){e.removeAttribute(l);break}n=Or(""+n),e.setAttribute(l,n);break;case"onClick":n!=null&&(e.onclick=Tu);break;case"onScroll":n!=null&&Ae("scroll",e);break;case"onScrollEnd":n!=null&&Ae("scrollend",e);break;case"dangerouslySetInnerHTML":if(n!=null){if(typeof n!="object"||!("__html"in n))throw Error(i(61));if(l=n.__html,l!=null){if(a.children!=null)throw Error(i(60));e.innerHTML=l}}break;case"multiple":e.multiple=n&&typeof n!="function"&&typeof n!="symbol";break;case"muted":e.muted=n&&typeof n!="function"&&typeof n!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(n==null||typeof n=="function"||typeof n=="boolean"||typeof n=="symbol"){e.removeAttribute("xlink:href");break}l=Or(""+n),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":n!=null&&typeof n!="function"&&typeof n!="symbol"?e.setAttribute(l,""+n):e.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&typeof n!="function"&&typeof n!="symbol"?e.setAttribute(l,""):e.removeAttribute(l);break;case"capture":case"download":n===!0?e.setAttribute(l,""):n!==!1&&n!=null&&typeof n!="function"&&typeof n!="symbol"?e.setAttribute(l,n):e.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":n!=null&&typeof n!="function"&&typeof n!="symbol"&&!isNaN(n)&&1<=n?e.setAttribute(l,n):e.removeAttribute(l);break;case"rowSpan":case"start":n==null||typeof n=="function"||typeof n=="symbol"||isNaN(n)?e.removeAttribute(l):e.setAttribute(l,n);break;case"popover":Ae("beforetoggle",e),Ae("toggle",e),Ar(e,"popover",n);break;case"xlinkActuate":fl(e,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":fl(e,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":fl(e,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":fl(e,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":fl(e,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":fl(e,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":fl(e,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":fl(e,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":fl(e,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":Ar(e,"is",n);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=yy.get(l)||l,Ar(e,l,n))}}function $i(e,t,l,n,a,u){switch(l){case"style":Bs(e,n,u);break;case"dangerouslySetInnerHTML":if(n!=null){if(typeof n!="object"||!("__html"in n))throw Error(i(61));if(l=n.__html,l!=null){if(a.children!=null)throw Error(i(60));e.innerHTML=l}}break;case"children":typeof n=="string"?Un(e,n):(typeof n=="number"||typeof n=="bigint")&&Un(e,""+n);break;case"onScroll":n!=null&&Ae("scroll",e);break;case"onScrollEnd":n!=null&&Ae("scrollend",e);break;case"onClick":n!=null&&(e.onclick=Tu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ls.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(a=l.endsWith("Capture"),t=l.slice(2,a?l.length-7:void 0),u=e[Nt]||null,u=u!=null?u[l]:null,typeof u=="function"&&e.removeEventListener(t,u,a),typeof n=="function")){typeof u!="function"&&u!==null&&(l in e?e[l]=null:e.hasAttribute(l)&&e.removeAttribute(l)),e.addEventListener(t,n,a);break e}l in e?e[l]=n:n===!0?e.setAttribute(l,""):Ar(e,l,n)}}}function yt(e,t,l){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ae("error",e),Ae("load",e);var n=!1,a=!1,u;for(u in l)if(l.hasOwnProperty(u)){var f=l[u];if(f!=null)switch(u){case"src":n=!0;break;case"srcSet":a=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:ze(e,t,u,f,l,null)}}a&&ze(e,t,"srcSet",l.srcSet,l,null),n&&ze(e,t,"src",l.src,l,null);return;case"input":Ae("invalid",e);var p=u=f=a=null,M=null,I=null;for(n in l)if(l.hasOwnProperty(n)){var j=l[n];if(j!=null)switch(n){case"name":a=j;break;case"type":f=j;break;case"checked":M=j;break;case"defaultChecked":I=j;break;case"value":u=j;break;case"defaultValue":p=j;break;case"children":case"dangerouslySetInnerHTML":if(j!=null)throw Error(i(137,t));break;default:ze(e,t,n,j,l,null)}}Gs(e,u,p,M,I,f,a,!1),Cr(e);return;case"select":Ae("invalid",e),n=f=u=null;for(a in l)if(l.hasOwnProperty(a)&&(p=l[a],p!=null))switch(a){case"value":u=p;break;case"defaultValue":f=p;break;case"multiple":n=p;default:ze(e,t,a,p,l,null)}t=u,l=f,e.multiple=!!n,t!=null?xn(e,!!n,t,!1):l!=null&&xn(e,!!n,l,!0);return;case"textarea":Ae("invalid",e),u=a=n=null;for(f in l)if(l.hasOwnProperty(f)&&(p=l[f],p!=null))switch(f){case"value":n=p;break;case"defaultValue":a=p;break;case"children":u=p;break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:ze(e,t,f,p,l,null)}qs(e,n,a,u),Cr(e);return;case"option":for(M in l)if(l.hasOwnProperty(M)&&(n=l[M],n!=null))switch(M){case"selected":e.selected=n&&typeof n!="function"&&typeof n!="symbol";break;default:ze(e,t,M,n,l,null)}return;case"dialog":Ae("beforetoggle",e),Ae("toggle",e),Ae("cancel",e),Ae("close",e);break;case"iframe":case"object":Ae("load",e);break;case"video":case"audio":for(n=0;n<er.length;n++)Ae(er[n],e);break;case"image":Ae("error",e),Ae("load",e);break;case"details":Ae("toggle",e);break;case"embed":case"source":case"link":Ae("error",e),Ae("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(I in l)if(l.hasOwnProperty(I)&&(n=l[I],n!=null))switch(I){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:ze(e,t,I,n,l,null)}return;default:if(ac(t)){for(j in l)l.hasOwnProperty(j)&&(n=l[j],n!==void 0&&$i(e,t,j,n,l,void 0));return}}for(p in l)l.hasOwnProperty(p)&&(n=l[p],n!=null&&ze(e,t,p,n,l,null))}function jm(e,t,l,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,u=null,f=null,p=null,M=null,I=null,j=null;for(H in l){var G=l[H];if(l.hasOwnProperty(H)&&G!=null)switch(H){case"checked":break;case"value":break;case"defaultValue":M=G;default:n.hasOwnProperty(H)||ze(e,t,H,null,n,G)}}for(var Y in n){var H=n[Y];if(G=l[Y],n.hasOwnProperty(Y)&&(H!=null||G!=null))switch(Y){case"type":u=H;break;case"name":a=H;break;case"checked":I=H;break;case"defaultChecked":j=H;break;case"value":f=H;break;case"defaultValue":p=H;break;case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(i(137,t));break;default:H!==G&&ze(e,t,Y,H,n,G)}}lc(e,f,p,M,I,j,u,a);return;case"select":H=f=p=Y=null;for(u in l)if(M=l[u],l.hasOwnProperty(u)&&M!=null)switch(u){case"value":break;case"multiple":H=M;default:n.hasOwnProperty(u)||ze(e,t,u,null,n,M)}for(a in n)if(u=n[a],M=l[a],n.hasOwnProperty(a)&&(u!=null||M!=null))switch(a){case"value":Y=u;break;case"defaultValue":p=u;break;case"multiple":f=u;default:u!==M&&ze(e,t,a,u,n,M)}t=p,l=f,n=H,Y!=null?xn(e,!!l,Y,!1):!!n!=!!l&&(t!=null?xn(e,!!l,t,!0):xn(e,!!l,l?[]:"",!1));return;case"textarea":H=Y=null;for(p in l)if(a=l[p],l.hasOwnProperty(p)&&a!=null&&!n.hasOwnProperty(p))switch(p){case"value":break;case"children":break;default:ze(e,t,p,null,n,a)}for(f in n)if(a=n[f],u=l[f],n.hasOwnProperty(f)&&(a!=null||u!=null))switch(f){case"value":Y=a;break;case"defaultValue":H=a;break;case"children":break;case"dangerouslySetInnerHTML":if(a!=null)throw Error(i(91));break;default:a!==u&&ze(e,t,f,a,n,u)}$s(e,Y,H);return;case"option":for(var Ee in l)if(Y=l[Ee],l.hasOwnProperty(Ee)&&Y!=null&&!n.hasOwnProperty(Ee))switch(Ee){case"selected":e.selected=!1;break;default:ze(e,t,Ee,null,n,Y)}for(M in n)if(Y=n[M],H=l[M],n.hasOwnProperty(M)&&Y!==H&&(Y!=null||H!=null))switch(M){case"selected":e.selected=Y&&typeof Y!="function"&&typeof Y!="symbol";break;default:ze(e,t,M,Y,n,H)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var oe in l)Y=l[oe],l.hasOwnProperty(oe)&&Y!=null&&!n.hasOwnProperty(oe)&&ze(e,t,oe,null,n,Y);for(I in n)if(Y=n[I],H=l[I],n.hasOwnProperty(I)&&Y!==H&&(Y!=null||H!=null))switch(I){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(i(137,t));break;default:ze(e,t,I,Y,n,H)}return;default:if(ac(t)){for(var je in l)Y=l[je],l.hasOwnProperty(je)&&Y!==void 0&&!n.hasOwnProperty(je)&&$i(e,t,je,void 0,n,Y);for(j in n)Y=n[j],H=l[j],!n.hasOwnProperty(j)||Y===H||Y===void 0&&H===void 0||$i(e,t,j,Y,n,H);return}}for(var x in l)Y=l[x],l.hasOwnProperty(x)&&Y!=null&&!n.hasOwnProperty(x)&&ze(e,t,x,null,n,Y);for(G in n)Y=n[G],H=l[G],!n.hasOwnProperty(G)||Y===H||Y==null&&H==null||ze(e,t,G,Y,n,H)}var qi=null,Xi=null;function Ru(e){return e.nodeType===9?e:e.ownerDocument}function Fd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Zd(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Bi(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Fi=null;function Vm(){var e=window.event;return e&&e.type==="popstate"?e===Fi?!1:(Fi=e,!0):(Fi=null,!1)}var Qd=typeof setTimeout=="function"?setTimeout:void 0,Gm=typeof clearTimeout=="function"?clearTimeout:void 0,kd=typeof Promise=="function"?Promise:void 0,$m=typeof queueMicrotask=="function"?queueMicrotask:typeof kd<"u"?function(e){return kd.resolve(null).then(e).catch(qm)}:Qd;function qm(e){setTimeout(function(){throw e})}function Bl(e){return e==="head"}function Kd(e,t){var l=t,n=0,a=0;do{var u=l.nextSibling;if(e.removeChild(l),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(0<n&&8>n){l=n;var f=e.ownerDocument;if(l&1&&lr(f.documentElement),l&2&&lr(f.body),l&4)for(l=f.head,lr(l),f=l.firstChild;f;){var p=f.nextSibling,M=f.nodeName;f[ha]||M==="SCRIPT"||M==="STYLE"||M==="LINK"&&f.rel.toLowerCase()==="stylesheet"||l.removeChild(f),f=p}}if(a===0){e.removeChild(u),or(t);return}a--}else l==="$"||l==="$?"||l==="$!"?a++:n=l.charCodeAt(0)-48;else n=0;l=u}while(l);or(t)}function Zi(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var l=t;switch(t=t.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Zi(l),Wu(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}e.removeChild(l)}}function Xm(e,t,l,n){for(;e.nodeType===1;){var a=l;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!n&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(n){if(!e[ha])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(u=e.getAttribute("rel"),u==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(u!==a.rel||e.getAttribute("href")!==(a.href==null||a.href===""?null:a.href)||e.getAttribute("crossorigin")!==(a.crossOrigin==null?null:a.crossOrigin)||e.getAttribute("title")!==(a.title==null?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(u=e.getAttribute("src"),(u!==(a.src==null?null:a.src)||e.getAttribute("type")!==(a.type==null?null:a.type)||e.getAttribute("crossorigin")!==(a.crossOrigin==null?null:a.crossOrigin))&&u&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var u=a.name==null?null:""+a.name;if(a.type==="hidden"&&e.getAttribute("name")===u)return e}else return e;if(e=Wt(e.nextSibling),e===null)break}return null}function Bm(e,t,l){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!l||(e=Wt(e.nextSibling),e===null))return null;return e}function Qi(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function Fm(e,t){var l=e.ownerDocument;if(e.data!=="$?"||l.readyState==="complete")t();else{var n=function(){t(),l.removeEventListener("DOMContentLoaded",n)};l.addEventListener("DOMContentLoaded",n),e._reactRetry=n}}function Wt(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var ki=null;function Jd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var l=e.data;if(l==="$"||l==="$!"||l==="$?"){if(t===0)return e;t--}else l==="/$"&&t++}e=e.previousSibling}return null}function Wd(e,t,l){switch(t=Ru(l),e){case"html":if(e=t.documentElement,!e)throw Error(i(452));return e;case"head":if(e=t.head,!e)throw Error(i(453));return e;case"body":if(e=t.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function lr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Wu(e)}var Ft=new Map,Pd=new Set;function Su(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var bl=S.d;S.d={f:Zm,r:Qm,D:km,C:Km,L:Jm,m:Wm,X:e0,S:Pm,M:t0};function Zm(){var e=bl.f(),t=Eu();return e||t}function Qm(e){var t=Mn(e);t!==null&&t.tag===5&&t.type==="form"?vf(t):bl.r(e)}var ca=typeof document>"u"?null:document;function eE(e,t,l){var n=ca;if(n&&typeof t=="string"&&t){var a=jt(t);a='link[rel="'+e+'"][href="'+a+'"]',typeof l=="string"&&(a+='[crossorigin="'+l+'"]'),Pd.has(a)||(Pd.add(a),e={rel:e,crossOrigin:l,href:t},n.querySelector(a)===null&&(t=n.createElement("link"),yt(t,"link",e),ut(t),n.head.appendChild(t)))}}function km(e){bl.D(e),eE("dns-prefetch",e,null)}function Km(e,t){bl.C(e,t),eE("preconnect",e,t)}function Jm(e,t,l){bl.L(e,t,l);var n=ca;if(n&&e&&t){var a='link[rel="preload"][as="'+jt(t)+'"]';t==="image"&&l&&l.imageSrcSet?(a+='[imagesrcset="'+jt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(a+='[imagesizes="'+jt(l.imageSizes)+'"]')):a+='[href="'+jt(e)+'"]';var u=a;switch(t){case"style":u=ia(e);break;case"script":u=sa(e)}Ft.has(u)||(e=D({rel:"preload",href:t==="image"&&l&&l.imageSrcSet?void 0:e,as:t},l),Ft.set(u,e),n.querySelector(a)!==null||t==="style"&&n.querySelector(nr(u))||t==="script"&&n.querySelector(ar(u))||(t=n.createElement("link"),yt(t,"link",e),ut(t),n.head.appendChild(t)))}}function Wm(e,t){bl.m(e,t);var l=ca;if(l&&e){var n=t&&typeof t.as=="string"?t.as:"script",a='link[rel="modulepreload"][as="'+jt(n)+'"][href="'+jt(e)+'"]',u=a;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":u=sa(e)}if(!Ft.has(u)&&(e=D({rel:"modulepreload",href:e},t),Ft.set(u,e),l.querySelector(a)===null)){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(ar(u)))return}n=l.createElement("link"),yt(n,"link",e),ut(n),l.head.appendChild(n)}}}function Pm(e,t,l){bl.S(e,t,l);var n=ca;if(n&&e){var a=On(n).hoistableStyles,u=ia(e);t=t||"default";var f=a.get(u);if(!f){var p={loading:0,preload:null};if(f=n.querySelector(nr(u)))p.loading=5;else{e=D({rel:"stylesheet",href:e,"data-precedence":t},l),(l=Ft.get(u))&&Ki(e,l);var M=f=n.createElement("link");ut(M),yt(M,"link",e),M._p=new Promise(function(I,j){M.onload=I,M.onerror=j}),M.addEventListener("load",function(){p.loading|=1}),M.addEventListener("error",function(){p.loading|=2}),p.loading|=4,Nu(f,t,n)}f={type:"stylesheet",instance:f,count:1,state:p},a.set(u,f)}}}function e0(e,t){bl.X(e,t);var l=ca;if(l&&e){var n=On(l).hoistableScripts,a=sa(e),u=n.get(a);u||(u=l.querySelector(ar(a)),u||(e=D({src:e,async:!0},t),(t=Ft.get(a))&&Ji(e,t),u=l.createElement("script"),ut(u),yt(u,"link",e),l.head.appendChild(u)),u={type:"script",instance:u,count:1,state:null},n.set(a,u))}}function t0(e,t){bl.M(e,t);var l=ca;if(l&&e){var n=On(l).hoistableScripts,a=sa(e),u=n.get(a);u||(u=l.querySelector(ar(a)),u||(e=D({src:e,async:!0,type:"module"},t),(t=Ft.get(a))&&Ji(e,t),u=l.createElement("script"),ut(u),yt(u,"link",e),l.head.appendChild(u)),u={type:"script",instance:u,count:1,state:null},n.set(a,u))}}function tE(e,t,l,n){var a=(a=W.current)?Su(a):null;if(!a)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(t=ia(l.href),l=On(a).hoistableStyles,n=l.get(t),n||(n={type:"style",instance:null,count:0,state:null},l.set(t,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){e=ia(l.href);var u=On(a).hoistableStyles,f=u.get(e);if(f||(a=a.ownerDocument||a,f={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,f),(u=a.querySelector(nr(e)))&&!u._p&&(f.instance=u,f.state.loading=5),Ft.has(e)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Ft.set(e,l),u||l0(a,e,l,f.state))),t&&n===null)throw Error(i(528,""));return f}if(t&&n!==null)throw Error(i(529,""));return null;case"script":return t=l.async,l=l.src,typeof l=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=sa(l),l=On(a).hoistableScripts,n=l.get(t),n||(n={type:"script",instance:null,count:0,state:null},l.set(t,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function ia(e){return'href="'+jt(e)+'"'}function nr(e){return'link[rel="stylesheet"]['+e+"]"}function lE(e){return D({},e,{"data-precedence":e.precedence,precedence:null})}function l0(e,t,l,n){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?n.loading=1:(t=e.createElement("link"),n.preload=t,t.addEventListener("load",function(){return n.loading|=1}),t.addEventListener("error",function(){return n.loading|=2}),yt(t,"link",l),ut(t),e.head.appendChild(t))}function sa(e){return'[src="'+jt(e)+'"]'}function ar(e){return"script[async]"+e}function nE(e,t,l){if(t.count++,t.instance===null)switch(t.type){case"style":var n=e.querySelector('style[data-href~="'+jt(l.href)+'"]');if(n)return t.instance=n,ut(n),n;var a=D({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return n=(e.ownerDocument||e).createElement("style"),ut(n),yt(n,"style",a),Nu(n,l.precedence,e),t.instance=n;case"stylesheet":a=ia(l.href);var u=e.querySelector(nr(a));if(u)return t.state.loading|=4,t.instance=u,ut(u),u;n=lE(l),(a=Ft.get(a))&&Ki(n,a),u=(e.ownerDocument||e).createElement("link"),ut(u);var f=u;return f._p=new Promise(function(p,M){f.onload=p,f.onerror=M}),yt(u,"link",n),t.state.loading|=4,Nu(u,l.precedence,e),t.instance=u;case"script":return u=sa(l.src),(a=e.querySelector(ar(u)))?(t.instance=a,ut(a),a):(n=l,(a=Ft.get(u))&&(n=D({},l),Ji(n,a)),e=e.ownerDocument||e,a=e.createElement("script"),ut(a),yt(a,"link",n),e.head.appendChild(a),t.instance=a);case"void":return null;default:throw Error(i(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(n=t.instance,t.state.loading|=4,Nu(n,l.precedence,e));return t.instance}function Nu(e,t,l){for(var n=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=n.length?n[n.length-1]:null,u=a,f=0;f<n.length;f++){var p=n[f];if(p.dataset.precedence===t)u=p;else if(u!==a)break}u?u.parentNode.insertBefore(e,u.nextSibling):(t=l.nodeType===9?l.head:l,t.insertBefore(e,t.firstChild))}function Ki(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Ji(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Au=null;function aE(e,t,l){if(Au===null){var n=new Map,a=Au=new Map;a.set(l,n)}else a=Au,n=a.get(l),n||(n=new Map,a.set(l,n));if(n.has(e))return n;for(n.set(e,null),l=l.getElementsByTagName(e),a=0;a<l.length;a++){var u=l[a];if(!(u[ha]||u[ht]||e==="link"&&u.getAttribute("rel")==="stylesheet")&&u.namespaceURI!=="http://www.w3.org/2000/svg"){var f=u.getAttribute(t)||"";f=e+f;var p=n.get(f);p?p.push(u):n.set(f,[u])}}return n}function rE(e,t,l){e=e.ownerDocument||e,e.head.insertBefore(l,t==="title"?e.querySelector("head > title"):null)}function n0(e,t,l){if(l===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function uE(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var rr=null;function a0(){}function r0(e,t,l){if(rr===null)throw Error(i(475));var n=rr;if(t.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(t.state.loading&4)===0){if(t.instance===null){var a=ia(l.href),u=e.querySelector(nr(a));if(u){e=u._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(n.count++,n=bu.bind(n),e.then(n,n)),t.state.loading|=4,t.instance=u,ut(u);return}u=e.ownerDocument||e,l=lE(l),(a=Ft.get(a))&&Ki(l,a),u=u.createElement("link"),ut(u);var f=u;f._p=new Promise(function(p,M){f.onload=p,f.onerror=M}),yt(u,"link",l),t.instance=u}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(t,e),(e=t.state.preload)&&(t.state.loading&3)===0&&(n.count++,t=bu.bind(n),e.addEventListener("load",t),e.addEventListener("error",t))}}function u0(){if(rr===null)throw Error(i(475));var e=rr;return e.stylesheets&&e.count===0&&Wi(e,e.stylesheets),0<e.count?function(t){var l=setTimeout(function(){if(e.stylesheets&&Wi(e,e.stylesheets),e.unsuspend){var n=e.unsuspend;e.unsuspend=null,n()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(l)}}:null}function bu(){if(this.count--,this.count===0){if(this.stylesheets)Wi(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Cu=null;function Wi(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Cu=new Map,t.forEach(c0,e),Cu=null,bu.call(e))}function c0(e,t){if(!(t.state.loading&4)){var l=Cu.get(e);if(l)var n=l.get(null);else{l=new Map,Cu.set(e,l);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),u=0;u<a.length;u++){var f=a[u];(f.nodeName==="LINK"||f.getAttribute("media")!=="not all")&&(l.set(f.dataset.precedence,f),n=f)}n&&l.set(null,n)}a=t.instance,f=a.getAttribute("data-precedence"),u=l.get(f)||n,u===n&&l.set(null,a),l.set(f,a),this.count++,n=bu.bind(this),a.addEventListener("load",n),a.addEventListener("error",n),u?u.parentNode.insertBefore(a,u.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(a,e.firstChild)),t.state.loading|=4}}var ur={$$typeof:X,Provider:null,Consumer:null,_currentValue:v,_currentValue2:v,_threadCount:0};function i0(e,t,l,n,a,u,f,p){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Qu(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qu(0),this.hiddenUpdates=Qu(null),this.identifierPrefix=n,this.onUncaughtError=a,this.onCaughtError=u,this.onRecoverableError=f,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=p,this.incompleteTransitions=new Map}function cE(e,t,l,n,a,u,f,p,M,I,j,G){return e=new i0(e,t,l,f,p,M,I,G),t=1,u===!0&&(t|=24),u=xt(3,null,null,t),e.current=u,u.stateNode=e,t=wc(),t.refCount++,e.pooledCache=t,t.refCount++,u.memoizedState={element:n,isDehydrated:l,cache:t},Hc(u),e}function iE(e){return e?(e=Vn,e):Vn}function sE(e,t,l,n,a,u){a=iE(a),n.context===null?n.context=a:n.pendingContext=a,n=Ul(t),n.payload={element:l},u=u===void 0?null:u,u!==null&&(n.callback=u),l=wl(e,n,t),l!==null&&(Yt(l,e,t),Ya(l,e,t))}function oE(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var l=e.retryLane;e.retryLane=l!==0&&l<t?l:t}}function Pi(e,t){oE(e,t),(e=e.alternate)&&oE(e,t)}function fE(e){if(e.tag===13){var t=jn(e,67108864);t!==null&&Yt(t,e,67108864),Pi(e,67108864)}}var Mu=!0;function s0(e,t,l,n){var a=A.T;A.T=null;var u=S.p;try{S.p=2,es(e,t,l,n)}finally{S.p=u,A.T=a}}function o0(e,t,l,n){var a=A.T;A.T=null;var u=S.p;try{S.p=8,es(e,t,l,n)}finally{S.p=u,A.T=a}}function es(e,t,l,n){if(Mu){var a=ts(n);if(a===null)Gi(e,t,n,Ou,l),EE(e,n);else if(d0(a,e,t,l,n))n.stopPropagation();else if(EE(e,n),t&4&&-1<f0.indexOf(e)){for(;a!==null;){var u=Mn(a);if(u!==null)switch(u.tag){case 3:if(u=u.stateNode,u.current.memoizedState.isDehydrated){var f=ln(u.pendingLanes);if(f!==0){var p=u;for(p.pendingLanes|=2,p.entangledLanes|=2;f;){var M=1<<31-ft(f);p.entanglements[1]|=M,f&=~M}nl(u),(Ie&6)===0&&(fu=Oe()+500,Pa(0))}}break;case 13:p=jn(u,2),p!==null&&Yt(p,u,2),Eu(),Pi(u,2)}if(u=ts(n),u===null&&Gi(e,t,n,Ou,l),u===a)break;a=u}a!==null&&n.stopPropagation()}else Gi(e,t,n,null,l)}}function ts(e){return e=uc(e),ls(e)}var Ou=null;function ls(e){if(Ou=null,e=Cn(e),e!==null){var t=h(e);if(t===null)e=null;else{var l=t.tag;if(l===13){if(e=E(t),e!==null)return e;e=null}else if(l===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Ou=e,null}function dE(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(We()){case Xe:return 2;case Ht:return 8;case pt:case Ml:return 32;case Ze:return 268435456;default:return 32}default:return 32}}var ns=!1,Fl=null,Zl=null,Ql=null,cr=new Map,ir=new Map,kl=[],f0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function EE(e,t){switch(e){case"focusin":case"focusout":Fl=null;break;case"dragenter":case"dragleave":Zl=null;break;case"mouseover":case"mouseout":Ql=null;break;case"pointerover":case"pointerout":cr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ir.delete(t.pointerId)}}function sr(e,t,l,n,a,u){return e===null||e.nativeEvent!==u?(e={blockedOn:t,domEventName:l,eventSystemFlags:n,nativeEvent:u,targetContainers:[a]},t!==null&&(t=Mn(t),t!==null&&fE(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function d0(e,t,l,n,a){switch(t){case"focusin":return Fl=sr(Fl,e,t,l,n,a),!0;case"dragenter":return Zl=sr(Zl,e,t,l,n,a),!0;case"mouseover":return Ql=sr(Ql,e,t,l,n,a),!0;case"pointerover":var u=a.pointerId;return cr.set(u,sr(cr.get(u)||null,e,t,l,n,a)),!0;case"gotpointercapture":return u=a.pointerId,ir.set(u,sr(ir.get(u)||null,e,t,l,n,a)),!0}return!1}function yE(e){var t=Cn(e.target);if(t!==null){var l=h(t);if(l!==null){if(t=l.tag,t===13){if(t=E(l),t!==null){e.blockedOn=t,ry(e.priority,function(){if(l.tag===13){var n=It();n=ku(n);var a=jn(l,n);a!==null&&Yt(a,l,n),Pi(l,n)}});return}}else if(t===3&&l.stateNode.current.memoizedState.isDehydrated){e.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _u(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var l=ts(e.nativeEvent);if(l===null){l=e.nativeEvent;var n=new l.constructor(l.type,l);rc=n,l.target.dispatchEvent(n),rc=null}else return t=Mn(l),t!==null&&fE(t),e.blockedOn=l,!1;t.shift()}return!0}function mE(e,t,l){_u(e)&&l.delete(t)}function E0(){ns=!1,Fl!==null&&_u(Fl)&&(Fl=null),Zl!==null&&_u(Zl)&&(Zl=null),Ql!==null&&_u(Ql)&&(Ql=null),cr.forEach(mE),ir.forEach(mE)}function Du(e,t){e.blockedOn===t&&(e.blockedOn=null,ns||(ns=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,E0)))}var xu=null;function pE(e){xu!==e&&(xu=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){xu===e&&(xu=null);for(var t=0;t<e.length;t+=3){var l=e[t],n=e[t+1],a=e[t+2];if(typeof n!="function"){if(ls(n||l)===null)continue;break}var u=Mn(l);u!==null&&(e.splice(t,3),t-=3,li(u,{pending:!0,data:a,method:l.method,action:n},n,a))}}))}function or(e){function t(M){return Du(M,e)}Fl!==null&&Du(Fl,e),Zl!==null&&Du(Zl,e),Ql!==null&&Du(Ql,e),cr.forEach(t),ir.forEach(t);for(var l=0;l<kl.length;l++){var n=kl[l];n.blockedOn===e&&(n.blockedOn=null)}for(;0<kl.length&&(l=kl[0],l.blockedOn===null);)yE(l),l.blockedOn===null&&kl.shift();if(l=(e.ownerDocument||e).$$reactFormReplay,l!=null)for(n=0;n<l.length;n+=3){var a=l[n],u=l[n+1],f=a[Nt]||null;if(typeof u=="function")f||pE(l);else if(f){var p=null;if(u&&u.hasAttribute("formAction")){if(a=u,f=u[Nt]||null)p=f.formAction;else if(ls(a)!==null)continue}else p=f.action;typeof p=="function"?l[n+1]=p:(l.splice(n,3),n-=3),pE(l)}}}function as(e){this._internalRoot=e}Uu.prototype.render=as.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(i(409));var l=t.current,n=It();sE(l,n,e,t,null,null)},Uu.prototype.unmount=as.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;sE(e.current,2,null,e,null,null),Eu(),t[bn]=null}};function Uu(e){this._internalRoot=e}Uu.prototype.unstable_scheduleHydration=function(e){if(e){var t=xs();e={blockedOn:null,target:e,priority:t};for(var l=0;l<kl.length&&t!==0&&t<kl[l].priority;l++);kl.splice(l,0,e),l===0&&yE(e)}};var hE=s.version;if(hE!=="19.1.0")throw Error(i(527,hE,"19.1.0"));S.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=m(t),e=e!==null?T(e):null,e=e===null?null:e.stateNode,e};var y0={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:A,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wu.isDisabled&&wu.supportsFiber)try{tn=wu.inject(y0),ot=wu}catch{}}return dr.createRoot=function(e,t){if(!y(e))throw Error(i(299));var l=!1,n="",a=wf,u=Lf,f=If,p=null;return t!=null&&(t.unstable_strictMode===!0&&(l=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onUncaughtError!==void 0&&(a=t.onUncaughtError),t.onCaughtError!==void 0&&(u=t.onCaughtError),t.onRecoverableError!==void 0&&(f=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(p=t.unstable_transitionCallbacks)),t=cE(e,1,!1,null,null,l,n,a,u,f,p,null),e[bn]=t.current,Vi(e),new as(t)},dr.hydrateRoot=function(e,t,l){if(!y(e))throw Error(i(299));var n=!1,a="",u=wf,f=Lf,p=If,M=null,I=null;return l!=null&&(l.unstable_strictMode===!0&&(n=!0),l.identifierPrefix!==void 0&&(a=l.identifierPrefix),l.onUncaughtError!==void 0&&(u=l.onUncaughtError),l.onCaughtError!==void 0&&(f=l.onCaughtError),l.onRecoverableError!==void 0&&(p=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(M=l.unstable_transitionCallbacks),l.formState!==void 0&&(I=l.formState)),t=cE(e,1,!0,t,l??null,n,a,u,f,p,M,I),t.context=iE(null),l=t.current,n=It(),n=ku(n),a=Ul(n),a.callback=null,wl(l,a,n),l=n,t.current.lanes=l,pa(t,l),nl(t),e[bn]=t.current,Vi(e),new Uu(t)},dr.version="19.1.0",dr}var ME;function A0(){if(ME)return cs.exports;ME=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(s){console.error(s)}}return r(),cs.exports=N0(),cs.exports}var b0=A0();const C0=jE(b0),Zt={TYPE_MISMATCH:"#TYPE!",DIVISION_BY_ZERO:"#DIV/0!",CALCULATION_ERROR:"#ERROR!",UNKNOWN_ERROR:"#ERROR!"},o={NUMBER:"number",TEXT:"text",DATE:"date",DATETIME:"datetime",ERROR:"error",BOOLEAN:"boolean"},Lu={"+":{[o.NUMBER]:{[o.NUMBER]:{resultType:o.NUMBER},[o.DATE]:{resultType:o.DATE,constraints:"integer-only",validate:(r,s)=>ju(r),error:"Cannot add fractional number to DATE type. Use DATETIME instead."},[o.DATETIME]:{resultType:o.DATETIME,validate:()=>!0}},[o.DATE]:{[o.NUMBER]:{resultType:o.DATE,constraints:"integer-only",validate:(r,s)=>ju(s),error:"Cannot add fractional number to DATE type. Use DATETIME instead."}},[o.DATETIME]:{[o.NUMBER]:{resultType:o.DATETIME,validate:()=>!0}}},"-":{[o.NUMBER]:{[o.NUMBER]:{resultType:o.NUMBER}},[o.DATE]:{[o.NUMBER]:{resultType:o.DATE,constraints:"integer-only",validate:(r,s)=>ju(s),error:"Cannot subtract fractional number from DATE type. Use DATETIME instead."},[o.DATE]:{resultType:o.NUMBER,validate:()=>!0}},[o.DATETIME]:{[o.NUMBER]:{resultType:o.DATETIME,validate:()=>!0},[o.DATETIME]:{resultType:o.NUMBER,validate:()=>!0}}},"*":{[o.NUMBER]:{[o.NUMBER]:{resultType:o.NUMBER}}},"/":{[o.NUMBER]:{[o.NUMBER]:{resultType:o.NUMBER,validate:(r,s)=>s!==0,error:"#DIV/0!"}}},"^":{[o.NUMBER]:{[o.NUMBER]:{resultType:o.NUMBER}}},"=":{[o.NUMBER]:{[o.NUMBER]:{resultType:o.NUMBER}},[o.TEXT]:{[o.TEXT]:{resultType:o.NUMBER}},[o.DATE]:{[o.DATE]:{resultType:o.NUMBER}},[o.DATETIME]:{[o.DATETIME]:{resultType:o.NUMBER}}},"<>":{[o.NUMBER]:{[o.NUMBER]:{resultType:o.NUMBER}},[o.TEXT]:{[o.TEXT]:{resultType:o.NUMBER}},[o.DATE]:{[o.DATE]:{resultType:o.NUMBER}},[o.DATETIME]:{[o.DATETIME]:{resultType:o.NUMBER}}},">":{[o.NUMBER]:{[o.NUMBER]:{resultType:o.NUMBER}},[o.DATE]:{[o.DATE]:{resultType:o.NUMBER}},[o.DATETIME]:{[o.DATETIME]:{resultType:o.NUMBER}}},"<":{[o.NUMBER]:{[o.NUMBER]:{resultType:o.NUMBER}},[o.DATE]:{[o.DATE]:{resultType:o.NUMBER}},[o.DATETIME]:{[o.DATETIME]:{resultType:o.NUMBER}}},">=":{[o.NUMBER]:{[o.NUMBER]:{resultType:o.NUMBER}},[o.DATE]:{[o.DATE]:{resultType:o.NUMBER}},[o.DATETIME]:{[o.DATETIME]:{resultType:o.NUMBER}}},"<=":{[o.NUMBER]:{[o.NUMBER]:{resultType:o.NUMBER}},[o.DATE]:{[o.DATE]:{resultType:o.NUMBER}},[o.DATETIME]:{[o.DATETIME]:{resultType:o.NUMBER}}}},OE={[o.NUMBER]:r=>typeof r=="number"&&!isNaN(r),[o.TEXT]:r=>typeof r=="string",[o.DATE]:r=>typeof r=="number"&&!isNaN(r)&&r>=1&&ju(r),[o.DATETIME]:r=>typeof r=="number"&&!isNaN(r)&&r>=1,[o.ERROR]:r=>r&&typeof r=="object"&&r.error&&typeof r.error=="string",[o.BOOLEAN]:r=>typeof r=="boolean"},vs={formatCanonical(r,s){if(r==null)return"";switch(s){case o.TEXT:return`'${r}`;case o.NUMBER:if(typeof r!="number")return"";const c=m=>{if(m===0)return"0";const T=m.toString();if(!T.includes("e"))return T;const[D,b]=T.split("e"),z=parseInt(b,10);if(z>0){const F=D.split("."),K=F[0],k=F[1]||"";return z>=k.length?K+k+"0".repeat(z-k.length):K+k.substring(0,z)+"."+k.substring(z)}else{const F=Math.abs(z),K=D.split("."),k=K[0],O=K[1]||"",ee=k.startsWith("-"),le=ee?k.substring(1):k;return(ee?"-":"")+"0."+"0".repeat(F-1)+le+O}};if(!isFinite(r)||isNaN(r))return"#NUM!";const i=c(Math.abs(r)),y=r<0?"-":"";let h;if((m=>{const T=m.startsWith("0."),D=m.replace(".","");return(T?D.substring(1):D).length})(i)<=12){h=y+i;const m=h.split(".");if(m[0]=m[0].replace(/\B(?=(\d{3})+(?!\d))/g," "),m.length>1){let T="";const D=m[1];for(let b=0;b<D.length;b++)T+=D[b],(b+1)%3===0&&b<D.length-1&&(T+=" ");m[1]=T}h=m.join(".")}else{h=r.toExponential();const[m,T]=h.split("e"),D=m.split(".");if(D[0]=D[0].replace(/\B(?=(\d{3})+(?!\d))/g," "),D.length>1){let b="";const z=D[1];for(let F=0;F<z.length;F++)b+=z[F],(F+1)%3===0&&F<z.length-1&&(b+=" ");D[1]=b}h=D.join(".")+"e"+T}return h;case o.DATE:case o.DATETIME:return typeof r=="number"?Er(r,s):"";case o.ERROR:return r==null?"#ERROR!":r&&typeof r=="object"&&r.error?r.error:"#ERROR!";default:return""}},detectType(r,s=da.US){if(r==null)return{type:o.TEXT,value:"",canonicalValue:""};if(typeof r=="number"){const i=this.formatCanonical(r,o.NUMBER);return{type:o.NUMBER,value:r,canonicalValue:i}}if(typeof r=="boolean")return{type:o.BOOLEAN,value:r,canonicalValue:r?"TRUE":"FALSE"};if(r&&typeof r=="object"&&r.error)return{type:o.ERROR,value:null,canonicalValue:r.error,error:r.error};if(typeof r=="string"){const i=r.trim();if(i.startsWith("="))return{type:o.NUMBER,value:i,canonicalValue:i,isFormula:!0};if(i.startsWith("'")){const m=i.substring(1);return{type:o.TEXT,value:m,canonicalValue:`'${m}`}}const y=x0(i,s);if(y.success){if(y.type===o.DATETIME)return{type:o.DATETIME,value:y.value,canonicalValue:Er(y.value,o.DATETIME)};if(y.type===o.DATE)return{type:o.DATE,value:y.value,canonicalValue:Er(y.value,o.DATE)}}if(/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$/.test(i)){const m=parseFloat(i);if(!isNaN(m))return{type:o.NUMBER,value:m,canonicalValue:this.formatCanonical(m,o.NUMBER)}}if(/^[-+]?[0-9]{1,3}( [0-9]{3})*(\.[0-9]{1,3}( [0-9]{1,3})*)?([eE][-+]?[0-9]+)?$/.test(i)){const m=i.replace(/\s/g,""),T=parseFloat(m);if(!isNaN(T))return{type:o.NUMBER,value:T,canonicalValue:this.formatCanonical(T,o.NUMBER)}}if(/^[-+]?[0-9]*\.?[0-9]+%$/.test(i)){const m=i.slice(0,-1),T=parseFloat(m)/100;if(!isNaN(T))return{type:o.NUMBER,value:T,canonicalValue:this.formatCanonical(T,o.NUMBER)}}return{type:o.TEXT,value:i,canonicalValue:`'${i}`}}const c=String(r);return{type:o.TEXT,value:c,canonicalValue:`'${c}`}},isType(r,s){return OE[s]?OE[s](r):(console.error(`[TypeService] Unknown type: ${s}`),!1)},createTypedValue(r,s){return this.isType(r,s)?{value:r,type:s}:{value:null,type:o.ERROR,error:Zt.TYPE_MISMATCH}},validateOperation(r,s,c){if(!Lu[s])return{valid:!1,error:`Unsupported operator: ${s}`};if(!Lu[s][r])return{valid:!1,error:"#TYPE!"};const i=Lu[s][r][c];return i?{valid:!0,resultType:i.resultType,constraints:i.constraints||null}:{valid:!1,error:"#TYPE!"}},performOperation(r,s,c){const i=this.validateOperation(r.type,s,c.type);if(!i.valid)return{value:null,type:o.ERROR,error:i.error||"#TYPE!"};const y=Lu[s][r.type][c.type];if(y.validate&&!y.validate(r.value,c.value))return{value:null,type:o.ERROR,error:y.error||Zt.TYPE_MISMATCH};try{let h;switch(s){case"+":if(r.type===o.NUMBER&&c.type===o.NUMBER)h=r.value+c.value;else if(r.type===o.NUMBER&&c.type===o.DATE){const E=fs(c.value,Math.round(r.value));if(E.success)h=E.value;else return{value:null,type:o.ERROR,error:E.error||Zt.CALCULATION_ERROR}}else if(r.type===o.DATE&&c.type===o.NUMBER){const E=fs(r.value,Math.round(c.value));if(E.success)h=E.value;else return{value:null,type:o.ERROR,error:E.error||Zt.CALCULATION_ERROR}}else if(r.type===o.NUMBER&&c.type===o.DATETIME){const E=ds(c.value,r.value);if(E.success)h=E.value;else return{value:null,type:o.ERROR,error:E.error||Zt.CALCULATION_ERROR}}else if(r.type===o.DATETIME&&c.type===o.NUMBER){const E=ds(r.value,c.value);if(E.success)h=E.value;else return{value:null,type:o.ERROR,error:E.error||Zt.CALCULATION_ERROR}}break;case"-":if(r.type===o.NUMBER&&c.type===o.NUMBER)h=r.value-c.value;else if(r.type===o.DATE&&c.type===o.NUMBER){const E=fs(r.value,-Math.round(c.value));if(E.success)h=E.value;else return{value:null,type:o.ERROR,error:E.error||Zt.CALCULATION_ERROR}}else if(r.type===o.DATE&&c.type===o.DATE){const E=XE(r.value,c.value);if(E.success)h=E.value;else return{value:null,type:o.ERROR,error:Zt.CALCULATION_ERROR}}else if(r.type===o.DATETIME&&c.type===o.NUMBER){const E=ds(r.value,-c.value);if(E.success)h=E.value;else return{value:null,type:o.ERROR,error:E.error||Zt.CALCULATION_ERROR}}else if(r.type===o.DATETIME&&c.type===o.DATETIME){const E=U0(r.value,c.value);if(E.success)h=E.value;else return{value:null,type:o.ERROR,error:Zt.CALCULATION_ERROR}}break;case"*":r.type===o.NUMBER&&c.type===o.NUMBER&&(h=r.value*c.value);break;case"/":if(r.type===o.NUMBER&&c.type===o.NUMBER){if(c.value===0)return{value:null,type:o.ERROR,error:"#DIV/0!"};h=r.value/c.value}break;case"^":r.type===o.NUMBER&&c.type===o.NUMBER&&(h=Math.pow(r.value,c.value));break;case"=":h=r.value===c.value?1:0;break;case"<>":h=r.value!==c.value?1:0;break;case">":h=r.value>c.value?1:0;break;case"<":h=r.value<c.value?1:0;break;case">=":h=r.value>=c.value?1:0;break;case"<=":h=r.value<=c.value?1:0;break;default:return{value:null,type:o.ERROR,error:`Unsupported operator: ${s}`}}return{value:h,type:i.resultType}}catch(h){return console.error("[TypeService] Error performing operation:",h),{value:null,type:o.ERROR,error:Zt.CALCULATION_ERROR}}},formatForDisplay(r,s,c={}){if(r==null)return"";switch(s){case o.NUMBER:return typeof r=="number"?r.toString():String(r);case o.TEXT:return String(r);case o.DATE:return typeof r=="number"?Er(r,"date"):String(r);case o.DATETIME:return typeof r=="number"?Er(r,"datetime"):String(r);case o.ERROR:return r&&typeof r=="object"&&r.error?r.error:String(r);default:return String(r)}}},GE=1899,$E=30,M0=[31,28,31,30,31,30,31,31,30,31,30,31],da={US:"US"},Ss=r=>r%4===0&&r%100!==0||r%400===0,Gu=(r,s)=>s===1&&Ss(r)?29:M0[s],Pl=(r,s,c)=>{if(!Number.isInteger(r)||!Number.isInteger(s)||!Number.isInteger(c))return null;const i=s-1;if(i<0||i>11||c<1||c>Gu(r,i))return null;if(r===1899&&s===12&&c===31)return 1;let y=0;for(let h=GE;h<r;h++)y+=Ss(h)?366:365;for(let h=0;h<i;h++)y+=Gu(r,h);return y+=c,y-=$E,y},sl=r=>{if(!Number.isInteger(r)||r<1||r>3e6)return null;if(r===1)return{year:1899,month:12,day:31};let s=r+$E,c=GE;for(;;){const h=Ss(c)?366:365;if(s<=h)break;s-=h,c++}let i=0;for(;i<12;){const h=Gu(c,i);if(s<=h)break;s-=h,i++}const y=s;return{year:c,month:i+1,day:y}},O0=(r,s,c=0)=>r<0||r>23||s<0||s>59||c<0||c>59?0:(r*3600+s*60+c)/86400,hr=r=>{(r<0||r>=1)&&(r=r-Math.floor(r));const s=r*86400,c=Math.floor(s/3600),i=s-c*3600,y=Math.floor(i/60),h=i-y*60;return{hour:c,minute:y,second:h}},_0=r=>{const{hour:s,minute:c,second:i}=hr(r),h=Math.round(i*1e3)/1e3;return{hour:s,minute:c,second:h}},Cl=(r,s,c,i=0,y=0,h=0)=>{if(i<0||i>23||y<0||y>59||h<0||h>59)return null;const E=Pl(r,s,c);if(E===null)return null;if(i===0&&y===0&&h===0)return E;const g=O0(i,y,h);return E+g},D0=r=>{if(typeof r!="number"||r<1)return null;const s=Math.floor(r),c=r-s,i=sl(s);if(!i)return null;const y=hr(c);return{...i,...y}},qE=r=>{if(typeof r!="number"||r<1)return null;const s=Math.floor(r),c=r-s,i=sl(s);if(!i)return null;const y=_0(c);return{...i,...y}},Er=(r,s)=>{if(typeof r!="number"||r<1)return"";try{if(s===o.DATE){const c=sl(Math.floor(r));if(!c)return"";const{year:i,month:y,day:h}=c;return`${i}-${String(y).padStart(2,"0")}-${String(h).padStart(2,"0")}`}else if(s===o.DATETIME){const c=D0(r);if(!c)return"";const{year:i,month:y,day:h,hour:E,minute:g,second:m}=c,T=Math.round(m*1e3),D=Math.floor(T/1e3),b=T%1e3,z=b>0?`${String(D).padStart(2,"0")}.${String(b).padStart(3,"0").replace(/0+$/,"")}`:String(D).padStart(2,"0");return`${i}-${String(y).padStart(2,"0")}-${String(h).padStart(2,"0")} ${String(E).padStart(2,"0")}:${String(g).padStart(2,"0")}:${z}`}return""}catch(c){return console.error("[SerialDate] Error formatting serial value:",c),""}},x0=(r,s=da.US)=>{if(!r||typeof r!="string")return{success:!1};const c=r.trim(),i=/^(\d{4})-(\d{2})-(\d{2}) (\d{1,2}):(\d{2})(?::(\d{2}))?$/,y=c.match(i);if(y){const S=parseInt(y[1],10),v=parseInt(y[2],10),R=parseInt(y[3],10);if(v<1||v>12||R<1||R>31)return{success:!1};const d=parseInt(y[4],10),C=parseInt(y[5],10),U=y[6]?parseInt(y[6],10):0;if(d>23||C>59||U>59)return{success:!1};const L=Cl(S,v,R,d,C,U);if(L!==null)return{success:!0,value:L,type:o.DATETIME}}const h=/^(\d{4})-(\d{2})-(\d{2})T(\d{1,2}):(\d{2})(?::(\d{2}))?Z?$/,E=c.match(h);if(E){const S=parseInt(E[1],10),v=parseInt(E[2],10),R=parseInt(E[3],10);if(v<1||v>12||R<1||R>31)return{success:!1};const d=parseInt(E[4],10),C=parseInt(E[5],10),U=E[6]?parseInt(E[6],10):0;if(d>23||C>59||U>59)return{success:!1};const L=Cl(S,v,R,d,C,U);if(L!==null)return{success:!0,value:L,type:o.DATETIME}}const g=/^(\d{1,2})\.(\d{1,2})\.(\d{4}) (\d{1,2}):(\d{2})(?::(\d{2}))?$/,m=c.match(g);if(m){const S=parseInt(m[1],10),v=parseInt(m[2],10),R=parseInt(m[3],10);if(v<1||v>12||S<1||S>31)return{success:!1};const d=parseInt(m[4],10),C=parseInt(m[5],10),U=m[6]?parseInt(m[6],10):0;if(d>23||C>59||U>59)return{success:!1};const L=Cl(R,v,S,d,C,U);if(L!==null)return{success:!0,value:L,type:o.DATETIME}}const T=/^(\d{4})(\d{1,2})(\d{1,2}) (\d{1,2})(\d{1,2})(?:(\d{1,2}))?$/,D=c.match(T);if(D){const S=parseInt(D[1],10),v=parseInt(D[2],10),R=parseInt(D[3],10);if(v<1||v>12||R<1||R>31)return{success:!1};const d=parseInt(D[4],10),C=parseInt(D[5],10),U=D[6]?parseInt(D[6],10):0;if(d>23||C>59||U>59)return{success:!1};const L=Cl(S,v,R,d,C,U);if(L!==null)return{success:!0,value:L,type:o.DATETIME}}const b=/^(\d{4}) (\d{1,2}) (\d{1,2}) (\d{1,2}):(\d{2})(?::(\d{2}))?$/,z=c.match(b);if(z){const S=parseInt(z[1],10),v=parseInt(z[2],10),R=parseInt(z[3],10);if(v<1||v>12||R<1||R>31)return{success:!1};const d=parseInt(z[4],10),C=parseInt(z[5],10),U=z[6]?parseInt(z[6],10):0;if(d>23||C>59||U>59)return{success:!1};const L=Cl(S,v,R,d,C,U);if(L!==null)return{success:!0,value:L,type:o.DATETIME}}const F=/^(\d{4})\/(\d{1,2})\/(\d{1,2}) (\d{1,2}):(\d{2})(?::(\d{2}))?$/,K=c.match(F);if(K){const S=parseInt(K[1],10),v=parseInt(K[2],10),R=parseInt(K[3],10);if(v<1||v>12||R<1||R>31)return{success:!1};const d=parseInt(K[4],10),C=parseInt(K[5],10),U=K[6]?parseInt(K[6],10):0;if(d>23||C>59||U>59)return{success:!1};const L=Cl(S,v,R,d,C,U);if(L!==null)return{success:!0,value:L,type:o.DATETIME}}const k=/^(\d{1,2})[/-](\d{1,2})[/-](\d{4}) (\d{1,2}):(\d{2})(?::(\d{2}))? (AM|PM)$/i,O=c.match(k);if(O){const S=parseInt(O[1],10),v=parseInt(O[2],10),R=parseInt(O[3],10);let d=parseInt(O[4],10);const C=parseInt(O[5],10),U=O[6]?parseInt(O[6],10):0,L=O[7].toUpperCase();L==="PM"&&d<12&&(d+=12),L==="AM"&&d===12&&(d=0);let q,Q;if(s===da.US){if(Q=S,q=v,Q<1||Q>12)return{success:!1}}else if(q=S,Q=v,Q<1||Q>12)return{success:!1};if(q<1||q>31)return{success:!1};if(d>23||C>59||U>59)return{success:!1};const W=Cl(R,Q,q,d,C,U);if(W!==null)return{success:!0,value:W,type:o.DATETIME}}const ee=/^(\d{1,2})[/-](\d{1,2})[/-](\d{4}) (\d{4})$/,le=c.match(ee);if(le){const S=parseInt(le[1],10),v=parseInt(le[2],10),R=parseInt(le[3],10),d=parseInt(le[4],10),C=Math.floor(d/100),U=d%100;let L,q;if(s===da.US){if(q=S,L=v,q<1||q>12)return{success:!1}}else if(L=S,q=v,q<1||q>12)return{success:!1};if(L<1||L>31)return{success:!1};if(C>23||U>59)return{success:!1};const Q=Cl(R,q,L,C,U,0);if(Q!==null)return{success:!0,value:Q,type:o.DATETIME}}const X=/^(\d{1,2})(\/|-)(\d{1,2})(\2)(\d{4}) (\d{1,2}):(\d{2})(?::(\d{2}))?$/,se=c.match(X);if(se){const S=parseInt(se[1],10),v=parseInt(se[3],10),R=parseInt(se[5],10);let d,C;if(s===da.US){if(C=S,d=v,C<1||C>12)return{success:!1}}else if(d=S,C=v,C<1||C>12)return{success:!1};if(d<1||d>31)return{success:!1};const U=parseInt(se[6],10),L=parseInt(se[7],10),q=se[8]?parseInt(se[8],10):0;if(U>23||L>59||q>59)return{success:!1};const Q=Cl(R,C,d,U,L,q);if(Q!==null)return{success:!0,value:Q,type:o.DATETIME}}const te=/^(\d{4})-(\d{2})-(\d{2})$/,ye=c.match(te);if(ye){const S=parseInt(ye[1],10),v=parseInt(ye[2],10),R=parseInt(ye[3],10);if(v<1||v>12||R<1||R>31)return{success:!1};const d=Pl(S,v,R);if(d!==null)return{success:!0,value:d,type:o.DATE}}const pe=/^(\d{1,2})\.(\d{1,2})\.(\d{4})$/,me=c.match(pe);if(me){const S=parseInt(me[1],10),v=parseInt(me[2],10),R=parseInt(me[3],10);if(v<1||v>12||S<1||S>31)return{success:!1};const d=Pl(R,v,S);if(d!==null)return{success:!0,value:d,type:o.DATE}}const xe=/^(\d{4})(\d{1,2})(\d{1,2})$/,Ue=c.match(xe);if(Ue){const S=parseInt(Ue[1],10),v=parseInt(Ue[2],10),R=parseInt(Ue[3],10);if(v<1||v>12||R<1||R>31)return{success:!1};const d=Pl(S,v,R);if(d!==null)return{success:!0,value:d,type:o.DATE}}const ue=/^(\d{4}) (\d{1,2}) (\d{1,2})$/,ie=c.match(ue);if(ie){const S=parseInt(ie[1],10),v=parseInt(ie[2],10),R=parseInt(ie[3],10);if(v<1||v>12||R<1||R>31)return{success:!1};const d=Pl(S,v,R);if(d!==null)return{success:!0,value:d,type:o.DATE}}const Z=/^(\d{4})\/(\d{1,2})\/(\d{1,2})$/,J=c.match(Z);if(J){const S=parseInt(J[1],10),v=parseInt(J[2],10),R=parseInt(J[3],10);if(v<1||v>12||R<1||R>31)return{success:!1};const d=Pl(S,v,R);if(d!==null)return{success:!0,value:d,type:o.DATE}}const B=/^(\d{1,2})(\/|-)(\d{1,2})(\2)(\d{4})$/,A=c.match(B);if(A){const S=parseInt(A[1],10),v=parseInt(A[3],10),R=parseInt(A[5],10);let d,C;if(s===da.US){if(C=S,d=v,C<1||C>12)return{success:!1}}else if(d=S,C=v,C<1||C>12)return{success:!1};if(d<1||d>31)return{success:!1};const U=Pl(R,C,d);if(U!==null)return{success:!0,value:U,type:o.DATE}}return{success:!1}},fs=(r,s)=>!Number.isInteger(r)||!Number.isInteger(s)?{success:!1,error:"Cannot add fractional days to DATE type. Use DATETIME instead."}:{success:!0,value:r+s},ds=(r,s)=>typeof r!="number"||typeof s!="number"?{success:!1}:{success:!0,value:r+s},XE=(r,s)=>!Number.isInteger(r)||!Number.isInteger(s)?{success:!1}:{success:!0,value:r-s},U0=(r,s)=>typeof r!="number"||typeof s!="number"?{success:!1}:{success:!0,value:r-s},cl={ISO:"YYYY-MM-DD",US:"MM/DD/YYYY",EU:"DD/MM/YYYY",SHORT_YEAR_US:"MM/DD/YY",SHORT_YEAR_EU:"DD/MM/YY"},gr={ISO:"YYYY-MM-DD HH:mm:ss"},Es=(r,s=cl.ISO)=>{if(typeof r!="number"||r<1)return"";try{const c=sl(Math.floor(r));if(!c)return"";const{year:i,month:y,day:h}=c;let E=s;return E=E.replace("YYYY",i),E=E.replace("YY",String(i).slice(-2)),E=E.replace("MM",String(y).padStart(2,"0")),E=E.replace("DD",String(h).padStart(2,"0")),E}catch(c){return console.error("[DateUtils] Error formatting date:",c),""}},ys=(r,s=gr.ISO)=>{if(typeof r!="number"||r<1)return"";try{const c=sl(Math.floor(r));if(!c)return"";const{year:i,month:y,day:h}=c,E=r-Math.floor(r),g=Math.round(E*24*60*60),m=Math.floor(g/3600),T=Math.floor(g%3600/60),D=g%60;let b=s;if(b=b.replace("YYYY",i),b=b.replace("YY",String(i).slice(-2)),b=b.replace("MM",String(y).padStart(2,"0")),b=b.replace("DD",String(h).padStart(2,"0")),b.includes("HH")?b=b.replace("HH",String(m).padStart(2,"0")):b.includes("H")&&(b=b.replace("H",String(m))),b.includes("hh")||b.includes("h")||b.includes("A")){const z=m>=12?"PM":"AM",F=m===0?12:m>12?m-12:m;b.includes("hh")?b=b.replace("hh",String(F).padStart(2,"0")):b.includes("h")&&(b=b.replace("h",String(F))),b=b.replace("A",z)}return b=b.replace("mm",String(T).padStart(2,"0")),b=b.replace("ss",String(D).padStart(2,"0")),b}catch(c){return console.error("[DateUtils] Error formatting datetime:",c),""}},w0=1e-10,ju=r=>Math.abs(Math.round(r)-r)<w0,L0=(r,s)=>XE(r,s),I0=r=>{try{const s=sl(Math.floor(r));if(!s)throw new Error("Invalid serial date");const{year:c,month:i}=s,y=Gu(c,i);return Pl(c,i,y)}catch(s){return console.error("[DateUtils] Error getting last day of month:",s),r}},Ot={GENERAL:"general",NUMBER:"number",CURRENCY:"currency",PERCENTAGE:"percentage",SCIENTIFIC:"scientific",TIME_DURATION:"timeDuration",DATE:"date",DATETIME:"datetime",TIME:"time"},oa={ISO:"YYYY-MM-DD",US_SHORT:"MM/DD/YYYY",EU_SHORT:"DD/MM/YYYY",US_LONG:"MMMM DD, YYYY",EU_LONG:"DD MMMM, YYYY"},al={US_24H:"MM/DD/YYYY H:mm",EU_24H:"DD/MM/YYYY H:mm",ISO_SHORT:"YYYY-MM-DD HH:mm",ISO:"YYYY-MM-DD HH:mm:ss",US_12H:"MM/DD/YYYY h:mm A",EU_12H:"DD/MM/YYYY h:mm A",ISO_12H:"YYYY-MM-DD h:mm A",US:"MM/DD/YYYY HH:mm:ss",EU:"DD/MM/YYYY HH:mm:ss"},_E={STANDARD:"HH:mm:ss",HOUR_12H:"hh:mm A"},Y0=(r,s,c={})=>{if(r==null||r==="")return"";const i=parseFloat(r);if(!isNaN(i))switch(s){case Ot.GENERAL:return r.toString();case Ot.NUMBER:return Ns(i,c);case Ot.CURRENCY:return H0(i,c);case Ot.PERCENTAGE:return z0(i,c);case Ot.SCIENTIFIC:return j0(i,c);case Ot.TIME_DURATION:return V0(i,c);case Ot.DATE:return G0(i,c);case Ot.DATETIME:return $0(i,c);case Ot.TIME:return q0(i,c);default:return r.toString()}return r.toString()},Ns=(r,s)=>{const{decimalPlaces:c=2,useThousandsSeparator:i=!0,negativeStyle:y="minus"}=s;let h=r.toFixed(c);if(i){const E=h.split(".");E[0]=E[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),h=E.join(".")}if(r<0)switch(y){case"parentheses":h=`(${h.replace("-","")})`;break}return h},H0=(r,s)=>{const{symbol:c="$",position:i="before",decimalPlaces:y=2,useThousandsSeparator:h=!0}=s,E=Ns(r,{decimalPlaces:y,useThousandsSeparator:h});return i==="before"?`${c}${E}`:`${E}${c}`},z0=(r,s)=>{const{decimalPlaces:c=2,useThousandsSeparator:i=!0}=s,y=r*100;return`${Ns(y,{decimalPlaces:c,useThousandsSeparator:i})}%`},j0=(r,s)=>{const{decimalPlaces:c=2}=s;if(r===0){const T="0".repeat(c);return`${c>0?`0.${T}`:"0"}E+0`}const i=r.toExponential(c),[y,h]=i.split("e"),E=parseInt(h),m=`${E>=0?"+":""}${E}`;return`${y}E${m}`},V0=(r,s)=>{const{units:c=["days","hours"],style:i="abbreviated",decimalPlaces:y=0}=s;if(r===0)return i==="long"?"0 hours":"0h";const h=Math.abs(r),E=r<0,g={years:365.25,months:30.44,weeks:7,days:1,hours:1/24,minutes:1/(24*60),seconds:1/(24*60*60)},m={years:{abbr:"y",singular:"year",plural:"years"},months:{abbr:"mo",singular:"month",plural:"months"},weeks:{abbr:"w",singular:"week",plural:"weeks"},days:{abbr:"d",singular:"day",plural:"days"},hours:{abbr:"h",singular:"hour",plural:"hours"},minutes:{abbr:"m",singular:"minute",plural:"minutes"},seconds:{abbr:"s",singular:"second",plural:"seconds"}};let T=h;const D=[];for(const z of c)if(g[z]&&T>=g[z]){const F=Math.floor(T/g[z]);if(F>0)if(T-=F*g[z],i==="long"){const K=F===1?m[z].singular:m[z].plural;D.push(`${F} ${K}`)}else D.push(`${F}${m[z].abbr}`)}if(D.length===0){const z=c[c.length-1],F=Math.max(1,Math.round(h/g[z]));if(i==="long"){const K=F===1?m[z].singular:m[z].plural;D.push(`${F} ${K}`)}else D.push(`${F}${m[z].abbr}`)}const b=D.join(" ");return E?`-${b}`:b},G0=(r,s)=>{if(typeof r!="number"||r<1)return"Invalid Date";const{format:c=oa.ISO}=s,i=sl(Math.floor(r));if(!i)return"Invalid Date";const{year:y,month:h,day:E}=i;switch(c){case oa.ISO:return`${y}-${String(h).padStart(2,"0")}-${String(E).padStart(2,"0")}`;case oa.US_SHORT:return`${String(h).padStart(2,"0")}/${String(E).padStart(2,"0")}/${y}`;case oa.EU_SHORT:return`${String(E).padStart(2,"0")}/${String(h).padStart(2,"0")}/${y}`;case oa.US_LONG:return`${DE(h-1)} ${E}, ${y}`;case oa.EU_LONG:return`${E} ${DE(h-1)}, ${y}`;default:return`${y}-${String(h).padStart(2,"0")}-${String(E).padStart(2,"0")}`}},$0=(r,s)=>{if(typeof r!="number"||r<1)return"Invalid DateTime";const{format:c=al.ISO}=s,i=qE(r);if(!i)return"Invalid DateTime";const{year:y,month:h,day:E,hour:g,minute:m,second:T}=i;switch(c){case al.US_24H:return`${String(h).padStart(2,"0")}/${String(E).padStart(2,"0")}/${y} ${g}:${String(m).padStart(2,"0")}`;case al.EU_24H:return`${String(E).padStart(2,"0")}/${String(h).padStart(2,"0")}/${y} ${g}:${String(m).padStart(2,"0")}`;case al.ISO_SHORT:return`${y}-${String(h).padStart(2,"0")}-${String(E).padStart(2,"0")} ${String(g).padStart(2,"0")}:${String(m).padStart(2,"0")}`;case al.ISO:return`${y}-${String(h).padStart(2,"0")}-${String(E).padStart(2,"0")} ${String(g).padStart(2,"0")}:${String(m).padStart(2,"0")}:${String(T).padStart(2,"0")}`;case al.US_12H:const D=g>=12?"PM":"AM",b=g%12||12;return`${String(h).padStart(2,"0")}/${String(E).padStart(2,"0")}/${y} ${String(b).padStart(2,"0")}:${String(m).padStart(2,"0")} ${D}`;case al.EU_12H:const z=g>=12?"PM":"AM",F=g%12||12;return`${String(E).padStart(2,"0")}/${String(h).padStart(2,"0")}/${y} ${String(F).padStart(2,"0")}:${String(m).padStart(2,"0")} ${z}`;case al.ISO_12H:const K=g>=12?"PM":"AM",k=g%12||12;return`${y}-${String(h).padStart(2,"0")}-${String(E).padStart(2,"0")} ${String(k).padStart(2,"0")}:${String(m).padStart(2,"0")} ${K}`;case al.US:return`${String(h).padStart(2,"0")}/${String(E).padStart(2,"0")}/${y} ${String(g).padStart(2,"0")}:${String(m).padStart(2,"0")}:${String(T).padStart(2,"0")}`;case al.EU:return`${String(E).padStart(2,"0")}/${String(h).padStart(2,"0")}/${y} ${String(g).padStart(2,"0")}:${String(m).padStart(2,"0")}:${String(T).padStart(2,"0")}`;default:return`${y}-${String(h).padStart(2,"0")}-${String(E).padStart(2,"0")} ${String(g).padStart(2,"0")}:${String(m).padStart(2,"0")}:${String(T).padStart(2,"0")}`}},DE=r=>["January","February","March","April","May","June","July","August","September","October","November","December"][r],q0=(r,s)=>{if(typeof r!="number"||r<0)return"Invalid Time";const{format:c=_E.STANDARD,includeSeconds:i=!0}=s,y=qE(r);if(!y)return"Invalid Time";const{hour:h,minute:E,second:g}=y;if(c===_E.HOUR_12H){const m=h>=12?"PM":"AM";return`${h%12||12}:${String(E).padStart(2,"0")}${i?":"+String(g).padStart(2,"0"):""} ${m}`}return i?`${String(h).padStart(2,"0")}:${String(E).padStart(2,"0")}:${String(g).padStart(2,"0")}`:`${String(h).padStart(2,"0")}:${String(E).padStart(2,"0")}`},Le={INPUT:"input",NAMED_RANGE:"namedRange",CUSTOM_FUNCTION:"customFunction",BUILT_IN_FUNCTION:"builtInFunction"},X0=new Set(["TRUE","FALSE"]);function tt(r){return typeof r=="string"?r.trim().toUpperCase().replace(/\s+/g,"_"):""}function B0(r){return/^[A-Z_][A-Z0-9_]{0,254}$/.test(r)}function F0(r){return/^[A-Z]{1,3}[1-9][0-9]{0,2}$/.test(r)}class Z0{constructor(){this.names={[Le.INPUT]:new Set,[Le.NAMED_RANGE]:new Set,[Le.CUSTOM_FUNCTION]:new Set,[Le.BUILT_IN_FUNCTION]:new Set}}validateName(s){if(typeof s=="string"&&(s.includes(" ")||s.includes("-")||s.includes(".")))return console.warn(`[NameRegistry] Name "${s}" contains invalid characters`),!1;const c=tt(s);return c?B0(c)?c.length<1||c.length>255?(console.warn(`[NameRegistry] Name "${c}" fails length validation: ${c.length} characters`),!1):X0.has(c)?(console.warn(`[NameRegistry] Name "${c}" is a reserved word`),!1):F0(c)?(console.warn(`[NameRegistry] Name "${c}" looks like a cell reference`),!1):!0:(console.warn(`[NameRegistry] Name fails format validation: "${c}"`),!1):(console.warn(`[NameRegistry] Name "${s}" is empty after normalization`),!1)}nameExists(s){const c=tt(s);return Object.values(this.names).some(i=>i.has(c))}registerName(s,c){const i=tt(s),y=this.nameExists(i);return this.validateName(i)?y?(console.warn(`[NameRegistry] Name "${i}" already exists`),!1):this.names[c]?(this.names[c].add(i),!0):(console.error(`Invalid type: ${c}`),!1):!1}deregisterName(s,c){const i=tt(s);this.names[c]&&this.names[c].delete(i)}forceRegisterName(s,c){const i=tt(s);this.names[c]&&this.names[c].add(i)}getNamesByType(s){return this.names[s]?Array.from(this.names[s]):[]}getNameType(s){const c=tt(s);for(const i in this.names)if(this.names[i].has(c))return i;return null}clearNamesByType(s){this.names[s]?(this.names[s].clear(),console.log(`[NameRegistry] Cleared all names of type: ${s}`)):console.warn(`[NameRegistry] Cannot clear names: Invalid type ${s}`)}_reset(s={}){const{preserveBuiltIns:c=!1}=s;this.names[Le.INPUT].clear(),this.names[Le.NAMED_RANGE].clear(),this.names[Le.CUSTOM_FUNCTION].clear(),c||this.names[Le.BUILT_IN_FUNCTION].clear()}}const be=new Z0,Tr=r=>r?!r.canonicalValue||r.canonicalValue==="":!0,xE=r=>{if(!r)return"";let s=0;for(let c=0;c<r.length;c++){const i=r.charCodeAt(c);s=(s<<5)-s+i,s=s&s}return s.toString(16)},Q0=(r,s)=>{if(!s||!s.length||!r)return"";const c=new Set,i=new Set;s.forEach(g=>{c.add(g.col),i.add(g.row)});const y=Array.from(c).sort(),h=Array.from(i).sort((g,m)=>g-m),E=[];return h.forEach(g=>{const m=[];y.forEach(T=>{const D=`${T}${g}`,b=r[D];let z="";b&&(b.rawValue?z=b.rawValue:b.displayValue!==void 0&&(z=String(b.displayValue))),m.push(z)}),E.push(m)}),E.map(g=>g.join("	")).join(`
`)},_t=r=>{if(!r||typeof r!="string")return null;const s=r.match(/^(\$?)([A-Z]+)(\$?)([1-9][0-9]*)$/i);if(!s)return null;const[c,i,y,h,E]=s,g=i==="$",m=h==="$",T=parseInt(E);let D=0;for(let b=0;b<y.length;b++)D=D*26+(y.charAt(b).toUpperCase().charCodeAt(0)-65+1);return D--,{col:D,row:T-1,colAbs:g,rowAbs:m,originalCol:y.toUpperCase(),originalFormat:r}},$u=r=>{let s="",c=r+1;for(;c>0;){const i=(c-1)%26;s=String.fromCharCode(65+i)+s,c=Math.floor((c-1)/26)}return s},k0=(r,s,c={})=>{const{colAbs:i=!1,rowAbs:y=!1}=c,h=$u(r),E=s+1;return`${i?"$":""}${h}${y?"$":""}${E}`},Ea=(r,s)=>{if(!r||!s||!s.start)return!1;const c=typeof r=="string"?r.replace(/\$/g,""):r,i=_t(c);if(!i)return!1;const y=s.start||s.startRef,h=s.end||s.endRef,E=_t(y),g=_t(h||y);if(!E||!g)return!1;const m=Math.min(E.col,g.col),T=Math.max(E.col,g.col),D=Math.min(E.row,g.row),b=Math.max(E.row,g.row);return i.col>=m&&i.col<=T&&i.row>=D&&i.row<=b},BE=r=>{if(!r||typeof r!="string"||!r.startsWith("="))return[];const s=/(\$?)([A-Za-z]+)(\$?)(\d+)/g,c=[];let i;for(;(i=s.exec(r))!==null;){const[y,h,E,g,m]=i;c.push({cellRef:E.toUpperCase()+m,fullRef:y,absoluteInfo:{colAbs:h==="$",rowAbs:g==="$"},position:{start:i.index,end:i.index+y.length}})}return c},Vu=(r,s,c,i={})=>{const{preserveAbsoluteRefs:y=!i.isCutOperation,isCutOperation:h=!1}=i,E=r.match(/^(\$?)([A-Z]+)(\$?)(\d+)$/i);if(!E)return r;const[g,m,T,D,b]=E,z=m==="$",F=D==="$",K=T+b,k=s.start.replace(/\$/g,""),O=(s.end||s.start).replace(/\$/g,""),ee=c.replace(/\$/g,""),le=_t(K),X=_t(k),se=_t(O),te=_t(ee);if(!le||!X||!te||!se)return r;const ye=te.col-X.col,pe=te.row-X.row;let me=le.col,xe=le.row;if(Ea(K,{start:k,end:O})&&h){const ie=le.col-X.col,Z=le.row-X.row;me=te.col+ie,xe=te.row+Z}else(!z||!y)&&(me+=ye),(!F||!y)&&(xe+=pe);const ue=$u(me);return`${z?"$":""}${ue}${F?"$":""}${xe+1}`},K0=(r,s)=>{if(!r||typeof r!="string"||!r.startsWith("=")||!(s!=null&&s.size))return r;const c=BE(r);let i=r;for(let y=c.length-1;y>=0;y--){const h=c[y],E=h.cellRef.toUpperCase();if(s.has(E)){const g=i.substring(0,h.position.start),m=i.substring(h.position.end);i=g+"#REF!"+m}}return i},ms=(r,s,c,i={})=>{if(!r||typeof r!="string"||!r.startsWith("="))return r;const{isCutOperation:y=!1,overwrittenCells:h=new Set}=i,E=_t(s.start),g=_t(s.end||s.start),m=_t(c);if(!E||!g||!m||(h.size>0&&(r=K0(r,h)),r.includes("#REF!")))return r;Math.abs(g.col-E.col)+1,Math.abs(g.row-E.row)+1;const T=/(\$?)([A-Z]+)(\$?)(\d+)/g;return r.replace(T,(D,b,z,F,K)=>{const k=`${z}${K}`,O=b==="$",ee=F==="$";if(Ea(k,s))return Vu(D,s,c,{preserveAbsoluteRefs:!0,isCutOperation:y});if(y){const X=_t(k);if(!X)return D;if(X.col>=Math.min(E.col,g.col)&&X.col<=Math.max(E.col,g.col)&&X.row>=Math.min(E.row,g.row)&&X.row<=Math.max(E.row,g.row)){m.col-Math.min(E.col,g.col),m.row-Math.min(E.row,g.row);const se=X.col-Math.min(E.col,g.col),te=X.row-Math.min(E.row,g.row),ye=m.col+se,pe=m.row+te;return`${O?"$":""}${$u(ye)}${ee?"$":""}${pe+1}`}}else if(!y){const X=_t(k);if(!X)return D;const se=m.col-E.col,te=m.row-E.row;let ye=X.col,pe=X.row;return O||(ye+=se),ee||(pe+=te),`${O?"$":""}${$u(ye)}${ee?"$":""}${pe+1}`}return D})},kt=new Map,il=new Map;typeof window<"u"&&(window.inputsByName=il,window.debugNamedInputs=()=>{const r=be.getNamesByType(Le.INPUT),s=il.size,c=Array.from(il.entries()).map(([y,h])=>({name:y,value:h}));console.log("=== NAMED INPUTS DEBUG ==="),console.log("Names registered in nameRegistry:",r),console.log("Input values in inputsByName map:",c),console.log("inputsByName map size:",s);const i={TAX_RATE:be.nameExists("TAX_RATE"),TAX_RATE_VALUE:il.has("TAX_RATE")?il.get("TAX_RATE"):void 0};return console.log("Test inputs status:",i),{registeredNames:r,inputMapSize:s,inputMapEntries:c,testInputs:i}});const qu=(r,s)=>{const c=tt(r);return be.registerName(c,Le.NAMED_RANGE)?(kt.set(c,{type:"cell",reference:s}),!0):!1},As=(r,s,c)=>{const i=tt(r);return be.registerName(i,Le.NAMED_RANGE)?(kt.set(i,{type:"range",reference:{start:s,end:c}}),!0):!1},Nn=r=>{for(const[s,c]of kt.entries())if(c.type==="cell"&&c.reference===r)return s;return null},ya=(r,s)=>{for(const[c,i]of kt.entries())if(i.type==="range"&&i.reference.start===r&&i.reference.end===s)return c;return null},J0=()=>new Map(kt),ps=()=>Array.from(kt.entries()),UE=r=>{if(!r||!Array.isArray(r)){console.warn("[NamedRanges] Invalid serialized ranges provided for restore");return}kt.clear(),be.clearNamesByType(Le.NAMED_RANGE),r.forEach(([s,c])=>{be.registerName(s,Le.NAMED_RANGE),kt.set(s,c)})},W0=r=>{const s=tt(r);return kt.has(s)?kt.get(s).reference:null},Iu=r=>{if(!r)return!1;const s=r.includes(":");let c=null;if(s){const[i,y]=r.split(":");c=ya(i,y)}else c=Nn(r);return c?bs(c):!1},P0=(r,s)=>{if(!r||!r.type||!r.reference||!s||!s.start)return!1;if(r.type==="cell")return Ea(r.reference,s);if(r.type==="range"){const c=Ea(r.reference.start,s),i=Ea(r.reference.end,s);return c&&i}return!1},ep=(r,s,c={})=>{const{isCutOperation:i=!1}=c;if(!r||!r.start||!r.end||!s||typeof s!="string")return 0;const y=J0(),h=new Map,E=[];if(i){for(const[g,m]of y.entries())if(P0(m,r)){if(m.type==="cell"){const D=Vu(m.reference,r,s,{isCutOperation:i});h.set(g,{type:"cell",reference:D})}else if(m.type==="range"){const D=Vu(m.reference.start,r,s,{isCutOperation:i}),b=Vu(m.reference.end,r,s,{isCutOperation:i});h.set(g,{type:"range",reference:{start:D,end:b}})}E.push(g)}for(const g of E)bs(g);for(const[g,m]of h.entries())m.type==="cell"?qu(g,m.reference):m.type==="range"&&As(g,m.reference.start,m.reference.end);return h.size}else return 0},bs=r=>{const s=tt(r);return be.deregisterName(s,Le.NAMED_RANGE),kt.delete(s)},tp=r=>{const s=tt(r);return be.nameExists(s)&&be.getNameType(s)===Le.NAMED_RANGE&&kt.has(s)},lp=r=>{const s=tt(r),i=be.nameExists(s)&&be.getNameType(s)===Le.INPUT,y=il.has(s);return i||y},np=r=>{const s=tt(r),c=il.get(s);return!il.has(s)&&be.nameExists(s)&&console.warn(`[NamedRanges] Input "${r}" registered but missing value`),c},hs=(r,s)=>{const c=tt(r);return be.nameExists(c)?be.getNameType(c)!==Le.INPUT?!1:(il.set(c,s),!0):be.registerName(c,Le.INPUT)?(il.set(c,s),!0):!1};function FE(r){return typeof r!="string"?!1:r.trim().startsWith("=")}function ap(r){const s=r.match(/^(\$?)([A-Za-z]+)(\$?)([0-9]+)$/);if(!s)return r;const[,c,i,y,h]=s;return`${c}${i.toUpperCase()}${y}${h}`}function rp(r){return r.toUpperCase()}function up(r){return r.replace(/\s+/g,"")}function cp(r){const s=[];let c=0;for(;c<r.length;){const i=r[c];if(/[A-Za-z$]/.test(i)){let y=c;for(;y<r.length&&/[A-Za-z0-9$]/.test(r[y]);)y++;const h=r.substring(c,y);y<r.length&&r[y]==="("?s.push({type:"function",value:h}):/^\$?[A-Za-z]+\$?[0-9]+$/.test(h)?s.push({type:"cellref",value:h}):s.push({type:"identifier",value:h}),c=y}else s.push({type:"char",value:i}),c++}return s}function ip(r){if(!FE(r))return{error:"Not a formula"};try{let s=r.substring(1);s=up(s);const c=cp(s);let i="";for(const y of c)switch(y.type){case"cellref":i+=ap(y.value);break;case"function":i+=rp(y.value);break;case"identifier":i+=y.value;break;case"char":i+=y.value;break;default:i+=y.value}return{canonical:"="+i}}catch(s){return{error:`Canonicalization failed: ${s.message}`}}}const ZE={process(r){if(typeof r!="string")return{isFormula:!1,error:"Input must be a string"};if(!FE(r))return{isFormula:!1};const s=ip(r);return s.error?{isFormula:!0,rawValue:r,canonicalValue:r,error:s.error}:{isFormula:!0,rawValue:r,canonicalValue:s.canonical}}};function QE(r,s){if(typeof r=="string"&&r.startsWith("=")){const y=ZE.process(r);return y.error?{rawValue:r,type:"error",value:null,canonicalValue:y.canonicalValue,isFormula:!0,error:y.error}:{rawValue:r,type:"number",value:0,canonicalValue:y.canonicalValue,isFormula:!0}}const i=vs.detectType(r,s);return{rawValue:r||"",type:i.type,value:i.value,canonicalValue:i.canonicalValue,isFormula:!1}}function en(){return{NUMBER:{currentSubCategory:"general",subcategories:{general:{},number:{decimalPlaces:2,thousandsSeparator:","},currency:{decimalPlaces:2,thousandsSeparator:",",symbol:"$"},percentage:{decimalPlaces:2},scientific:{decimalPlaces:2},timeDuration:{}}},DATE:{displayFormat:"YYYY-MM-DD"},DATETIME:{displayFormat:"YYYY-MM-DD HH:mm:ss",displayType:"datetime"}}}function sp(r){var i;if(!r||!r.currentSubCategory)return{subCategory:"general"};const s=r.currentSubCategory,c=((i=r.subcategories)==null?void 0:i[s])||{};return{subCategory:s,...c}}function fa(r,s,c){var y;return r||(r=en().NUMBER),{currentSubCategory:s,subcategories:{...r.subcategories,[s]:{...(y=r.subcategories)==null?void 0:y[s],...c}}}}function op(r,s){return r||(r=en().NUMBER),{...r,currentSubCategory:s}}function fp(r,s,c){const i=QE(s,c);return r&&r.format&&(i.format={...r.format}),i}function Yu(){return{rawValue:"",canonicalValue:"",value:void 0,type:void 0,isFormula:!1}}const wE=(r="en-US")=>{const s=r.startsWith("en-US");return{dateInputFormat:s?"US":"EU",dateDisplayFormat:cl.ISO,datetimeDisplayFormat:gr.ISO,numberFormats:{number:{decimalPlaces:2,useThousandsSeparator:!0,digitSeparatorOption:s?"comma-period":"period-comma",adaptiveDecimalPlaces:!1},currency:{symbol:"$",symbolPosition:"before",decimalPlaces:2,useThousandsSeparator:!0},percentage:{decimalPlaces:0,multiplyBy100:!0},scientific:{decimalPlaces:2},timeDuration:{format:"HH:MM:SS",showDays:!1}}}},ne={NAVIGATION:"NAVIGATION",EDITING:"EDITING",CELL_REF_SELECTION:"CELL_REF_SELECTION",RANGE_SELECTION:"RANGE_SELECTION",TEXT_SELECTION:"TEXT_SELECTION",RANGE_REF_SELECTION:"RANGE_REF_SELECTION"},kE=re.createContext(),KE=()=>{try{const r=navigator.language||"en-US";return wE(r)}catch(r){return console.warn("Failed to detect browser locale, using default US settings:",r),wE("en-US")}},Cs={currentMode:ne.NAVIGATION,activeCell:{col:"A",row:1},editingCell:null,selection:null,formulaValue:"",isEditingFormula:!1,textSelectionRange:null,lastCursorPosition:0,isSelectingRef:!1,replacementRange:null,replaceReference:!0,spreadsheetSettings:KE(),formatDialog:{isOpen:!1,activeTab:"cell",formatType:"NUMBER",options:{},showTypeWarning:!1,willConvertDataTypes:!1,sourceType:null,targetType:null}};function dp(r,s){var i,y,h,E,g,m;const c=hp(s.type);switch(c&&c!==r.currentMode&&console.log(`[StateManager] Mode change: ${r.currentMode}  ${c}`),s.type){case"ENTER_NAVIGATION_MODE":return{...r,currentMode:ne.NAVIGATION,editingCell:null,isSelectingRef:!1};case"NAVIGATION_TO_EDITING":return{...r,currentMode:ne.EDITING,editingCell:r.activeCell,formulaValue:s.value||"",isEditingFormula:((i=s.value)==null?void 0:i.startsWith("="))||!1};case"NAVIGATION_TO_RANGE_SELECTION":return{...r,currentMode:ne.RANGE_SELECTION,isSelectingRef:!0,selection:{start:s.startCell||r.activeCell,end:s.endCell||r.activeCell}};case"EDITING_TO_NAVIGATION":return{...r,currentMode:ne.NAVIGATION,editingCell:null,formulaValue:"",isEditingFormula:!1,textSelectionRange:null,...s.newActiveCell&&{activeCell:s.newActiveCell},...s.clearSelection&&{selection:null}};case"EDITING_TO_CELL_REF_SELECTION":return r.isEditingFormula?{...r,currentMode:ne.CELL_REF_SELECTION,replaceReference:!0}:(console.warn("[StateManager] Prevented invalid state transition: cannot enter CELL_REF_SELECTION when not editing a formula"),r);case"EDITING_TO_TEXT_SELECTION":return{...r,currentMode:ne.TEXT_SELECTION,textSelectionRange:s.range};case"EDITING_TO_RANGE_REF_SELECTION":return r.isEditingFormula?{...r,currentMode:ne.RANGE_REF_SELECTION,isSelectingRef:!0,selection:{start:s.startCell,end:s.startCell}}:(console.warn("[StateManager] Prevented invalid state transition: cannot enter RANGE_REF_SELECTION when not editing a formula"),r);case"CELL_REF_SELECTION_TO_EDITING":return{...r,currentMode:ne.EDITING,isSelectingRef:!1};case"CELL_REF_SELECTION_TO_RANGE_REF_SELECTION":return{...r,currentMode:ne.RANGE_REF_SELECTION,isSelectingRef:!0,replaceReference:!0,selection:{start:s.startCell||r.activeCell,end:s.endCell||r.activeCell}};case"RANGE_SELECTION_TO_NAVIGATION":return{...r,currentMode:ne.NAVIGATION,isSelectingRef:!1,...s.newActiveCell&&{activeCell:s.newActiveCell,...s.clearSelection&&{selection:null}}};case"RANGE_SELECTION_TO_EDITING":const T=pp(r.selection);return{...r,currentMode:ne.EDITING,editingCell:T||r.activeCell,activeCell:T||r.activeCell,isSelectingRef:!1,selection:null,formulaValue:s.value||"",isEditingFormula:((y=s.value)==null?void 0:y.startsWith("="))||!1};case"TEXT_SELECTION_TO_EDITING":return{...r,currentMode:ne.EDITING,textSelectionRange:null,lastCursorPosition:s.cursorPosition||r.lastCursorPosition};case"TEXT_SELECTION_TO_NAVIGATION":return{...r,currentMode:ne.NAVIGATION,editingCell:null,textSelectionRange:null,formulaValue:"",isEditingFormula:!1,...s.moveDirection&&{activeCell:s.newActiveCell||r.activeCell},...s.clearSelection&&{selection:null}};case"TEXT_SELECTION_TO_RANGE_REF_SELECTION":return{...r,currentMode:ne.RANGE_REF_SELECTION,isSelectingRef:!0,selection:{start:s.startCell,end:s.startCell},replacementRange:r.textSelectionRange};case"RANGE_REF_SELECTION_TO_CELL_REF_SELECTION":return{...r,currentMode:ne.CELL_REF_SELECTION,isSelectingRef:!0,replaceReference:!1,selection:null};case"RANGE_REF_SELECTION_TO_EDITING":return{...r,currentMode:ne.EDITING,isSelectingRef:!1};case"UPDATE_ACTIVE_CELL":return{...r,activeCell:s.cell};case"UPDATE_FORMULA_VALUE":return{...r,formulaValue:s.value,isEditingFormula:s.value.startsWith("=")};case"UPDATE_CURSOR_POSITION":return{...r,lastCursorPosition:s.position};case"UPDATE_TEXT_SELECTION":return{...r,textSelectionRange:s.range};case"UPDATE_RANGE_SELECTION":return{...r,selection:{start:((h=r.selection)==null?void 0:h.start)||r.activeCell,end:s.cell}};case"SET_REPLACE_REFERENCE":return{...r,replaceReference:s.value};case"CLEAR_SELECTION":return{...r,selection:null};case"OPEN_FORMAT_DIALOG":{const D=s.activeTab||"cell";let b="NUMBER";s.currentCellFormat&&(s.currentCellFormat.DATETIME?b="DATETIME":s.currentCellFormat.DATE?b="DATE":s.currentCellFormat.TIME?b="TIME":s.currentCellFormat.NUMBER&&(b="NUMBER"));let z={};return D==="cell"&&((E=s.currentCellFormat)!=null&&E[b])?z=s.currentCellFormat[b]:(g=s.spreadsheetDefaults)!=null&&g[b]?z=s.spreadsheetDefaults[b]:z=en()[b],{...r,formatDialog:{...r.formatDialog,isOpen:!0,activeTab:D,formatType:b,options:z,showTypeWarning:!1,willConvertDataTypes:!1,sourceType:null,targetType:null}}}case"CLOSE_FORMAT_DIALOG":return{...r,formatDialog:{...r.formatDialog,isOpen:!1}};case"SET_FORMAT_TYPE":{const D=s.formatType;let b={};return(m=s.spreadsheetDefaults)!=null&&m[D]?b=s.spreadsheetDefaults[D]:b=en()[D],{...r,formatDialog:{...r.formatDialog,formatType:D,options:b}}}case"SET_FORMAT_OPTIONS":return{...r,formatDialog:{...r.formatDialog,options:s.options}};case"SET_FORMAT_DIALOG_TAB":return{...r,formatDialog:{...r.formatDialog,activeTab:s.tab}};case"SET_TYPE_WARNING":return r.formatDialog.showTypeWarning===s.show&&r.formatDialog.willConvertDataTypes===s.willConvert&&r.formatDialog.sourceType===s.sourceType&&r.formatDialog.targetType===s.targetType?r:{...r,formatDialog:{...r.formatDialog,showTypeWarning:s.show,willConvertDataTypes:s.willConvert,sourceType:s.sourceType,targetType:s.targetType}};case"UPDATE_SPREADSHEET_SETTINGS":return{...r,spreadsheetSettings:{...r.spreadsheetSettings,...s.settings}};default:return r}}class Ep extends VE.Component{constructor(s){super(s),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,c){console.error("StateErrorBoundary caught an error:",s,c),this.setState({errorInfo:c})}render(){return this.state.hasError?N.jsxs("div",{className:"state-error p-4 bg-red-800 text-white rounded-md",children:[N.jsx("h2",{className:"text-lg font-bold",children:"Spreadsheet State Error"}),N.jsx("p",{children:"There was a problem with the spreadsheet state. Try refreshing the page."}),!1]}):this.props.children}}function yp({children:r,initialState:s}){const[c,i]=re.useReducer(dp,s||Cs);return N.jsx(Ep,{children:N.jsx(kE.Provider,{value:{state:c,dispatch:i},children:r})})}function ol(){const r=re.useContext(kE);if(!r)throw new Error("useSpreadsheetState must be used within a StateProvider");return r}const Xu={activeCell:{col:"A",row:1},selection:null,currentMode:ne.NAVIGATION};function Bu(r){if(!r)throw console.error("[StateManager] State is undefined or null"),new Error("State is undefined or null");return r.currentMode||(console.warn("[StateManager] State missing currentMode, using default"),r.currentMode=Xu.currentMode),r.activeCell||(console.warn("[StateManager] State missing activeCell, using default"),r.activeCell=Xu.activeCell),r.formatDialog||(console.warn("[StateManager] State missing formatDialog, using default"),r.formatDialog=Cs.formatDialog),r}function mp(){try{const{state:r}=ol();return Bu(r),r.activeCell}catch(r){return console.error("[StateManager] Failed to access active cell:",r),Xu.activeCell}}function JE(){try{const{state:r}=ol();return Bu(r),r.selection}catch(r){return console.error("[StateManager] Failed to access selection:",r),Xu.selection}}function WE(){try{const{state:r,dispatch:s}=ol();Bu(r);const c=r.formatDialog||Cs.formatDialog,i=re.useCallback((T,D="cell",b=null)=>{s({type:"OPEN_FORMAT_DIALOG",spreadsheetDefaults:T,currentCellFormat:b,activeTab:D})},[s]),y=re.useCallback(()=>{s({type:"CLOSE_FORMAT_DIALOG"})},[s]),h=re.useCallback((T,D)=>{s({type:"SET_FORMAT_TYPE",formatType:T,spreadsheetDefaults:D})},[s]),E=re.useCallback(T=>{s({type:"SET_FORMAT_OPTIONS",options:T})},[s]),g=re.useCallback(T=>{s({type:"SET_FORMAT_DIALOG_TAB",tab:T})},[s]),m=re.useCallback((T,D,b,z)=>{s({type:"SET_TYPE_WARNING",show:T,willConvert:D,sourceType:b,targetType:z})},[s]);return{...c,openFormatDialog:i,closeFormatDialog:y,setFormatType:h,setFormatOptions:E,setFormatDialogTab:g,setTypeWarning:m}}catch(r){return console.error("[StateManager] Failed to access format dialog state:",r),{isOpen:!1,activeTab:"cell",formatType:"general",options:{},showTypeWarning:!1,willConvertDataTypes:!1,sourceType:null,targetType:null,openFormatDialog:()=>console.error("[StateManager] Format dialog state unavailable"),closeFormatDialog:()=>console.error("[StateManager] Format dialog state unavailable"),setFormatType:()=>console.error("[StateManager] Format dialog state unavailable"),setFormatOptions:()=>console.error("[StateManager] Format dialog state unavailable"),setFormatDialogTab:()=>console.error("[StateManager] Format dialog state unavailable"),setTypeWarning:()=>console.error("[StateManager] Format dialog state unavailable")}}}function PE(){try{const{state:r,dispatch:s}=ol();return Bu(r),{settings:r.spreadsheetSettings,updateSettings:re.useCallback(c=>{s({type:"UPDATE_SPREADSHEET_SETTINGS",settings:c})},[s])}}catch(r){return console.error("[StateManager] Error accessing spreadsheet settings:",r),{settings:KE(),updateSettings:()=>console.error("[StateManager] Spreadsheet settings state unavailable")}}}function pp(r){try{if(!r)return null;if(!r.start||!r.end)return console.warn("[StateManager] Invalid selection object missing start or end properties"),null;const s=g=>{if(!g||typeof g!="string")throw console.error("[StateManager] Invalid column value:",g),new Error(`Invalid column value: ${g}`);let m=0;for(let T=0;T<g.length;T++)m=m*26+(g.charCodeAt(T)-65+1);return m-1},c=g=>{if(typeof g!="number"||g<0)throw console.error("[StateManager] Invalid column index:",g),new Error(`Invalid column index: ${g}`);let m="";for(g++;g>0;){const T=(g-1)%26;m=String.fromCharCode(65+T)+m,g=Math.floor((g-T)/26)}return m};if(!r.start.col||!r.end.col||typeof r.start.row!="number"||typeof r.end.row!="number")return console.warn("[StateManager] Invalid selection values:",r),null;const i=s(r.start.col),y=s(r.end.col),h=Math.min(i,y),E=Math.min(r.start.row,r.end.row);return{col:c(h),row:E}}catch(s){return console.error("[StateManager] Error calculating top-left cell:",s),null}}function St(r,s,c,i){try{if(!r)return null;if(!s)return console.warn("[StateManager] No direction provided for calculateNextCell"),r;if(!c||!Array.isArray(c)||c.length===0)return console.warn("[StateManager] Invalid columns array for calculateNextCell"),r;if(!i||!Array.isArray(i)||i.length===0)return console.warn("[StateManager] Invalid rows array for calculateNextCell"),r;if(!r.col||!r.row)return console.warn("[StateManager] Cell is missing col or row property:",r),r;const y=m=>{if(!m||typeof m!="string")throw console.error("[StateManager] Invalid column value:",m),new Error(`Invalid column value: ${m}`);let T=0;for(let D=0;D<m.length;D++)T=T*26+(m.charCodeAt(D)-65+1);return T-1},h=m=>{if(typeof m!="number"||m<0)throw console.error("[StateManager] Invalid column index:",m),new Error(`Invalid column index: ${m}`);let T="";for(m++;m>0;){const D=(m-1)%26;T=String.fromCharCode(65+D)+T,m=Math.floor((m-D)/26)}return T},E=y(r.col),g=i.indexOf(r.row);if(g===-1)return console.warn(`[StateManager] Row ${r.row} not found in rows array`),r;switch(s){case"ArrowUp":if(g>0)return{col:r.col,row:i[g-1]};break;case"ArrowDown":if(g<i.length-1)return{col:r.col,row:i[g+1]};break;case"ArrowLeft":if(E>0)return{col:h(E-1),row:r.row};break;case"ArrowRight":if(E<c.length-1)return{col:h(E+1),row:r.row};break;case"Tab":if(E<c.length-1)return{col:h(E+1),row:r.row};if(g<i.length-1)return{col:h(0),row:i[g+1]};break;case"ShiftTab":if(E>0)return{col:h(E-1),row:r.row};if(g>0)return{col:h(c.length-1),row:i[g-1]};break;case"Enter":if(g<i.length-1)return{col:r.col,row:i[g+1]};break;default:console.warn(`[StateManager] Unknown direction: ${s}`)}return r}catch(y){return console.error("[StateManager] Error calculating next cell:",y),r}}function Jl(r){try{if(!r)return"";if(!r.selection&&r.activeCell){if(!r.activeCell.col||!r.activeCell.row)return console.warn("Invalid active cell missing col or row:",r.activeCell),"A1";const s=`${r.activeCell.col}${r.activeCell.row}`;try{return Nn(s)||s}catch(c){return console.warn("Error getting cell name:",c),s}}if(r.selection&&r.selection.start&&r.selection.end){if(!r.selection.start.col||!r.selection.start.row||!r.selection.end.col||!r.selection.end.row)return console.warn("Invalid selection missing col or row:",r.selection),"";const s=r.selection.start.col,c=r.selection.start.row,i=r.selection.end.col,y=r.selection.end.row;try{const h=Ts(s),E=Ts(i),g=h<=E?s:i,m=Math.min(c,y),T=h<=E?i:s,D=Math.max(c,y),b=`${g}${m}`,z=`${T}${D}`;try{const F=ya(b,z);if(F)return F}catch(F){console.warn("Error getting range name:",F)}return`${b}:${z}`}catch(h){return console.error("Error calculating column indices:",h),`${s}${c}:${i}${y}`}}return""}catch(s){return console.error("Error displaying address:",s),""}}function Ts(r){try{if(!r||typeof r!="string")throw new Error(`Invalid column value: ${r}`);let s=0;for(let c=0;c<r.length;c++)s=s*26+(r.charCodeAt(c)-65+1);return s-1}catch(s){throw console.error("Error getting column index:",s),s}}function hp(r,s){try{if(!r)return null;if(r.includes("_TO_")){const c=r.split("_TO_");if(c.length===2){const i=c[1];return Object.values(ne).includes(i)||console.warn(`Invalid target mode: ${i}`),i}}return null}catch(c){return console.error("Error determining new mode:",c),null}}function gp(r,s,c,i){try{if(!c)return!1;if(!r||!s)return console.warn("Invalid cell coordinates:",{col:r,row:s}),!1;if(!c.start||!c.end)return console.warn("Invalid selection missing start or end:",c),!1;if(!c.start.col||!c.start.row||!c.end.col||!c.end.row)return console.warn("Invalid selection coordinates:",c),!1;const y=c.start.col,h=c.start.row,E=c.end.col,g=c.end.row,m=O=>{try{return Ts(O)}catch(ee){return console.warn(`Error getting column index for ${O}:`,ee),-1}},T=m(y),D=m(E),b=m(r);if(T===-1||D===-1||b===-1)return!1;const z=Math.min(T,D),F=Math.max(T,D),K=Math.min(h,g),k=Math.max(h,g);return b>=z&&b<=F&&s>=K&&s<=k}catch(y){return console.error("Error checking if cell is in selection:",y),!1}}const gs={formatForGrid(r,s,c,i){const y=en();switch(s){case o.NUMBER:const h=c||(i==null?void 0:i.NUMBER)||y.NUMBER,E=sp(h);return Y0(r,E.subCategory,E);case o.TEXT:return String(r);case o.DATE:const m=(c||(i==null?void 0:i.DATE)||y.DATE).displayFormat||cl.ISO;return Es(r,m);case o.DATETIME:const D=(c||(i==null?void 0:i.DATETIME)||y.DATETIME).displayFormat||gr.ISO;return ys(r,D);case o.ERROR:return(r==null?void 0:r.error)||"#ERROR!";default:return String(r)}},formatForFormulaBar(r,s){switch(s){case o.NUMBER:return String(r);case o.TEXT:return`'${r}`;case o.DATE:return Es(r,cl.ISO);case o.DATETIME:return ys(r,gr.ISO);case o.ERROR:return(r==null?void 0:r.error)||"#ERROR!";default:return String(r)}},formatForExport(r,s,c={}){switch(s){case o.NUMBER:return String(r);case o.TEXT:return String(r);case o.DATE:return Es(r,cl.ISO);case o.DATETIME:return ys(r,gr.ISO);case o.ERROR:return(r==null?void 0:r.error)||"#ERROR!";default:return String(r)}},getAlignmentClass(r){switch(r){case o.NUMBER:return"text-right";case o.TEXT:return"text-left";case o.DATE:case o.DATETIME:return"text-left";case o.ERROR:return"text-center";default:return"text-left"}},getTypeStyling(r,s={}){const c={};switch(r){case o.ERROR:return{...c,color:"red",fontWeight:"normal"};default:return c}}},vp=r=>typeof r=="string"&&r.startsWith("#")&&r.endsWith("!"),Tp=({col:r,row:s,data:c,onClick:i,onMouseDown:y,onMouseEnter:h,onDoubleClick:E,onContextMenu:g,defaultFormat:m})=>{var Z,J,B,A,S,v,R,d;const{state:T}=ol(),D=`${r}${s}`,b=c[D],[z,F]=re.useState(!1);re.useEffect(()=>{const C=()=>F(!0),U=()=>F(!1);return window.addEventListener("keydown",C),window.addEventListener("mousemove",U),()=>{window.removeEventListener("keydown",C),window.removeEventListener("mousemove",U)}},[]);const K=(b==null?void 0:b.displayValue)&&vp(b.displayValue),k=T.activeCell&&T.activeCell.col===r&&T.activeCell.row===s,O=T.selection&&gp(r,s,T.selection),ee=T.editingCell&&T.editingCell.col===r&&T.editingCell.row===s,le=k&&![ne.RANGE_SELECTION,ne.RANGE_REF_SELECTION].includes(T.currentMode),X=ee&&[ne.EDITING,ne.TEXT_SELECTION,ne.CELL_REF_SELECTION,ne.RANGE_REF_SELECTION].includes(T.currentMode),se=k&&T.currentMode===ne.CELL_REF_SELECTION,te=O&&T.currentMode===ne.RANGE_REF_SELECTION,ye=[`border border-gray-600 min-w-[60px] w-[60px] h-7 p-0 bg-gray-800 ${z?"":"hover:bg-gray-700"} transition-colors duration-150`,le?"ring-1 ring-purple-500 bg-purple-900/30":"",O?"bg-purple-900/20":"",X?"bg-yellow-900/30":"",se?"ring-1 ring-purple-500 bg-purple-900/30":"",te?"bg-purple-900/20":"",b!=null&&b.markedForCut?"cell-marked-for-cut":"",K?"text-red-500":"",(Z=b==null?void 0:b.format)!=null&&Z.bold?"font-bold":"",(J=b==null?void 0:b.format)!=null&&J.italic?"italic":"",(B=b==null?void 0:b.format)!=null&&B.fontSize?`text-[${b.format.fontSize}px]`:""].join(" "),pe=C=>{switch(C){case"left":return"text-left";case"center":return"text-center";case"right":return"text-right";default:return"text-left"}},me=C=>{switch(C){case o.NUMBER:return"right";case o.DATE:case o.DATETIME:return"center";default:return"left"}},xe=((A=b==null?void 0:b.format)==null?void 0:A.align)||me(b==null?void 0:b.type),Ue=["w-full h-full px-1 py-0.5 text-xs overflow-hidden text-gray-200 select-none",pe(xe)].join(" "),ue={fontSize:(S=b==null?void 0:b.format)!=null&&S.fontSize?`${b.format.fontSize}px`:"13px"};let ie="";if(!Tr(b)){const C=b.type||o.TEXT;if(K)ie=b.error||"#ERROR!";else switch(C){case o.NUMBER:ie=gs.formatForGrid(b.value,b.type,(v=b.format)==null?void 0:v.NUMBER,m);break;case o.DATE:ie=gs.formatForGrid(b.value,b.type,(R=b.format)==null?void 0:R.DATE,m);break;case o.DATETIME:ie=gs.formatForGrid(b.value,b.type,(d=b.format)==null?void 0:d.DATETIME,m);break;case o.TEXT:ie=b.value!==void 0?b.value:"";break;case o.ERROR:ie=b.error||"#ERROR!";break;default:throw new Error(`Unsupported cell type for display formatting: ${C}`)}}return ie!=null&&(ie=String(ie)),N.jsx("td",{"data-cell-id":D,className:ye,onClick:i,onMouseDown:y,onMouseEnter:h,onDoubleClick:E,onContextMenu:g,children:N.jsx("div",{className:Ue,style:ue,children:ie})})},Rp=({data:r,setData:s,formulaBarRef:c,defaultFormat:i,numColumns:y,setNumColumns:h})=>{const{state:E,dispatch:g}=ol(),m=S=>{if(S<26)return String.fromCharCode(65+S);{let v=S+1,R="",d;for(;v>0;)d=(v-1)%26,R=String.fromCharCode(65+d)+R,v=Math.floor((v-d)/26);return R}},[T,D]=re.useState([]),[b,z]=re.useState(null),[F,K]=re.useState(!1),[k,O]=re.useState(""),[ee,le]=re.useState("");re.useEffect(()=>{const S=[];for(let v=0;v<y;v++)S.push(m(v));D(S)},[y]);const X=Array.from({length:20},(S,v)=>v+1),se=re.useRef(!1),te=()=>{h(S=>Math.min(S+10,100))},ye=(S,v,R)=>{var C;const d={col:S,row:v};switch(E.currentMode){case ne.NAVIGATION:g({type:"UPDATE_ACTIVE_CELL",cell:d}),g({type:"CLEAR_SELECTION"}),(C=c==null?void 0:c.current)!=null&&C.selectFormulaText&&setTimeout(()=>c.current.selectFormulaText(),0);break;case ne.EDITING:E.isEditingFormula?(g({type:"EDITING_TO_CELL_REF_SELECTION"}),g({type:"UPDATE_ACTIVE_CELL",cell:d})):(c!=null&&c.current&&c.current.commitValue(),g({type:"EDITING_TO_NAVIGATION",saveChanges:!0,clearSelection:!0}),g({type:"UPDATE_ACTIVE_CELL",cell:d}));break;case ne.RANGE_SELECTION:R!=null&&R.shiftKey||g({type:"RANGE_SELECTION_TO_NAVIGATION",newActiveCell:d,clearSelection:!0});break;case ne.CELL_REF_SELECTION:g({type:"UPDATE_ACTIVE_CELL",cell:d});break;case ne.TEXT_SELECTION:c!=null&&c.current&&c.current.commitValue(),g({type:"TEXT_SELECTION_TO_NAVIGATION",newActiveCell:d,clearSelection:!0});break;case ne.RANGE_REF_SELECTION:R!=null&&R.shiftKey||(g({type:"RANGE_REF_SELECTION_TO_CELL_REF_SELECTION"}),g({type:"UPDATE_ACTIVE_CELL",cell:d}),c!=null&&c.current&&c.current.replaceCellReference(d.col,d.row));break}},pe=(S,v,R)=>{se.current=!0;const d={col:S,row:v};switch(E.currentMode){case ne.NAVIGATION:R!=null&&R.shiftKey?g({type:"NAVIGATION_TO_RANGE_SELECTION",startCell:d}):(g({type:"UPDATE_ACTIVE_CELL",cell:d}),g({type:"CLEAR_SELECTION"}));break;case ne.RANGE_SELECTION:R!=null&&R.shiftKey?(g({type:"UPDATE_RANGE_SELECTION",cell:d}),g({type:"UPDATE_ACTIVE_CELL",cell:d})):g({type:"RANGE_SELECTION_TO_NAVIGATION",newActiveCell:d,clearSelection:!0});break;case ne.EDITING:E.isEditingFormula&&(g({type:"EDITING_TO_CELL_REF_SELECTION"}),g({type:"UPDATE_ACTIVE_CELL",cell:d}),c!=null&&c.current&&(c.current.insertCellReference(d.col,d.row,!1),g({type:"SET_REPLACE_REFERENCE",value:!0})));break;case ne.CELL_REF_SELECTION:if(R!=null&&R.shiftKey){const C={...E.activeCell};g({type:"CELL_REF_SELECTION_TO_RANGE_REF_SELECTION",startCell:C}),g({type:"UPDATE_RANGE_SELECTION",cell:d}),g({type:"UPDATE_ACTIVE_CELL",cell:d}),c!=null&&c.current&&c.current.insertRangeReference(C.col,C.row,d.col,d.row,E.replaceReference)}else g({type:"UPDATE_ACTIVE_CELL",cell:d}),c!=null&&c.current&&(E.replaceReference?c.current.replaceCellReference(d.col,d.row):c.current.insertCellReference(d.col,d.row,!1));break;case ne.RANGE_REF_SELECTION:g({type:"UPDATE_RANGE_SELECTION",cell:d}),g({type:"UPDATE_ACTIVE_CELL",cell:d}),c!=null&&c.current&&E.selection&&c.current.insertRangeReference(E.selection.start.col,E.selection.start.row,d.col,d.row,E.replaceReference);break}},me=(S,v)=>{const R={col:S,row:v};if(se.current)if(E.currentMode===ne.NAVIGATION)g({type:"NAVIGATION_TO_RANGE_SELECTION",startCell:E.activeCell}),g({type:"UPDATE_RANGE_SELECTION",cell:R});else if(E.currentMode===ne.CELL_REF_SELECTION){const d={...E.activeCell};g({type:"CELL_REF_SELECTION_TO_RANGE_REF_SELECTION",startCell:d}),g({type:"UPDATE_RANGE_SELECTION",cell:R}),c!=null&&c.current&&c.current.insertRangeReference(d.col,d.row,R.col,R.row,E.replaceReference)}else[ne.RANGE_SELECTION,ne.RANGE_REF_SELECTION].includes(E.currentMode)&&(g({type:"UPDATE_RANGE_SELECTION",cell:R}),E.currentMode===ne.RANGE_REF_SELECTION&&(c!=null&&c.current)&&E.selection&&c.current.insertRangeReference(E.selection.start.col,E.selection.start.row,R.col,R.row,E.replaceReference))},xe=re.useCallback(S=>{switch(se.current=!1,E.currentMode){case ne.RANGE_SELECTION:if(S!=null&&S.shiftKey)return;g({type:"RANGE_SELECTION_TO_NAVIGATION"});break;case ne.CELL_REF_SELECTION:break;case ne.RANGE_REF_SELECTION:c!=null&&c.current&&E.selection&&(c.current.insertRangeReference(E.selection.start.col,E.selection.start.row,E.selection.end.col,E.selection.end.row,E.replaceReference),g({type:"UPDATE_ACTIVE_CELL",cell:E.selection.end}),c.current.focus());break}},[E.currentMode,E.activeCell,E.selection,E.replaceReference,g,c]),Ue=(S,v)=>{const R={col:S,row:v},d=`${S}${v}`,C=r[d]||{};g({type:"UPDATE_ACTIVE_CELL",cell:R});const U=(C.isFormula,C.rawValue||"");g({type:"NAVIGATION_TO_EDITING",value:U}),c!=null&&c.current&&(c.current.focus(),setTimeout(()=>{const L=c.current;if(L){const q=U.length;L.selectionStart=q,L.selectionEnd=q}},0))},ue=(S,v,R)=>{S.preventDefault();const d=E.selection&&(E.selection.start.col!==E.selection.end.col||E.selection.start.row!==E.selection.end.row),C=`${v}${R}`,U=Nn(C);let L=null;d&&(L=ya(`${E.selection.start.col}${E.selection.start.row}`,`${E.selection.end.col}${E.selection.end.row}`)),z({x:S.clientX,y:S.clientY,cell:{col:v,row:R},isRange:d,hasName:U||L,name:U||L})},ie=()=>{z(null)},Z=()=>{K(!0),le(""),z(null)},J=()=>{b!=null&&b.name&&(bs(b.name),z(null))},B=()=>{if(b){let S=!1;if(b.isRange&&E.selection)S=As(k,`${E.selection.start.col}${E.selection.start.row}`,`${E.selection.end.col}${E.selection.end.row}`);else{const v=`${b.cell.col}${b.cell.row}`;S=qu(k,v)}S?(K(!1),O(""),le("")):le("Invalid name or name already exists")}};re.useEffect(()=>{const S=v=>xe(v);return window.addEventListener("mouseup",S),()=>{window.removeEventListener("mouseup",S)}},[xe]),re.useEffect(()=>{c!=null&&c.current},[c]);const A=re.useRef(null);return re.useEffect(()=>{if(E.activeCell&&A.current){const S=A.current.querySelectorAll("td[data-cell-id]"),v=`${E.activeCell.col}${E.activeCell.row}`,R=Array.from(S).find(d=>d.getAttribute("data-cell-id")===v);R&&A.current&&setTimeout(()=>{if(A.current)try{const d=A.current.getBoundingClientRect(),C=R.getBoundingClientRect(),U=A.current.querySelector("tr:first-child th:first-child");if(!U)return;const q=U.getBoundingClientRect().width,Q=C.left>=d.left+q&&C.right<=d.right,W=C.top>=d.top&&C.bottom<=d.bottom;if(Q&&W)return;R.scrollIntoView({block:"nearest",inline:"nearest",behavior:"auto"}),!Q&&C.left<d.left+q&&(A.current.scrollLeft=Math.max(0,A.current.scrollLeft-(q-(C.left-d.left))))}catch(d){console.error("Error during scroll adjustment:",d)}},10)}},[E.activeCell]),N.jsxs("div",{className:"flex flex-col w-full h-full",children:[N.jsxs("div",{ref:A,className:"grid-container relative w-full h-full overflow-auto",children:[N.jsxs("table",{className:"border-collapse w-full bg-gray-800",children:[N.jsx("thead",{className:"sticky top-0 z-10",children:N.jsxs("tr",{children:[N.jsx("th",{className:"border border-gray-600 bg-gray-700 w-8 h-6 sticky left-0 z-20"}),T.map(S=>N.jsx("th",{className:"border border-gray-600 bg-gray-700 min-w-[60px] h-6 text-xs font-medium text-center text-purple-300",children:S},S)),y<100&&N.jsx("th",{className:"border border-gray-600 bg-gray-700 w-8 h-6 text-xs font-medium text-center text-purple-300 cursor-pointer hover:bg-gray-600",onClick:te,children:"+"})]})}),N.jsx("tbody",{children:X.map(S=>N.jsxs("tr",{children:[N.jsx("td",{className:"border border-gray-600 bg-gray-700 text-xs font-medium text-center h-7 text-purple-300 sticky left-0 z-10",children:S}),T.map(v=>N.jsx(Tp,{col:v,row:S,data:r,onContextMenu:R=>ue(R,v,S),onClick:R=>ye(v,S,R),onMouseDown:R=>pe(v,S,R),onMouseEnter:()=>me(v,S),onDoubleClick:()=>Ue(v,S),defaultFormat:i},`${v}${S}`))]},S))})]}),b&&N.jsx("div",{className:"absolute bg-gray-800 border border-gray-600 rounded-md shadow-lg z-50 py-1",style:{top:`${b.y}px`,left:`${b.x}px`},onClick:S=>S.stopPropagation(),children:b.hasName?N.jsxs("button",{className:"w-full block px-4 py-1 text-left text-sm hover:bg-gray-700 text-white",onClick:J,children:["Delete Name: ",b.name]}):N.jsx("button",{className:"w-full block px-4 py-1 text-left text-sm hover:bg-gray-700 text-white",onClick:Z,children:b.isRange?"Create Named Range":"Create Named Cell"})}),F&&N.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:N.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded-md shadow-lg p-4 w-72",onClick:S=>S.stopPropagation(),children:[N.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:b!=null&&b.isRange?"Create Named Range":"Create Named Cell"}),N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Name"}),N.jsx("input",{type:"text",value:k,onChange:S=>O(S.target.value),className:"w-full px-2 py-1 bg-gray-700 border border-gray-600 rounded text-gray-200 focus:outline-none focus:border-purple-500",placeholder:"Enter name"}),ee&&N.jsx("p",{className:"text-red-500 text-xs mt-1",children:ee})]}),N.jsxs("div",{className:"flex justify-end space-x-2",children:[N.jsx("button",{className:"px-3 py-1 bg-gray-700 rounded-md text-gray-300 hover:bg-gray-600",onClick:()=>{K(!1),O(""),le("")},children:"Cancel"}),N.jsx("button",{className:"px-3 py-1 bg-purple-700 rounded-md text-white hover:bg-purple-800",onClick:B,children:"Create"})]})]})})]}),(b||F)&&N.jsx("div",{className:"fixed inset-0 bg-transparent z-40",onClick:ie})]})},Sp=re.forwardRef(({data:r,setData:s},c)=>{const{state:i,dispatch:y}=ol(),{settings:h}=PE(),E=re.useRef(null),g=re.useRef(null),[m,T]=re.useState(!1),[D,b]=re.useState(""),[z,F]=re.useState(!1),K=re.useCallback(()=>{if(!E.current||!i.formulaValue)return;const A=document.activeElement;E.current.focus(),E.current.setSelectionRange(0,i.formulaValue.length),A&&A!==E.current&&A.focus()},[E,i.formulaValue]);re.useEffect(()=>{if(i.activeCell&&i.currentMode!==ne.EDITING&&i.currentMode!==ne.TEXT_SELECTION&&i.currentMode!==ne.CELL_REF_SELECTION&&i.currentMode!==ne.RANGE_REF_SELECTION){const A=`${i.activeCell.col}${i.activeCell.row}`,S=r[A]||{},v=(S.isFormula,S.canonicalValue||"");v!==i.formulaValue?(y({type:"UPDATE_FORMULA_VALUE",value:v}),setTimeout(K,0)):i.currentMode===ne.NAVIGATION&&K()}},[i.activeCell,i.currentMode,r,y,i.formulaValue,K]);const k=A=>{const S=A.target.value;y({type:"UPDATE_FORMULA_VALUE",value:S}),E.current&&y({type:"UPDATE_CURSOR_POSITION",position:E.current.selectionStart})},O=A=>{if(A.key==="Tab"||A.key==="Enter"){A.preventDefault();return}},ee=A=>{const S=A.target,v=S.selectionStart,R=S.selectionEnd;if(y({type:"UPDATE_CURSOR_POSITION",position:R}),v!==R){const d={start:v,end:R};y({type:"UPDATE_TEXT_SELECTION",range:d}),i.currentMode===ne.EDITING&&y({type:"EDITING_TO_TEXT_SELECTION",range:d})}else i.currentMode===ne.TEXT_SELECTION&&y({type:"TEXT_SELECTION_TO_EDITING",cursorPosition:v})},le=A=>{switch(i.currentMode){case ne.NAVIGATION:if(i.activeCell){const S=`${i.activeCell.col}${i.activeCell.row}`,v=r[S]||{},R=(v.isFormula,v.canonicalValue||"");y({type:"NAVIGATION_TO_EDITING",value:R}),setTimeout(()=>{E.current&&E.current.setSelectionRange(0,R.length)},0)}break;case ne.CELL_REF_SELECTION:case ne.RANGE_REF_SELECTION:y({type:i.currentMode===ne.CELL_REF_SELECTION?"CELL_REF_SELECTION_TO_EDITING":"RANGE_REF_SELECTION_TO_EDITING",acceptReference:!0});break;case ne.RANGE_SELECTION:y({type:"RANGE_SELECTION_TO_EDITING"});break}},X=re.useRef(null),se=(A,S,v=!1)=>{const R=typeof A=="string"&&typeof S=="number"?`${A}${S}`:A,C=Nn(R)||R,U=i.lastCursorPosition,L=i.formulaValue;let q,Q;if(v&&X.current){const{start:W,end:Ve}=X.current;q=L.substring(0,W)+C+L.substring(Ve),Q=W+C.length}else q=L.substring(0,U)+C+L.substring(U),Q=U+C.length;X.current={start:v&&X.current?X.current.start:U,end:Q},y({type:"UPDATE_FORMULA_VALUE",value:q}),y({type:"UPDATE_CURSOR_POSITION",position:Q}),E.current&&(E.current.focus(),E.current.selectionStart=Q,E.current.selectionEnd=Q)},te=(A,S,v,R)=>{const d=A.charCodeAt(0),C=v.charCodeAt(0),U=d<=C?A:v,L=Math.min(S,R),q=d<=C?v:A,Q=Math.max(S,R);return{startCol:U,startRow:L,endCol:q,endRow:Q}},ye=(A,S,v,R,d=!0)=>{const C=te(A,S,v,R),U=`${C.startCol}${C.startRow}`,L=`${C.endCol}${C.endRow}`,Q=ya(U,L)||`${U}:${L}`;se(Q,null,d)},pe=A=>{const S=i.lastCursorPosition,v=i.formulaValue,R=v.substring(0,S)+A+v.substring(S);if(y({type:"UPDATE_FORMULA_VALUE",value:R}),y({type:"UPDATE_CURSOR_POSITION",position:S+1}),E.current){const d=S+1;E.current.focus(),E.current.selectionStart=d,E.current.selectionEnd=d}},me=()=>{const A=i.editingCell||i.activeCell;if(A&&A.col&&A.row){const S=`${A.col}${A.row}`,v=r[S],R=v?fp(v,i.formulaValue,(h==null?void 0:h.dateInputFormat)||"US"):QE(i.formulaValue,(h==null?void 0:h.dateInputFormat)||"US"),d={...r,[S]:R};s(d)}},xe=()=>{if(!i.activeCell)return;if(Jl(i),!i.selection){const mt=`${i.activeCell.col}${i.activeCell.row}`,Re=Nn(mt);b(Re||""),T(!0),F(!1);return}const A=mt=>{let Re=0;for(let Fe=0;Fe<mt.length;Fe++)Re=Re*26+(mt.charCodeAt(Fe)-65+1);return Re-1},S=i.selection.start.col,v=i.selection.start.row,R=i.selection.end.col,d=i.selection.end.row,C=A(S),U=A(R),L=C<=U?S:R,q=Math.min(v,d),Q=C<=U?R:S,W=Math.max(v,d),Ve=`${L}${q}`,Me=`${Q}${W}`,lt=ya(Ve,Me);b(lt||""),T(!0),F(!1)},Ue=()=>{if(!i.activeCell)return;const A=Jl(i),S=i.selection?`${i.selection.start.col}${i.selection.start.row}:${i.selection.end.col}${i.selection.end.row}`:`${i.activeCell.col}${i.activeCell.row}`;if(A!==S){const v=A;if(Iu(S)){b(""),setTimeout(()=>b(Jl(i)),0),ue(v,S);const d={...r};s(d)}}},ue=(A,S)=>{if(!A||!S)return;const v=U=>{if(U.includes(":")){const[L,q]=U.split(":");return`${v(L)}:${v(q)}`}else{const L=U.match(/([A-Z]+)(\d+)/);if(!L)return U;const[q,Q,W]=L;return`$${Q}$${W}`}},R=v(S);let d={...r},C=!1;Object.entries(r).forEach(([U,L])=>{if(L&&L.isFormula&&L.rawValue){const q=L.rawValue,Q=A.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),W=new RegExp(`\\b${Q}\\b`,"g");if(W.test(q)){console.log(`[FormulaBar] Replacing ${A} with ${R} in ${U}`);const Ve=q.replace(W,R);d[U]={...L,rawValue:Ve,formulaValue:Ve},C=!0}}}),C&&s(d)},ie=A=>{b(A.target.value),F(!1)},Z=A=>{if(!i.activeCell)return;if(!A.trim())return!1;const S=tt(A);if(!be.validateName(S))return console.log(`Invalid name format: ${S}`),!1;if(be.nameExists(S))return console.log(`Name already exists: ${S}`),!1;let v=!1;if(i.selection)if(i.selection.start.col!==i.selection.end.col||i.selection.start.row!==i.selection.end.row){const R=P=>{let ge=0;for(let de=0;de<P.length;de++)ge=ge*26+(P.charCodeAt(de)-65+1);return ge-1},d=i.selection.start.col,C=i.selection.start.row,U=i.selection.end.col,L=i.selection.end.row,q=R(d),Q=R(U),W=q<=Q?d:U,Ve=Math.min(C,L),Me=q<=Q?U:d,lt=Math.max(C,L),mt=`${W}${Ve}`,Re=`${Me}${lt}`,Fe=ya(mt,Re);Fe&&Fe!==A&&Iu(`${mt}:${Re}`),v=As(S,mt,Re)}else{const R=`${i.selection.start.col}${i.selection.start.row}`,d=Nn(R);d&&d!==A&&Iu(R),v=qu(S,R)}else{const R=`${i.activeCell.col}${i.activeCell.row}`,d=Nn(R);d&&d!==A&&Iu(R),v=qu(S,R)}if(v){const R={...r};s(R)}else console.error("FormulaBar: Failed to create named range/cell for",S);return v},J=()=>{D!==Jl(i)&&(Z(D)||F(!0)),T(!1)},B=A=>{A.key==="Enter"?(D!==Jl(i)&&(Z(D)||F(!0)),T(!1),A.target.blur()):A.key==="Escape"&&(T(!1),A.target.blur())};return c&&(c.current={focus:()=>{E.current&&E.current.focus()},commitValue:me,insertCellReference:se,replaceCellReference:(A,S)=>se(A,S,!0),insertRangeReference:ye,appendCharacter:pe,isEditingFormula:()=>i.isEditingFormula,selectFormulaText:K,enterEditMode:()=>{},enterCellRefSelectionMode:()=>{}}),N.jsxs("div",{className:"flex items-center px-2 py-1 border-b border-gray-600 bg-gray-800 text-gray-300",children:[N.jsx("div",{className:"flex items-center",children:m?N.jsx("input",{ref:g,type:"text",value:D,onChange:ie,onBlur:J,onKeyDown:B,autoFocus:!0,className:`mr-2 text-sm font-semibold min-w-16 px-2 py-1 rounded ${z?"bg-red-900 border border-red-500 text-white":"bg-gray-700 border border-gray-600 text-gray-200"} focus:outline-none focus:border-purple-500`,title:z?"Invalid name format (must start with letter/underscore, only letters/numbers/underscores, 1-255 chars, not reserved/cell ref) or name already exists":"Enter a name for this cell or range",placeholder:"Enter name"}):N.jsxs(N.Fragment,{children:[N.jsx("div",{className:"mr-2 text-sm font-semibold min-w-16 px-2 py-1 hover:bg-gray-700 rounded cursor-pointer text-gray-300",onClick:xe,title:"Click to create or edit named range",children:Jl(i)}),i.activeCell&&Jl(i)!==`${i.activeCell.col}${i.activeCell.row}`&&!i.selection&&N.jsx("button",{onClick:Ue,className:"text-gray-400 hover:text-red-400 px-1",title:"Delete named range",children:""}),i.selection&&Jl(i)!==`${i.selection.start.col}${i.selection.start.row}:${i.selection.end.col}${i.selection.end.row}`&&N.jsx("button",{onClick:Ue,className:"text-gray-400 hover:text-red-400 px-1",title:"Delete named range",children:""})]})}),N.jsx("input",{ref:E,type:"text",id:"formula-bar-input",value:i.formulaValue,onChange:k,onKeyDown:O,onSelect:ee,onMouseDown:le,className:"formula-bar-input flex-grow px-2 py-1 bg-gray-700 border border-gray-600 rounded text-gray-200 focus:outline-none focus:border-purple-500",placeholder:"Enter formula or value",disabled:!i.activeCell})]})}),Np=({onAction:r,clipboard:s,showInputsOutputs:c,toggleInputsOutputs:i,hasSelection:y=!1,hasCellContent:h=!1})=>N.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 bg-gray-800 border-b border-gray-700",children:[N.jsxs("div",{className:"flex items-center gap-0.5",children:[N.jsx("button",{onClick:()=>r("copy"),className:"p-1 hover:bg-gray-700 rounded-md",title:"Copy",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5H6a2 2 0 00-2 2v11a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})})}),N.jsx("button",{onClick:()=>r("cut"),disabled:!y||!h,className:`p-1 rounded-md ${y&&h?"hover:bg-gray-700":"opacity-50 cursor-not-allowed"}`,title:"Cut",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.121 14.121L19 19m-7-7l7-7m-7 7l-2.879 2.879M12 12L9.121 9.121m0 5.758a3 3 0 1 1-4.243-4.243 3 3 0 0 1 4.243 4.243zm0-5.758a3 3 0 1 0-4.243-4.243 3 3 0 0 0 4.243 4.243z"})})}),N.jsx("button",{onClick:()=>r("paste"),disabled:!s,className:`p-1 rounded-md ${s?"hover:bg-gray-700":"opacity-50 cursor-not-allowed"}`,title:"Paste",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),s&&s.source==="cut"&&N.jsxs("button",{onClick:()=>r("cancelCut"),className:"p-1 px-2 bg-red-700 hover:bg-red-800 rounded-md flex items-center gap-1",title:"Cancel Cut Operation",id:"cancel-cut-button",children:[N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),N.jsx("span",{className:"text-xs font-bold",children:"Cancel Cut"})]})]}),N.jsxs("div",{className:"flex items-center gap-0.5 border-l border-gray-700 pl-1",children:[N.jsx("button",{onClick:()=>r("alignLeft"),className:"p-1 hover:bg-gray-700 rounded-md",title:"Align left",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h10M4 18h16"})})}),N.jsx("button",{onClick:()=>r("alignCenter"),className:"p-1 hover:bg-gray-700 rounded-md",title:"Align center",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M7 12h10M4 18h16"})})}),N.jsx("button",{onClick:()=>r("alignRight"),className:"p-1 hover:bg-gray-700 rounded-md",title:"Align right",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M10 12h10M4 18h16"})})})]}),N.jsxs("div",{className:"flex items-center gap-0.5 border-l border-gray-700 pl-1",children:[N.jsx("button",{onClick:()=>r("fontSizeUp"),className:"p-1 hover:bg-gray-700 rounded-md",title:"Increase font size",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),N.jsx("button",{onClick:()=>r("fontSizeDown"),className:"p-1 hover:bg-gray-700 rounded-md",title:"Decrease font size",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})})]}),N.jsxs("div",{className:"flex items-center gap-0.5 border-l border-gray-700 pl-1",children:[N.jsx("button",{onClick:()=>r("bold"),className:"p-1 hover:bg-gray-700 rounded-md",title:"Bold",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),N.jsx("button",{onClick:()=>r("italic"),className:"p-1 hover:bg-gray-700 rounded-md",title:"Italic",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})})})]}),N.jsxs("div",{className:"flex items-center gap-0.5 border-l border-gray-700 pl-1",children:[N.jsx("button",{onClick:()=>r("numberFormat"),className:"p-1 hover:bg-gray-700 rounded-md",title:"Number format",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 20l4-16m2 16l4-16M6 9h14M4 15h14"})})}),N.jsx("button",{onClick:()=>r("clearFormatting"),className:"p-1 hover:bg-gray-700 rounded-md",title:"Clear formatting",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),N.jsxs("div",{className:"flex items-center gap-0.5 border-l border-gray-700 pl-1",children:[N.jsx("button",{onClick:()=>r("undo"),className:"p-1 hover:bg-gray-700 rounded-md",title:"Undo",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),N.jsx("button",{onClick:()=>r("redo"),className:"p-1 hover:bg-gray-700 rounded-md",title:"Redo",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 10H11a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"})})})]}),N.jsx("div",{className:"flex items-center gap-0.5 border-l border-gray-700 pl-1",children:N.jsx("button",{onClick:i,className:`p-1 ${c?"bg-purple-700":"hover:bg-gray-700"} rounded-md`,title:"Toggle Inputs & Output",children:N.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"}),N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16l8-8"})]})})})]}),De={ISO:"YYYY-MM-DD",US_SHORT:"MM/DD/YYYY",EU_SHORT:"DD/MM/YYYY",US_LONG:"MMMM DD, YYYY",EU_LONG:"DD MMMM, YYYY"},rl={US_24H:"MM/DD/YYYY H:mm",EU_24H:"DD/MM/YYYY H:mm",ISO_SHORT:"YYYY-MM-DD HH:mm",ISO:"YYYY-MM-DD HH:mm:ss",US_12H:"MM/DD/YYYY h:mm A",EU_12H:"DD/MM/YYYY h:mm A",ISO_12H:"YYYY-MM-DD h:mm A",US:"MM/DD/YYYY HH:mm:ss",EU:"DD/MM/YYYY HH:mm:ss"},yr={TIME_24H:"HH:mm:ss",TIME_24H_SHORT:"HH:mm",TIME_12H:"hh:mm A",TIME_12H_WITH_SECONDS:"hh:mm:ss A"},LE={US:De.US_SHORT,"CA-en":De.US_SHORT,GB:De.EU_SHORT,AU:De.EU_SHORT,NZ:De.EU_SHORT,IE:De.EU_SHORT,IN:De.EU_SHORT,ZA:De.EU_SHORT,DE:De.EU_SHORT,FR:De.EU_SHORT,IT:De.EU_SHORT,ES:De.EU_SHORT,PT:De.EU_SHORT,NL:De.EU_SHORT,BE:De.EU_SHORT,DK:De.EU_SHORT,NO:De.EU_SHORT,SE:De.EU_SHORT,FI:De.EU_SHORT,RU:De.EU_SHORT,"CA-fr":De.EU_SHORT,JP:De.ISO,KR:De.ISO,CN:De.ISO,TW:De.ISO,HK:De.ISO};let Hu=null,Wl=null;class Ap{getDateFormatOptions(){return{...De}}getDateTimeFormatOptions(){return{...rl}}getTimeFormatOptions(){return{...yr}}getUserLocale(){if(Hu)return Hu;try{const s=navigator.language||navigator.userLanguage||"en-US";return Hu=s,s}catch(s){return console.error("[LocaleService] Failed to detect user locale:",s),"en-US"}}getLocaleRegion(){const c=this.getUserLocale().split("-");return c.length>1?c[1].toUpperCase():c[0].toLowerCase()}getCanadianLocaleVariant(){return this.getUserLocale().toLowerCase().startsWith("fr")?"CA-fr":"CA-en"}getPreferredDateFormat(){if(Wl)return Wl;try{const s=this.getLocaleRegion();if(s==="CA"){const i=this.getCanadianLocaleVariant();return Wl=LE[i]||De.US_SHORT,Wl}const c=LE[s];return c?(Wl=c,c):(Wl=De.ISO,De.ISO)}catch(s){return console.error("[LocaleService] Failed to determine preferred date format:",s),Wl=De.ISO,De.ISO}}getPreferredDateTimeFormat(s=!1){try{const c=this.getLocaleRegion(),i=this.uses12HourTime();return["JP","KR","CN","TW","HK"].includes(c)?s?rl.ISO_SHORT:rl.ISO:["US","CA"].includes(c)?i?rl.US_12H:s?rl.US_SHORT:rl.US:i?rl.EU_12H:s?rl.EU_SHORT:rl.EU}catch(c){return console.error("[LocaleService] Failed to determine preferred datetime format:",c),rl.ISO}}clearCache(){Hu=null,Wl=null}uses12HourTime(){try{const s=["US","CA","UK","AU","NZ","IN","PH","PK","EG","SA","AE"],c=this.getLocaleRegion();return s.includes(c)}catch(s){return console.error("[LocaleService] Failed to determine time format preference:",s),!1}}getPreferredTimeFormat(s=!0){return this.uses12HourTime()?s?yr.TIME_12H_WITH_SECONDS:yr.TIME_12H:s?yr.TIME_24H:yr.TIME_24H_SHORT}getDecimalSeparator(){try{const s=this.getUserLocale();return 1.1.toLocaleString(s).substring(1,2)}catch(s){return console.error("[LocaleService] Failed to determine decimal separator:",s),"."}}getThousandsSeparator(){try{const s=this.getUserLocale();return 1e3.toLocaleString(s).substring(1,2)}catch(s){return console.error("[LocaleService] Failed to determine thousands separator:",s),","}}getCurrencySymbol(){try{const s=this.getUserLocale();return new Intl.NumberFormat(s,{style:"currency",currency:"USD"}).format(0).replace(/[0-9.,\s]/g,"")||"$"}catch(s){return console.error("[LocaleService] Failed to determine currency symbol:",s),"$"}}}const IE=new Ap,Rn=en(),bp=({onApply:r,currentFormat:s={},onDefaultFormatApply:c,data:i={},defaultFormat:y={}})=>{const{isOpen:h,activeTab:E,formatType:g,options:m,showTypeWarning:T,willConvertDataTypes:D,sourceType:b,targetType:z,closeFormatDialog:F,setFormatType:K,setFormatOptions:k,setFormatDialogTab:O,setTypeWarning:ee}=WE(),le=JE(),{settings:X,updateSettings:se}=PE(),te=re.useMemo(()=>le?ye(le):[],[le]);function ye(ue){if(!ue||!ue.start||!ue.end)return[];try{const ie=C=>{let U=0;for(let L=0;L<C.length;L++)U=U*26+(C.charCodeAt(L)-65+1);return U-1},Z=C=>{let U="";do U=String.fromCharCode(65+C%26)+U,C=Math.floor(C/26)-1;while(C>=0);return U},J=ie(ue.start.col),B=ie(ue.end.col),A=Math.min(J,B),S=Math.max(J,B),v=Math.min(ue.start.row,ue.end.row),R=Math.max(ue.start.row,ue.end.row),d=[];for(let C=A;C<=S;C++){const U=Z(C);for(let L=v;L<=R;L++)d.push({col:U,row:L})}return d}catch(ie){return console.error("Error getting selected cells array:",ie),[]}}const pe=re.useCallback(()=>{try{let ue=null;if(g===Ot.DATE||g===Ot.TIME?ue=o.DATE:(g===Ot.NUMBER||g===Ot.CURRENCY||g===Ot.PERCENTAGE)&&(ue=o.NUMBER),!ue){ee(!1,!1,null,null);return}let ie=!0,Z=!1,J=null;for(const B of te){const A=`${B.col}${B.row}`,S=i[A];Tr(S)||(Z=!0,J||(J=S.type),S.type!==ue&&(ie=!1))}Z&&!ie?ee(!0,!0,J,ue):ee(!1,!1,null,null)}catch(ue){console.error("Error checking data type mismatch:",ue),ee(!1,!1,null,null)}},[te,i,ee,g]);if(re.useEffect(()=>{h&&(O("cell"),ee(!1,!1,null,null))},[h,O,ee]),re.useEffect(()=>{g==="NUMBER"&&!m.currentSubCategory&&k({currentSubCategory:"general",subcategories:{general:{},number:{decimalPlaces:2,thousandsSeparator:","},currency:{decimalPlaces:2,thousandsSeparator:",",symbol:"$"},percentage:{decimalPlaces:2},scientific:{decimalPlaces:2},timeDuration:{}}})},[g,m.currentSubCategory,k]),re.useEffect(()=>{E==="cell"&&te.length>0&&pe()},[g,te,i,E,pe]),!h)return null;const me=()=>{try{let ue=null;g==="NUMBER"?m.currentSubCategory?ue={NUMBER:m}:(console.warn("[FormatDialog] Unexpected flat structure in handleApply"),ue={NUMBER:m}):g==="DATE"?ue={DATE:m}:g==="DATETIME"&&(ue={DATETIME:m}),E==="cell"?r(ue):c(ue),F()}catch(ue){console.error("Error applying format:",ue),F()}},xe=()=>{var ue,ie,Z;try{switch(g){case"NUMBER":const J=(m==null?void 0:m.currentSubCategory)||"general",B=((ue=m==null?void 0:m.subcategories)==null?void 0:ue[J])||{};return N.jsxs("div",{children:[N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{htmlFor:"number-subcategory",className:"block text-sm font-medium text-gray-300 mb-2",children:"Number Format"}),N.jsxs("select",{id:"number-subcategory",value:J,onChange:v=>{const R=v.target.value;if((m==null?void 0:m.currentSubCategory)!==void 0){const d=op(m,R);k(d)}else{const d=fa(Rn.NUMBER,R,m);k(d)}},className:"w-full p-2 bg-gray-700 text-gray-100 rounded-md",children:[N.jsx("option",{value:"general",children:"General"}),N.jsx("option",{value:"number",children:"Number"}),N.jsx("option",{value:"currency",children:"Currency"}),N.jsx("option",{value:"percentage",children:"Percentage"}),N.jsx("option",{value:"scientific",children:"Scientific"}),N.jsx("option",{value:"timeDuration",children:"Time Duration"})]})]}),J==="currency"&&N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{htmlFor:"currency-symbol",className:"block text-sm font-medium text-gray-300 mb-2",children:"Currency Symbol"}),N.jsx("input",{id:"currency-symbol",type:"text",value:(B==null?void 0:B.symbol)??Rn.NUMBER.subcategories.currency.symbol,onChange:v=>{const R=fa(m,J,{symbol:v.target.value});k(R)},className:"w-full p-2 bg-gray-700 text-gray-100 rounded-md"})]}),J==="timeDuration"&&N.jsxs("div",{className:"mb-4 p-3 bg-gray-600/30 rounded-md",children:[N.jsx("p",{className:"text-xs text-gray-300 mb-1",children:"Time Duration Format"}),N.jsx("p",{className:"text-xs text-gray-400",children:'Displays numeric values as time durations (e.g., 1.5  "1 day 12 hours").'})]}),J!=="timeDuration"&&J!=="general"&&N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{htmlFor:"decimal-places",className:"block text-sm font-medium text-gray-300 mb-2",children:"Decimal Places"}),N.jsx("input",{id:"decimal-places",type:"text",value:(B==null?void 0:B.decimalPlaces)??((ie=Rn.NUMBER.subcategories[J])==null?void 0:ie.decimalPlaces)??2,onChange:v=>{const R=v.target.value;if(R===""){const U=fa(m,J,{decimalPlaces:0});k(U);return}if(!R.match(/^\d+$/))return;const d=parseInt(R);if(d<0||d>10)return;const C=fa(m,J,{decimalPlaces:d});k(C)},onBlur:v=>{if(v.target.value===""){const R=fa(m,J,{decimalPlaces:0});k(R)}},placeholder:"0-10",className:"w-full p-2 bg-gray-700 text-gray-100 rounded-md"})]}),(J==="number"||J==="currency")&&N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{htmlFor:"thousands-separator",className:"block text-sm font-medium text-gray-300 mb-2",children:"Thousands Separator"}),N.jsx("input",{id:"thousands-separator",type:"text",value:(B==null?void 0:B.thousandsSeparator)??((Z=Rn.NUMBER.subcategories[J])==null?void 0:Z.thousandsSeparator)??",",onChange:v=>{const R=fa(m,J,{thousandsSeparator:v.target.value});k(R)},className:"w-full p-2 bg-gray-700 text-gray-100 rounded-md"})]})]});case"DATE":return N.jsxs("div",{children:[N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{htmlFor:"date-format",className:"block text-sm font-medium text-gray-300 mb-2",children:"Date Format"}),N.jsxs("select",{id:"date-format",value:(m==null?void 0:m.displayFormat)??Rn.DATE.displayFormat,onChange:v=>k({...m,displayFormat:v.target.value}),className:"w-full p-2 bg-gray-700 text-gray-100 rounded-md",children:[N.jsxs("optgroup",{label:"Standard Formats",children:[N.jsx("option",{value:cl.US,children:"MM/DD/YYYY (US)"}),N.jsx("option",{value:cl.EU,children:"DD/MM/YYYY (EU)"}),N.jsx("option",{value:cl.ISO,children:"YYYY-MM-DD (ISO)"})]}),N.jsxs("optgroup",{label:"Short Year Formats",children:[N.jsx("option",{value:cl.SHORT_YEAR_US,children:"MM/DD/YY (US)"}),N.jsx("option",{value:cl.SHORT_YEAR_EU,children:"DD/MM/YY (EU)"})]})]})]}),E==="default"&&N.jsxs("div",{className:"mb-4 p-3 bg-blue-800/20 border border-blue-600 rounded-md",children:[N.jsx("p",{className:"text-blue-300 text-sm font-medium mb-2",children:"Date Input Interpretation"}),N.jsx("p",{className:"text-blue-200 text-xs mb-3",children:'This setting affects how ambiguous date inputs like "10/15/2023" are interpreted.'}),N.jsxs("div",{className:"space-y-2",children:[N.jsxs("label",{className:"flex items-center text-sm text-gray-300",children:[N.jsx("input",{type:"radio",name:"dateInputFormat",value:"US",checked:(X==null?void 0:X.dateInputFormat)==="US",onChange:v=>{v.target.checked&&se({dateInputFormat:"US"})},className:"mr-2 h-4 w-4 text-purple-600 focus:ring-purple-700 border-gray-600"}),'US Format (MM/DD/YYYY) - "10/15/2023" means October 15, 2023']}),N.jsxs("label",{className:"flex items-center text-sm text-gray-300",children:[N.jsx("input",{type:"radio",name:"dateInputFormat",value:"EU",checked:(X==null?void 0:X.dateInputFormat)==="EU",onChange:v=>{v.target.checked&&se({dateInputFormat:"EU"})},className:"mr-2 h-4 w-4 text-purple-600 focus:ring-purple-700 border-gray-600"}),'EU Format (DD/MM/YYYY) - "10/15/2023" means 15th of October, 2023']})]})]}),N.jsxs("div",{className:"mb-4 p-3 bg-gray-600/30 rounded-md",children:[N.jsx("p",{className:"text-xs text-gray-300 mb-1",children:"Date Format Information"}),N.jsx("p",{className:"text-xs text-gray-400",children:"Date format affects display only. Time is set to midnight (00:00:00)."})]})]});case"DATETIME":const A=IE.getDateTimeFormatOptions(),S=IE.getTimeFormatOptions();return N.jsxs("div",{children:[N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{htmlFor:"datetime-display",className:"block text-sm font-medium text-gray-300 mb-2",children:"Display Format"}),N.jsxs("select",{id:"datetime-display",value:(m==null?void 0:m.displayType)||"datetime",onChange:v=>k({...m,displayType:v.target.value}),className:"w-full p-2 bg-gray-700 text-gray-100 rounded-md",children:[N.jsx("option",{value:"datetime",children:"Date & Time"}),N.jsx("option",{value:"timeOnly",children:"Time Only"})]})]}),(m==null?void 0:m.displayType)==="timeOnly"?N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{htmlFor:"time-format",className:"block text-sm font-medium text-gray-300 mb-2",children:"Time Format"}),N.jsxs("select",{id:"time-format",value:(m==null?void 0:m.displayFormat)??Rn.DATETIME.displayFormat,onChange:v=>k({...m,displayFormat:v.target.value}),className:"w-full p-2 bg-gray-700 text-gray-100 rounded-md",children:[N.jsxs("optgroup",{label:"24-Hour Format",children:[N.jsx("option",{value:S.TIME_24H,children:"HH:mm:ss (24-hour with seconds)"}),N.jsx("option",{value:S.TIME_24H_SHORT,children:"HH:mm (24-hour)"})]}),N.jsxs("optgroup",{label:"12-Hour Format",children:[N.jsx("option",{value:S.TIME_12H_WITH_SECONDS,children:"hh:mm:ss A (12-hour with seconds)"}),N.jsx("option",{value:S.TIME_12H,children:"hh:mm A (12-hour)"})]})]})]}):N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{htmlFor:"datetime-format",className:"block text-sm font-medium text-gray-300 mb-2",children:"Date & Time Format"}),N.jsxs("select",{id:"datetime-format",value:(m==null?void 0:m.displayFormat)??Rn.DATETIME.displayFormat,onChange:v=>k({...m,displayFormat:v.target.value}),className:"w-full p-2 bg-gray-700 text-gray-100 rounded-md",children:[N.jsxs("optgroup",{label:"24-Hour Formats",children:[N.jsx("option",{value:A.US_24H,children:"MM/DD/YYYY H:mm (US 24h)"}),N.jsx("option",{value:A.EU_24H,children:"DD/MM/YYYY H:mm (EU 24h)"}),N.jsx("option",{value:A.US,children:"MM/DD/YYYY HH:mm:ss (US)"}),N.jsx("option",{value:A.EU,children:"DD/MM/YYYY HH:mm:ss (EU)"}),N.jsx("option",{value:A.ISO_SHORT,children:"YYYY-MM-DD HH:mm (ISO Short)"}),N.jsx("option",{value:A.ISO,children:"YYYY-MM-DD HH:mm:ss (ISO 8601)"})]}),N.jsxs("optgroup",{label:"12-Hour Formats",children:[N.jsx("option",{value:A.US_12H,children:"MM/DD/YYYY h:mm A (US 12h)"}),N.jsx("option",{value:A.EU_12H,children:"DD/MM/YYYY h:mm A (EU 12h)"}),N.jsx("option",{value:A.ISO_12H,children:"YYYY-MM-DD h:mm A (ISO 12h)"})]})]})]}),N.jsxs("div",{className:"mb-4 p-3 bg-gray-600/30 rounded-md",children:[N.jsx("p",{className:"text-xs text-gray-300 mb-1",children:"DateTime Format Information"}),N.jsx("p",{className:"text-xs text-gray-400",children:(m==null?void 0:m.displayType)==="timeOnly"?"Time Only shows just the time portion of datetime values.":"Date & Time format shows both date and time information."})]})]});default:return null}}catch(J){return console.error("Error rendering format options:",J),N.jsx("div",{className:"p-3 bg-red-900 text-red-100 rounded-md",children:"Error rendering format options."})}},Ue=ue=>{try{if(!ue)return"unknown";switch(ue){case o.NUMBER:return"number";case o.DATE:return"date";case o.DATETIME:return"datetime";case o.TEXT:return"text";default:return ue}}catch(ie){return console.error("Error getting format type name:",ie),"unknown"}};return N.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:N.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-96",children:[N.jsxs("div",{className:"flex border-b border-gray-700 mb-4",children:[N.jsx("button",{onClick:()=>O("cell"),className:`px-4 py-2 text-sm font-medium ${E==="cell"?"text-purple-400 border-b-2 border-purple-400":"text-gray-400 hover:text-gray-300"}`,children:"Cell Format"}),N.jsx("button",{onClick:()=>O("default"),className:`px-4 py-2 text-sm font-medium ${E==="default"?"text-purple-400 border-b-2 border-purple-400":"text-gray-400 hover:text-gray-300"}`,children:"Default Format"})]}),N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{htmlFor:"data-type",className:"block text-sm font-medium text-gray-300 mb-2",children:"Data Type"}),N.jsxs("select",{id:"data-type",value:g,onChange:ue=>K(ue.target.value,y),className:"w-full p-2 bg-gray-700 text-gray-100 rounded-md",children:[N.jsx("option",{value:"NUMBER",children:"Number"}),N.jsx("option",{value:"DATE",children:"Date"}),N.jsx("option",{value:"DATETIME",children:"DateTime"})]})]}),T&&E==="cell"&&N.jsxs("div",{className:"my-4 p-3 bg-blue-800/50 border border-blue-600 rounded-md",children:[N.jsx("p",{className:"text-blue-300 text-sm font-medium mb-1",children:"Format Information"}),N.jsxs("p",{className:"text-blue-100 text-xs mb-2",children:["Some selected cells contain ",Ue(b)," data, but this format is designed for ",Ue(z)," data. The format will be applied for display purposes only. To change a value's data type, you must re-enter the data."]})]}),xe(),N.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[N.jsx("button",{onClick:F,className:"px-4 py-2 text-gray-300 hover:text-white hover:bg-gray-700 rounded-md",children:"Cancel"}),N.jsx("button",{onClick:me,className:"px-4 py-2 bg-purple-600 text-white hover:bg-purple-700 rounded-md",children:E==="cell"?"Apply to Cell":"Set as Default"})]})]})})},Cp=({data:r,recalculate:s})=>{const{state:c}=ol(),[i,y]=re.useState([{id:1,name:"",value:"",type:o.NUMBER}]),[h,E]=re.useState(2),[g,m]=re.useState(null),[T,D]=re.useState(null),[b,z]=re.useState({}),[F,K]=re.useState(null),k=re.useRef([]);re.useEffect(()=>{k.current=k.current.slice(0,i.length)},[i]);const O=()=>{y([...i,{id:h,name:"",value:"",type:o.NUMBER}]),E(h+1)},ee=Z=>{const J=i.find(B=>B.id===Z);J&&J.name&&be.deregisterName(tt(J.name),Le.INPUT),y(i.filter(B=>B.id!==Z)),z(B=>{const A={...B};return delete A[Z],A})},le=(Z,J)=>{y(B=>B.map(A=>A.id===Z?{...A,name:J}:A))},X=()=>{if(T===null){D(null);return}y(Z=>Z.map(J=>{if(J.id!==T)return J;const B=J.prevRegisteredName||"",A=J.name,S=tt(B),v=tt(A);let R="",d=A;if(S!==v)if(B&&be.nameExists(S)&&be.deregisterName(S,Le.INPUT),v)if(v.length<1||v.length>255)R="Name must be between 1 and 255 characters";else if(!/^[A-Z_]/.test(v))R="Name must start with a letter or underscore";else if(!/^[A-Z_][A-Z0-9_]*$/.test(v))R="Name can only contain letters, numbers, and underscores";else if(/^[A-Z]{1,3}[1-9][0-9]{0,2}$/.test(v))R="Name cannot be a cell reference (e.g., A1, B12)";else if(!be.validateName(v))R="Invalid name format";else if(be.nameExists(v)&&S!==v)R="Name already exists or conflicts with another name";else{if(be.registerName(v,Le.INPUT)||be.nameExists(v)){const U=J.value;hs(v,U),s&&s()}J.prevRegisteredName=v,d=v}else console.error("InputsPanel: Failed to register input name",v);else if(v){const C=J.value;hs(v,C),s&&s()}return z(C=>({...C,[T]:R})),{...J,name:d}})),D(null)},se=(Z,J)=>{if(Z.key==="Enter"||Z.key==="Tab"){const B=Z.target.value,A=tt(B);if(be.validateName(A),Z.target.value=A,y(S=>S.map(v=>v.id===J?{...v,name:A}:v)),D(null),Z.target.blur(),Z.key==="Enter"){const S=Z.target.closest(".flex.items-center.gap-2");if(S){const v=S.querySelector('input[placeholder="Value"]');v?v.focus():console.warn("InputsPanel: Value input not found in current row during Enter navigation")}else console.warn("InputsPanel: Current row not found during Enter navigation");Z.preventDefault()}}else Z.key==="Escape"&&(D(null),Z.target.blur())},te=Z=>!isNaN(parseFloat(Z))&&isFinite(Z)?o.NUMBER:isNaN(Date.parse(Z))?o.TEXT:o.DATE,ye=(Z,J)=>{K(Z),y(i.map(B=>{if(B.id===Z){let A=te(J);return{...B,value:J,type:A}}return B}))},pe=Z=>{const J=i.find(B=>B.id===Z);if(!J)return!1;if(J.name){const B=tt(J.name),A=J.value;return be.nameExists(B)||be.registerName(B,Le.INPUT),hs(B,A),s&&s(),!0}return!1},me=Z=>{pe(Z),K(null)},xe=(Z,J)=>{if((Z.key==="Enter"||Z.key==="Tab")&&(pe(J),K(null),Z.key==="Enter")){Z.preventDefault();try{const B=i.findIndex(A=>A.id===J);if(B!==-1&&B<i.length-1){const A=document.querySelectorAll(".flex.items-center.gap-2");if(A.length>B+1){const v=A[B+1].querySelector('div[title="Click to edit input name"]');v&&v.click()}}else if(B===i.length-1){const A=document.querySelector("button.bg-green-600");A&&A.focus()}}catch(B){console.error("[InputsPanel][handleValueKeyDown] Error handling Enter key:",B)}}},Ue=Z=>{m(Z)},ue=(Z,J)=>{if(Z.preventDefault(),g===null||g===J)return;const B=i.findIndex(R=>R.id===g),A=i.findIndex(R=>R.id===J);if(B===-1||A===-1)return;const S=[...i],[v]=S.splice(B,1);S.splice(A,0,v),y(S)},ie=()=>{m(null)};return N.jsx("div",{className:"px-2 py-1 border-b border-gray-600 bg-gray-800 text-gray-300",children:N.jsxs("div",{className:"flex items-center gap-3",children:[N.jsx("span",{className:"text-sm font-semibold text-purple-300 mr-1",children:"Inputs:"}),N.jsxs("div",{className:"flex flex-wrap gap-3 flex-grow items-center",children:[i.map((Z,J)=>N.jsxs("div",{className:"flex items-center gap-2 cursor-move",draggable:!0,onDragStart:()=>Ue(Z.id),onDragOver:B=>ue(B,Z.id),onDragEnd:ie,children:[N.jsx("div",{className:"min-w-0 w-auto",children:T===Z.id?N.jsx("input",{type:"text",value:Z.name,onChange:B=>le(Z.id,B.target.value),onBlur:X,onKeyDown:B=>se(B,Z.id),autoFocus:!0,"data-input-name-id":Z.id,className:`bg-transparent px-2 py-0.5 rounded border w-full text-sm font-semibold focus:outline-none focus:border-purple-500 ${b[Z.id]?"border-red-500":"border-gray-600"}`,placeholder:"Add name",ref:B=>{const A=i.findIndex(S=>S.id===Z.id);k.current[A]=B}}):N.jsxs("div",{className:"text-sm font-semibold px-2 py-0.5 hover:bg-gray-700 rounded cursor-pointer text-gray-200 whitespace-nowrap",onClick:()=>D(Z.id),title:"Click to edit input name",children:[Z.name||N.jsx("span",{className:"text-gray-500",children:"Add name"}),b[Z.id]&&N.jsx("span",{className:"text-xs text-red-400 ml-2",children:b[Z.id]})]})}),N.jsx("div",{className:"w-28",children:N.jsx("input",{type:"text",value:Z.value,onChange:B=>ye(Z.id,B.target.value),onBlur:()=>me(Z.id),onKeyDown:B=>xe(B,Z.id),className:"bg-transparent px-2 py-0.5 rounded border border-gray-600 w-full text-sm",placeholder:"Value"})}),N.jsx("div",{className:"text-xs px-1 py-0.5 text-center text-gray-400",children:Z.type}),N.jsx("button",{onClick:()=>ee(Z.id),className:"text-red-400 hover:text-red-300",title:"Remove input",children:""})]},Z.id)),N.jsx("button",{className:"bg-green-600 hover:bg-green-700 px-3 py-1 rounded text-white text-sm",onClick:O,children:"+ Input"})]})]})})},Mp=({data:r})=>{const{state:s}=ol(),[c,i]=re.useState({cellReference:"",result:"",error:""});re.useEffect(()=>{if(c.cellReference)try{const h=r[c.cellReference];if(!h){i(E=>({...E,result:"",error:"Cell not found"}));return}i(E=>({...E,result:h.displayValue!==void 0?h.displayValue:"",error:""}))}catch{i(E=>({...E,result:"",error:Zt.UNKNOWN_ERROR}))}},[c.cellReference,r]);const y=h=>{i(E=>({...E,cellReference:h}))};return N.jsx("div",{className:"px-2 py-1 border-t border-gray-600 bg-gray-800 text-gray-300",children:N.jsxs("div",{className:"flex items-center gap-3",children:[N.jsx("span",{className:"text-sm font-semibold text-purple-300 mr-1",children:"Output:"}),N.jsx("div",{className:"flex flex-wrap gap-3 flex-grow items-center",children:N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx("div",{className:"w-28",children:N.jsx("input",{type:"text",value:c.cellReference,onChange:h=>y(h.target.value),className:"bg-transparent px-2 py-0.5 rounded border border-gray-600 w-full text-sm",placeholder:"Cell reference (e.g., A1)"})}),N.jsx("div",{className:"min-w-0 w-auto",children:c.error?N.jsx("div",{className:"bg-red-800 bg-opacity-30 px-2 py-0.5 rounded border border-red-700 text-sm text-red-400 whitespace-nowrap",children:c.error}):N.jsx("div",{className:"bg-transparent px-2 py-0.5 rounded border border-gray-600 text-sm whitespace-nowrap",children:c.result})})]})})]})})};function YE(r){if(!r)return console.warn("[InputManager] Element is null"),!1;if(!r)return!1;const s=r.tagName==="INPUT"||r.tagName==="TEXTAREA"||r.contentEditable==="true"||typeof r.getAttribute=="function"&&r.getAttribute("role")==="textbox";if(!s&&r.tagName!=="BUTTON")return!1;const c=r.id==="formula-bar-input"||r.classList&&typeof r.classList.contains=="function"&&r.classList.contains("formula-bar-input");return s&&!c||r.tagName==="BUTTON"}const Op=({columns:r,rows:s,formulaBarRef:c,data:i,onToolbarAction:y=null,clipboard:h=null})=>{const{state:E,dispatch:g}=ol();return re.useEffect(()=>{function m(O){if(O.key==="Escape"&&h&&h.source==="cut"){O.preventDefault(),y&&y("cancelCut");return}if(!YE(O.target)&&!(O.key==="ArrowLeft"&&E.currentMode===ne.EDITING)){if((O.ctrlKey||O.metaKey)&&y)switch(O.key.toLowerCase()){case"b":O.preventDefault(),y("bold");return;case"i":O.preventDefault(),y("italic");return;case"=":O.preventDefault(),y("fontSizeUp");return;case"-":O.preventDefault(),y("fontSizeDown");return;case"z":O.preventDefault(),y("undo");return;case"y":O.preventDefault(),y("redo");return;case"c":O.preventDefault(),y("copy");return;case"x":O.preventDefault(),y("cut");return;case"v":O.preventDefault(),y("paste");return}if(O.key==="Shift"){O.stopPropagation();return}if(E.activeCell)switch(E.currentMode){case ne.NAVIGATION:D(O);break;case ne.EDITING:b(O);break;case ne.CELL_REF_SELECTION:z(O);break;case ne.RANGE_SELECTION:F(O);break;case ne.TEXT_SELECTION:K(O);break;case ne.RANGE_REF_SELECTION:k(O);break}}}function T(){}function D(O){var ee,le,X,se;if(O.key.startsWith("Arrow")){if(O.shiftKey){g({type:"NAVIGATION_TO_RANGE_SELECTION",startCell:E.activeCell});const te=St(E.activeCell,O.key,r,s);g({type:"UPDATE_RANGE_SELECTION",cell:te}),g({type:"UPDATE_ACTIVE_CELL",cell:te})}else{const te=St(E.activeCell,O.key,r,s);g({type:"UPDATE_ACTIVE_CELL",cell:te}),g({type:"CLEAR_SELECTION"}),(ee=c==null?void 0:c.current)!=null&&ee.selectFormulaText&&setTimeout(()=>c.current.selectFormulaText(),0)}O.preventDefault()}if(mr(O.key)&&!O.ctrlKey&&!O.altKey&&!O.metaKey){if(YE(document.activeElement))return;`${E.activeCell.col}${E.activeCell.row}`,O.key==="="?(g({type:"NAVIGATION_TO_EDITING",value:"="}),c!=null&&c.current&&(c.current.focus(),setTimeout(()=>{const te=c.current;te&&(te.selectionStart=1,te.selectionEnd=1)},0)),O.preventDefault()):(g({type:"NAVIGATION_TO_EDITING",value:""}),c!=null&&c.current&&c.current.focus())}if(O.key==="F2"){const te=`${E.activeCell.col}${E.activeCell.row}`,ye=((le=i[te])==null?void 0:le.rawValue)||"";g({type:"NAVIGATION_TO_EDITING",value:ye}),c!=null&&c.current&&(c.current.focus(),setTimeout(()=>{const pe=c.current;pe&&(pe.selectionStart=ye.length,pe.selectionEnd=ye.length)},0)),O.preventDefault()}if(O.key==="Enter"){const te=St(E.activeCell,"Enter",r,s);g({type:"UPDATE_ACTIVE_CELL",cell:te}),g({type:"CLEAR_SELECTION"}),(X=c==null?void 0:c.current)!=null&&X.selectFormulaText&&setTimeout(()=>c.current.selectFormulaText(),0),O.preventDefault()}if(O.key==="Tab"){const te=O.shiftKey?"ShiftTab":"Tab",ye=St(E.activeCell,te,r,s);g({type:"UPDATE_ACTIVE_CELL",cell:ye}),g({type:"CLEAR_SELECTION"}),(se=c==null?void 0:c.current)!=null&&se.selectFormulaText&&setTimeout(()=>c.current.selectFormulaText(),0),O.preventDefault()}O.key==="Delete"&&y&&(y("clear"),O.preventDefault())}function b(O){if(O.key==="Enter"||O.key==="Escape"||O.key==="Tab"){const ee=O.key!=="Escape",le=O.key==="Enter"?"Enter":O.key==="Tab"?O.shiftKey?"ShiftTab":"Tab":null,X=le?St(E.activeCell,le,r,s):E.activeCell;ee&&(c!=null&&c.current)&&c.current.commitValue(),g({type:"EDITING_TO_NAVIGATION",newActiveCell:X,clearSelection:!0}),O.preventDefault();return}if(O.key==="ArrowLeft"||O.key==="ArrowRight"||O.key==="ArrowUp"||O.key==="ArrowDown"){if((O.key==="ArrowUp"||O.key==="ArrowDown")&&E.isEditingFormula){console.log(`[InputManager] Formula editing: ${O.key}  entering cell reference mode`),g({type:"EDITING_TO_CELL_REF_SELECTION"});const le=St(E.activeCell,O.key,r,s);g({type:"UPDATE_ACTIVE_CELL",cell:le}),c!=null&&c.current&&c.current.insertCellReference(le.col,le.row),O.preventDefault();return}if(O.key==="ArrowLeft")return;if(O.key==="ArrowRight"){const le=document.activeElement;if(!(le&&"selectionStart"in le&&le.selectionStart===le.value.length))return}c!=null&&c.current&&c.current.commitValue();const ee=St(E.activeCell,O.key,r,s);g({type:"EDITING_TO_NAVIGATION",newActiveCell:ee,clearSelection:!0}),O.preventDefault();return}if(O.shiftKey&&O.key.startsWith("Arrow")&&E.isEditingFormula&&E.formulaValue==="="){g({type:"EDITING_TO_RANGE_REF_SELECTION",startCell:E.activeCell});const ee=St(E.activeCell,O.key,r,s);g({type:"UPDATE_RANGE_SELECTION",cell:ee}),g({type:"UPDATE_ACTIVE_CELL",cell:ee}),O.preventDefault();return}}function z(O){if(O.key==="Tab"||O.key==="Enter"){E.editingCell&&g({type:"UPDATE_ACTIVE_CELL",cell:E.editingCell}),g({type:"CELL_REF_SELECTION_TO_EDITING",acceptReference:!0}),c!=null&&c.current&&c.current.focus(),O.preventDefault();return}if(O.key==="Escape"){E.editingCell&&g({type:"UPDATE_ACTIVE_CELL",cell:E.editingCell}),g({type:"CELL_REF_SELECTION_TO_EDITING",acceptReference:!1}),c!=null&&c.current&&c.current.focus(),O.preventDefault();return}if(O.shiftKey&&O.key.startsWith("Arrow")){g({type:"CELL_REF_SELECTION_TO_RANGE_REF_SELECTION",startCell:E.activeCell});const ee=St(E.activeCell,O.key,r,s);g({type:"UPDATE_RANGE_SELECTION",cell:ee}),g({type:"UPDATE_ACTIVE_CELL",cell:ee}),c!=null&&c.current&&c.current.insertRangeReference(E.activeCell.col,E.activeCell.row,ee.col,ee.row,E.replaceReference),O.preventDefault();return}if(mr(O.key)&&!O.ctrlKey&&!O.altKey&&!O.metaKey){c!=null&&c.current&&c.current.appendCharacter(O.key),g({type:"SET_REPLACE_REFERENCE",value:!1}),O.preventDefault();return}if(O.key.startsWith("Arrow")&&!O.shiftKey){const ee=St(E.activeCell,O.key,r,s);g({type:"UPDATE_ACTIVE_CELL",cell:ee}),c!=null&&c.current&&(E.replaceReference?c.current.replaceCellReference(ee.col,ee.row):(c.current.insertCellReference(ee.col,ee.row,!1),g({type:"SET_REPLACE_REFERENCE",value:!0}))),O.preventDefault()}}function F(O){var ee;if(O.key.startsWith("Arrow")&&!O.shiftKey){const le=St(E.activeCell,O.key,r,s);g({type:"RANGE_SELECTION_TO_NAVIGATION",newActiveCell:le,clearSelection:!0}),O.preventDefault();return}if(O.key.startsWith("Arrow")&&O.shiftKey){const le=St(E.activeCell,O.key,r,s);g({type:"UPDATE_RANGE_SELECTION",cell:le}),g({type:"UPDATE_ACTIVE_CELL",cell:le}),O.preventDefault();return}if(O.key==="Delete"){y&&(y("clear"),O.preventDefault());return}if(mr(O.key)&&!O.ctrlKey&&!O.altKey&&!O.metaKey){g({type:"RANGE_SELECTION_TO_EDITING",value:O.key==="="?"=":""}),c!=null&&c.current&&c.current.focus(),O.preventDefault();return}if(O.key==="F2"){const le=E.activeCell,X=`${le.col}${le.row}`,se=((ee=i[X])==null?void 0:ee.rawValue)||"";g({type:"RANGE_SELECTION_TO_EDITING",value:se}),c!=null&&c.current&&c.current.focus(),O.preventDefault()}}function K(O){if(O.key==="Enter"||O.key==="Escape"||O.key==="Tab"){const ee=O.key!=="Escape",le=O.key==="Enter"?"Enter":O.key==="Tab"?O.shiftKey?"ShiftTab":"Tab":null,X=le?St(E.activeCell,le,r,s):E.activeCell;ee&&(c!=null&&c.current)&&c.current.commitValue(),g({type:"TEXT_SELECTION_TO_NAVIGATION",newActiveCell:X,clearSelection:!0}),O.preventDefault();return}mr(O.key)&&!O.ctrlKey&&!O.altKey&&!O.metaKey||O.key.startsWith("Arrow")&&O.shiftKey}function k(O){if(O.key==="Tab"||O.key==="Enter"){c!=null&&c.current&&E.selection&&c.current.insertRangeReference(E.selection.start.col,E.selection.start.row,E.selection.end.col,E.selection.end.row),E.editingCell&&g({type:"UPDATE_ACTIVE_CELL",cell:E.editingCell}),g({type:"RANGE_REF_SELECTION_TO_EDITING",acceptReference:!0}),c!=null&&c.current&&c.current.focus(),O.preventDefault();return}if(O.key==="Escape"){E.editingCell&&g({type:"UPDATE_ACTIVE_CELL",cell:E.editingCell}),g({type:"RANGE_REF_SELECTION_TO_EDITING",acceptReference:!1}),c!=null&&c.current&&c.current.focus(),O.preventDefault();return}if(mr(O.key)&&!O.ctrlKey&&!O.altKey&&!O.metaKey){c!=null&&c.current&&E.selection&&c.current.insertRangeReference(E.selection.start.col,E.selection.start.row,E.selection.end.col,E.selection.end.row),c!=null&&c.current&&c.current.appendCharacter(O.key),g({type:"RANGE_REF_SELECTION_TO_CELL_REF_SELECTION"}),O.preventDefault();return}if(O.key.startsWith("Arrow")&&O.shiftKey){const ee=St(E.activeCell,O.key,r,s),le=E.selection?{...E.selection.start}:{...E.activeCell};g({type:"UPDATE_RANGE_SELECTION",cell:ee}),g({type:"UPDATE_ACTIVE_CELL",cell:ee}),c!=null&&c.current&&c.current.insertRangeReference(le.col,le.row,ee.col,ee.row),O.preventDefault();return}if(O.key.startsWith("Arrow")&&!O.shiftKey){const ee=St(E.activeCell,O.key,r,s);g({type:"RANGE_REF_SELECTION_TO_CELL_REF_SELECTION"}),g({type:"UPDATE_ACTIVE_CELL",cell:ee}),g({type:"SET_REPLACE_REFERENCE",value:!0}),c!=null&&c.current&&c.current.replaceCellReference(ee.col,ee.row),O.preventDefault()}}return document.addEventListener("keydown",m),document.addEventListener("keyup",T),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",T)}},[E,g,r,s,c,i,y,h]),null};function mr(r){return r.length===1||r==="="}const $={TYPE_MISMATCH:"#TYPE!",VALUE_ERROR:"#VALUE!",DIV_ZERO:"#DIV/0!",CIRCULAR:"#CIRCULAR!",INVALID_REF:"#REF!",GENERAL_ERROR:"#ERROR!",NAN_ERROR:"#NAN!",NAME_ERROR:"#NAME!",NUM_ERROR:"#NUM!",NA_ERROR:"#N/A!"},ey=r=>{const s=r.startsWith("=")?r.substring(1).trim():r.trim();if(s.includes('"')||s.includes("'"))return console.warn("[FormulaParser] String literals not allowed in formulas"),{error:$.TYPE_MISMATCH};const c=[];let i=0;for(;i<s.length;){for(;i<s.length&&/\s/.test(s[i]);)i++;if(i>=s.length)break;if(/[A-Za-z$]/.test(s[i])){let y=i;for(;y<s.length&&/[A-Za-z0-9$_]/.test(s[y]);)y++;const h=s.substring(i,y);if(be.nameExists(h)&&(be.getNamesByType(Le.BUILT_IN_FUNCTION).includes(h.toUpperCase())||be.getNamesByType(Le.CUSTOM_FUNCTION).includes(h.toUpperCase())))c.push(h.toUpperCase());else if(tp(h)){const E=W0(h);typeof E=="string"?c.push(E.toUpperCase()):E&&E.start&&E.end?(c.push(E.start.toUpperCase()),c.push(":"),c.push(E.end.toUpperCase())):c.push(h.toUpperCase())}else if(lp(h)){const E=np(h);c.push(E)}else c.push(h.toUpperCase());i=y}else if(/[0-9-]/.test(s[i])){let y=!1;if(s[i]==="-")if((i===0||/[(,+\-*^/]/.test(s[i-1]))&&i+1<s.length&&/[0-9]/.test(s[i+1]))y=!0,i++;else{c.push("-"),i++;continue}let h=i;for(;h<s.length&&/[0-9.]/.test(s[h]);)h++;let E=s.substring(i,h);y&&(E="-"+E),c.push(E),i=h}else{if(i+1<s.length){const y=s.substr(i,2);if(y===">="||y==="<="||y==="<>"){c.push(y),i+=2;continue}}c.push(s[i]),i++}}return c},HE=r=>{switch(r){case"^":return 4;case"*":case"/":return 3;case"+":case"-":return 2;case">":case"<":case">=":case"<=":case"=":case"<>":return 1;default:return 0}},pr=(r,s,c)=>{const i=_t(r),y=_t(s);if(!i||!y)return{error:$.INVALID_REF};const h=Math.min(i.col,y.col),E=Math.max(i.col,y.col),g=Math.min(i.row,y.row),m=Math.max(i.row,y.row),T=[];for(let D=g;D<=m;D++){const b=[];for(let z=h;z<=E;z++){const F=k0(z,D),K=c[F];if(Tr(K))return{error:$.INVALID_REF};if(K.type===o.ERROR)return{error:K.displayValue};b.push(K.value)}T.push(b)}return T},Qt=(r,s)=>{const c=r.replace(/\$/g,"").toUpperCase(),i=s[c];return Tr(i)?{error:$.INVALID_REF}:i.type===o.ERROR?{error:i.displayValue}:i.value},Sn=(r,s,c=!1)=>{if(r.type==="value")return typeof r.value!="number"?{error:$.TYPE_MISMATCH}:{value:r.value};if(r.type==="cell"){const i=Qt(r.ref,s);return i&&i.error?{error:i.error}:typeof i!="number"?{error:$.TYPE_MISMATCH}:{value:i}}else return r.type==="function_result"?r.error?{error:r.error}:c&&(r.valueType===o.DATE||r.valueType===o.DATETIME)?{value:r.value}:typeof r.value!="number"?{error:$.TYPE_MISMATCH}:{value:r.value}:{error:$.VALUE_ERROR}},ul=(r,s)=>{const c=Sn(r,s);return c.error?c:{value:Math.floor(c.value)}},zu=(r,s)=>{if(r.type==="value"){const c=typeof r.value=="number"?o.NUMBER:r.value instanceof Date?o.DATE:o.TEXT;return{value:r.value,type:c}}else if(r.type==="cell"){const c=Qt(r.ref,s);if(c&&c.error)return{error:c.error};const i=typeof c=="number"?o.NUMBER:c instanceof Date?o.DATE:o.TEXT;return{value:c,type:i}}else return r.type==="function_result"?r.error?{error:r.error}:{value:r.value,type:r.valueType}:r.type==="range"?{error:$.VALUE_ERROR}:{error:$.GENERAL_ERROR}},vr={DATE:(r,s)=>{if(r.length!==3)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const c=ul(r[0],s);if(c.error)return{value:null,type:o.ERROR,error:c.error};let i=c.value;const y=ul(r[1],s);if(y.error)return{value:null,type:o.ERROR,error:y.error};const h=y.value-1,E=ul(r[2],s);if(E.error)return{value:null,type:o.ERROR,error:E.error};const g=E.value;if(i>=0&&i<100&&(i+=1900),h<0||h>11)return{value:null,type:o.ERROR,error:$.NUM_ERROR};const m=new Date(i,h,g,0,0,0,0);return isNaN(m.getTime())||m.getDate()!==g||m.getMonth()!==h||m.getFullYear()!==i?{value:null,type:o.ERROR,error:$.NUM_ERROR}:{value:m,type:o.DATE}},DATETIME:(r,s)=>{if(r.length<3||r.length>6)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const c=ul(r[0],s);if(c.error)return{value:null,type:o.ERROR,error:c.error};let i=c.value;const y=ul(r[1],s);if(y.error)return{value:null,type:o.ERROR,error:y.error};const h=y.value-1,E=ul(r[2],s);if(E.error)return{value:null,type:o.ERROR,error:E.error};const g=E.value;let m=0,T=0,D=0;if(r.length>3){const z=ul(r[3],s);if(z.error)return{value:null,type:o.ERROR,error:z.error};m=z.value}if(r.length>4){const z=ul(r[4],s);if(z.error)return{value:null,type:o.ERROR,error:z.error};T=z.value}if(r.length>5){const z=ul(r[5],s);if(z.error)return{value:null,type:o.ERROR,error:z.error};D=z.value}if(i>=0&&i<100&&(i+=1900),h<0||h>11)return{value:null,type:o.ERROR,error:$.NUM_ERROR};if(m<0||m>23||T<0||T>59||D<0||D>59)return{value:null,type:o.ERROR,error:$.NUM_ERROR};const b=new Date(i,h,g,m,T,D);return isNaN(b.getTime())||b.getDate()!==g||b.getMonth()!==h||b.getFullYear()!==i||b.getHours()!==m||b.getMinutes()!==T||b.getSeconds()!==D?{value:null,type:o.ERROR,error:$.NUM_ERROR}:{value:b,type:o.DATETIME}},YEAR:(r,s)=>{if(r.length!==1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const c=Sn(r[0],s,!0);if(c.error)return{value:null,type:o.ERROR,error:c.error};const i=c.value;if(typeof i!="number"||i<1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const y=Math.floor(i),h=sl(y);return h?{value:h.year,type:o.NUMBER}:{value:null,type:o.ERROR,error:$.VALUE_ERROR}},HOUR:(r,s)=>{if(r.length!==1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};let c,i;if(r[0].type==="value"){if(typeof r[0].value!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};c=r[0].value,i=c%1!==0?o.DATETIME:o.DATE}else if(r[0].type==="cell"){const E=Qt(r[0].ref,s);if(E&&E.error)return{value:null,type:o.ERROR,error:E.error};if(typeof E!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};c=E,i=c%1!==0?o.DATETIME:o.DATE}else if(r[0].type==="function_result"){if(r[0].error)return{value:null,type:o.ERROR,error:r[0].error};if(r[0].valueType!==o.DATETIME)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};c=r[0].value,i=r[0].valueType}else return{value:null,type:o.ERROR,error:$.VALUE_ERROR};if(typeof c!="number"||c<1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};if(i===o.DATE)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};const y=c-Math.floor(c);return{value:hr(y).hour,type:o.NUMBER}},MINUTE:(r,s)=>{if(r.length!==1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};let c,i;if(r[0].type==="value"){if(typeof r[0].value!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};c=r[0].value,i=c%1!==0?o.DATETIME:o.DATE}else if(r[0].type==="cell"){const E=Qt(r[0].ref,s);if(E&&E.error)return{value:null,type:o.ERROR,error:E.error};if(typeof E!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};c=E,i=c%1!==0?o.DATETIME:o.DATE}else if(r[0].type==="function_result"){if(r[0].error)return{value:null,type:o.ERROR,error:r[0].error};if(r[0].valueType!==o.DATETIME)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};c=r[0].value,i=r[0].valueType}else return{value:null,type:o.ERROR,error:$.VALUE_ERROR};if(typeof c!="number"||c<1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};if(i===o.DATE)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};const y=c-Math.floor(c);return{value:hr(y).minute,type:o.NUMBER}},SECOND:(r,s)=>{if(r.length!==1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};let c,i;if(r[0].type==="value"){if(typeof r[0].value!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};c=r[0].value,i=c%1!==0?o.DATETIME:o.DATE}else if(r[0].type==="cell"){const E=Qt(r[0].ref,s);if(E&&E.error)return{value:null,type:o.ERROR,error:E.error};if(typeof E!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};c=E,i=c%1!==0?o.DATETIME:o.DATE}else if(r[0].type==="function_result"){if(r[0].error)return{value:null,type:o.ERROR,error:r[0].error};if(r[0].valueType!==o.DATETIME)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};c=r[0].value,i=r[0].valueType}else return{value:null,type:o.ERROR,error:$.VALUE_ERROR};if(typeof c!="number"||c<1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};if(i===o.DATE)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};const y=c-Math.floor(c),h=hr(y);return{value:Math.floor(h.second),type:o.NUMBER}},MONTH:(r,s)=>{if(r.length!==1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const c=Sn(r[0],s,!0);if(c.error)return{value:null,type:o.ERROR,error:c.error};const i=c.value;if(typeof i!="number"||i<1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const y=Math.floor(i),h=sl(y);return h?{value:h.month,type:o.NUMBER}:{value:null,type:o.ERROR,error:$.VALUE_ERROR}},DAY:(r,s)=>{if(r.length!==1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const c=Sn(r[0],s,!0);if(c.error)return{value:null,type:o.ERROR,error:c.error};const i=c.value;if(typeof i!="number"||i<1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const y=Math.floor(i),h=sl(y);return h?{value:h.day,type:o.NUMBER}:{value:null,type:o.ERROR,error:$.VALUE_ERROR}},DAYS:(r,s)=>{if(r.length!==2)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const c=Sn(r[0],s,!0);if(c.error)return{value:null,type:o.ERROR,error:c.error};const i=c.value,y=Sn(r[1],s,!0);if(y.error)return{value:null,type:o.ERROR,error:y.error};const h=y.value;if(typeof i!="number"||typeof h!="number"||i<1||h<1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const E=Math.floor(i),g=Math.floor(h);return{value:L0(E,g),type:o.NUMBER}},EOMONTH:(r,s)=>{if(r.length!==2)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const c=Sn(r[0],s,!0);if(c.error)return{value:null,type:o.ERROR,error:c.error};const i=c.value,y=ul(r[1],s);if(y.error)return{value:null,type:o.ERROR,error:y.error};if(y.value,typeof i!="number"||i<1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const h=Math.floor(i);return{value:I0(h),type:o.DATE}},IF:(r,s)=>{if(r.length!==3)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const c=zu(r[0],s);if(c.error)return{value:null,type:o.ERROR,error:c.error};let i;if(c.type===o.NUMBER)if(c.value===0)i=!1;else if(c.value===1)i=!0;else return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};else return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};const y=zu(r[1],s);if(y.error)return{value:null,type:o.ERROR,error:y.error};const h=zu(r[2],s);return h.error?{value:null,type:o.ERROR,error:h.error}:y.type!==h.type?{value:null,type:o.ERROR,error:$.TYPE_MISMATCH}:i?y:h},AND:(r,s)=>{if(r.length===0)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};for(let c of r)if(c.type==="range"){const i=pr(c.start,c.end,s);if(i.error)return{value:null,type:o.ERROR,error:i.error};for(const y of i)for(const h of y){if(typeof h!="number"||h!==0&&h!==1)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};if(h===0)return{value:0,type:o.NUMBER}}}else if(c.type==="cell"){const i=Qt(c.ref,s);if(i&&i.error)return{value:null,type:o.ERROR,error:i.error};if(typeof i!="number"||i!==0&&i!==1)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};if(i===0)return{value:0,type:o.NUMBER}}else if(c.type==="value"){if(typeof c.value!="number"||c.value!==0&&c.value!==1)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};if(c.value===0)return{value:0,type:o.NUMBER}}else if(c.type==="function_result"){if(c.error)return{value:null,type:o.ERROR,error:c.error};if(c.valueType!==o.NUMBER||c.value!==0&&c.value!==1)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};if(c.value===0)return{value:0,type:o.NUMBER}}return{value:1,type:o.NUMBER}},OR:(r,s)=>{if(r.length===0)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};for(let c of r)if(c.type==="range"){const i=pr(c.start,c.end,s);if(i.error)return{value:null,type:o.ERROR,error:i.error};for(const y of i)for(const h of y){if(typeof h!="number"||h!==0&&h!==1)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};if(h===1)return{value:1,type:o.NUMBER}}}else if(c.type==="cell"){const i=Qt(c.ref,s);if(i&&i.error)return{value:null,type:o.ERROR,error:i.error};if(typeof i!="number"||i!==0&&i!==1)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};if(i===1)return{value:1,type:o.NUMBER}}else if(c.type==="value"){if(typeof c.value!="number"||c.value!==0&&c.value!==1)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};if(c.value===1)return{value:1,type:o.NUMBER}}else if(c.type==="function_result"){if(c.error)return{value:null,type:o.ERROR,error:c.error};if(c.valueType!==o.NUMBER||c.value!==0&&c.value!==1)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};if(c.value===1)return{value:1,type:o.NUMBER}}return{value:0,type:o.NUMBER}},NOT:(r,s)=>{if(r.length!==1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const c=zu(r[0],s);return c.error?{value:null,type:o.ERROR,error:c.error}:c.type!==o.NUMBER?{value:null,type:o.ERROR,error:$.TYPE_MISMATCH}:c.value===0?{value:1,type:o.NUMBER}:c.value===1?{value:0,type:o.NUMBER}:{value:null,type:o.ERROR,error:$.TYPE_MISMATCH}},SUM:(r,s)=>{let c=0;for(let i of r)if(i.type==="range"){const y=pr(i.start,i.end,s);if(y.error)return{value:null,type:o.ERROR,error:y.error};for(const h of y)for(const E of h){if(typeof E!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};c+=E}}else if(i.type==="cell"){const y=Qt(i.ref,s);if(y&&y.error)return{value:null,type:o.ERROR,error:y.error};if(typeof y!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};c+=y}else if(i.type==="value"){if(typeof i.value!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};c+=i.value}return{value:c,type:o.NUMBER}},INDEX:(r,s)=>{if(r.length<2||r.length>3)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};if(r[0].type!=="range")return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const c=pr(r[0].start,r[0].end,s);if(c.error)return{value:null,type:o.ERROR,error:c.error};const i=new Set;for(const g of c)for(const m of g)if(m!==null){const T=typeof m=="number"?"number":m instanceof Date?"date":"string";i.add(T)}if(i.size>1)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};let y,h;if(r[1].type==="value"){if(typeof r[1].value!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};y=r[1].value-1}else if(r[1].type==="cell"){const g=Qt(r[1].ref,s);if(g&&g.error)return{value:null,type:o.ERROR,error:g.error};if(typeof g!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};y=g-1}else if(r[1].type==="function_result"){if(r[1].valueType===o.ERROR)return{value:null,type:o.ERROR,error:r[1].error||$.GENERAL_ERROR};if(typeof r[1].value!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};y=r[1].value-1}else return{value:null,type:o.ERROR,error:$.VALUE_ERROR};if(c.length===1&&r.length===2){if(y<0||y>=c[0].length)return{value:null,type:o.ERROR,error:$.REF_ERROR};const g=c[0][y];return g===null?{value:null,type:o.ERROR,error:$.INVALID_REF}:{value:g,type:typeof g=="number"?o.NUMBER:g instanceof Date?o.DATE:o.TEXT}}if(c.length>1&&c[0].length===1&&r.length===2){if(y<0||y>=c.length)return{value:null,type:o.ERROR,error:$.REF_ERROR};const g=c[y][0];return g===null?{value:null,type:o.ERROR,error:$.INVALID_REF}:{value:g,type:typeof g=="number"?o.NUMBER:g instanceof Date?o.DATE:o.TEXT}}if(r.length===3)if(r[2].type==="value"){if(typeof r[2].value!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};h=r[2].value-1}else if(r[2].type==="cell"){const g=Qt(r[2].ref,s);if(g&&g.error)return{value:null,type:o.ERROR,error:g.error};if(typeof g!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};h=g-1}else return{value:null,type:o.ERROR,error:$.VALUE_ERROR};else h=0;if(y<0||y>=c.length||h<0||h>=c[0].length)return{value:null,type:o.ERROR,error:$.REF_ERROR};const E=c[y][h];return E===null?{value:null,type:o.ERROR,error:$.INVALID_REF}:{value:E,type:typeof E=="number"?o.NUMBER:E instanceof Date?o.DATE:o.TEXT}},MATCH:(r,s)=>{if(r.length<2||r.length>3)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};let c;if(r[0].type==="value")c=r[0].value;else if(r[0].type==="cell"){const m=Qt(r[0].ref,s);if(m&&m.error)return{value:null,type:o.ERROR,error:m.error};c=m}else return{value:null,type:o.ERROR,error:$.VALUE_ERROR};if(r[1].type!=="range")return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const i=pr(r[1].start,r[1].end,s);if(i.error)return{value:null,type:o.ERROR,error:i.error};let y=[];if(i.length===1)y=i[0];else if(i[0].length===1)y=i.map(m=>m[0]);else return{value:null,type:o.ERROR,error:$.VALUE_ERROR};if(y.some(m=>m===null))return{value:null,type:o.ERROR,error:$.INVALID_REF};let h=1;if(r.length===3){if(r[2].type==="value"){if(typeof r[2].value!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};h=r[2].value}else if(r[2].type==="cell"){const m=Qt(r[2].ref,s);if(m&&m.error)return{value:null,type:o.ERROR,error:m.error};if(typeof m!="number")return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};h=m}}if(h!==-1&&h!==0&&h!==1)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const E=typeof c;if(y.length===0)return{value:null,type:o.ERROR,error:$.VALUE_ERROR};const g=typeof y[0];if(h!==0&&E!==g)return{value:null,type:o.ERROR,error:$.TYPE_MISMATCH};if(h===0){const m=y.findIndex(T=>T===c);return m===-1?{value:null,type:o.ERROR,error:$.NA_ERROR}:{value:m+1,type:o.NUMBER}}else if(h===1){let m=-1;for(let T=0;T<y.length&&y[T]<=c;T++)m=T;return m===-1?{value:null,type:o.ERROR,error:$.NA_ERROR}:{value:m+1,type:o.NUMBER}}else if(h===-1){const m=y.findIndex(T=>T===c);if(m!==-1)return{value:m+1,type:o.NUMBER};for(let T=0;T<y.length;T++)if(y[T]<c)return T>0?{value:T,type:o.NUMBER}:{value:null,type:o.ERROR,error:$.NA_ERROR};return c<y[y.length-1]?{value:null,type:o.ERROR,error:$.NA_ERROR}:{value:y.length,type:o.NUMBER}}else return{value:null,type:o.ERROR,error:$.VALUE_ERROR}}};Object.keys(vr).forEach(r=>{be.registerName(r,Le.BUILT_IN_FUNCTION)});const _p=(r,s)=>{try{const c=[];let i=0;for(;i<r.length;){const y=r[i];if((be.getNamesByType(Le.BUILT_IN_FUNCTION).includes(y)||be.getNamesByType(Le.CUSTOM_FUNCTION).includes(y))&&vr[y]&&i+1<r.length&&r[i+1]==="("){const h=y;i+=2;const E=[];let g=1,m=[];for(;i<r.length&&g>0;)r[i]==="("?(g++,m.push(r[i])):r[i]===")"?(g--,g>0&&m.push(r[i])):r[i]===","&&g===1?m.length>0?(E.push(zE(m,s)),m=[]):E.push({type:"value",value:0}):m.push(r[i]),i++;m.length>0&&E.push(zE(m,s));const T=vr[h](E,s);c.push({type:"function_result",value:T.value,valueType:T.type,error:T.error})}else{if(i+2<r.length&&r[i+1]===":"&&/^[$]?[A-Z]+[$]?[1-9][0-9]*$/.test(y)&&/^[$]?[A-Z]+[$]?[1-9][0-9]*$/.test(r[i+2]))return{parsedTokens:[],error:$.VALUE_ERROR};/^[$]?[A-Z]+[$]?[1-9][0-9]*$/.test(y)?(c.push({type:"cell",ref:y}),i++):/^[0-9]+(?:\.[0-9]+)?$/.test(y)?(c.push({type:"value",value:parseFloat(y)}),i++):(c.push(y),i++)}}return{parsedTokens:c,error:null}}catch(c){return console.error("[FormulaParser] Error parsing formula tokens:",c),{parsedTokens:[],error:$.GENERAL_ERROR}}},zE=(r,s)=>{if(r.length===3&&r[1]===":"&&/^[$]?[A-Z]+[$]?[1-9][0-9]*$/.test(r[0])&&/^[$]?[A-Z]+[$]?[1-9][0-9]*$/.test(r[2]))return{type:"range",start:r[0],end:r[2]};if(r.length===1&&/^[$]?[A-Z]+[$]?[1-9][0-9]*$/.test(r[0]))return{type:"cell",ref:r[0]};if(r.length===1&&/^-?[0-9]+(?:\.[0-9]+)?$/.test(r[0]))return{type:"value",value:parseFloat(r[0])};if(r.length===2&&r[0]==="-"&&/^[0-9]+(?:\.[0-9]+)?$/.test(r[1]))return{type:"value",value:-parseFloat(r[1])};const c="="+r.join("");try{const i=Fu(c,s);return i.error?{type:"function_result",value:null,valueType:o.ERROR,error:i.error}:{type:"function_result",value:i.value,valueType:i.type}}catch(i){return console.error("Error evaluating nested expression:",i),{type:"function_result",value:null,valueType:o.ERROR,error:$.GENERAL_ERROR}}},Dp=(r,s,c,i,y)=>{const h=vs.validateOperation(y,c,i);return h.valid?vs.performOperation({value:s,type:y},c,{value:r,type:i}):{value:null,type:o.ERROR,error:h.error}},Fu=(r,s)=>{try{if(!r||typeof r!="string")return console.warn("[FormulaParser] Invalid formula input:",r),{value:null,type:o.ERROR,error:$.GENERAL_ERROR};if(!r.startsWith("="))return console.warn("[FormulaParser] Formula must start with =:",r),{value:null,type:o.ERROR,error:$.GENERAL_ERROR};const i=ey(r);if(i.error)return console.warn("[FormulaParser] Error tokenizing formula:",i.error),{value:null,type:o.ERROR,error:i.error};const{parsedTokens:y,error:h}=_p(i,s);if(h)return console.warn("[FormulaParser] Error parsing formula tokens:",h),{value:null,type:o.ERROR,error:h};const E=[],g=[],m=[],T=()=>{const b=E.pop(),z=g.pop(),F=E.pop(),K=g.pop(),k=m.pop(),O=Dp(b,F,k,z,K);return E.push(O.value),g.push(O.type),O.error?O.error:null};let D=null;for(let b of y){if(b.type==="value")E.push(b.value),g.push(typeof b.value=="number"?o.NUMBER:b.value instanceof Date?o.DATE:o.TEXT);else if(b.type==="cell"){const z=b.ref.replace(/\$/g,"").toUpperCase(),F=s[z];if(Tr(F))return{value:null,type:o.ERROR,error:$.INVALID_REF};{const K=F.type,k=F.value;switch(K){case o.NUMBER:E.push(k),g.push(o.NUMBER);break;case o.DATE:E.push(k),g.push(o.DATE);break;case o.TEXT:E.push(k),g.push(o.TEXT);break;case o.ERROR:return{value:k,type:o.ERROR,error:k};default:E.push(k),g.push(o.TEXT)}}}else if(b.type==="function_result"){if(b.error)return{value:null,type:o.ERROR,error:b.error};E.push(b.value),g.push(b.valueType)}else if(b==="(")m.push(b);else if(b===")"){for(;m.length&&m[m.length-1]!=="(";){const z=T();if(z){D=z;break}}m.length&&m.pop()}else{for(;m.length&&m[m.length-1]!=="("&&HE(m[m.length-1])>=HE(b);){const z=T();if(z){D=z;break}}m.push(b)}if(D)break}for(;!D&&m.length;){const b=T();if(b){D=b;break}}return D?{value:null,type:o.ERROR,error:D}:E.length===1&&g.length===1?{value:E[0],type:g[0]}:{value:null,type:o.ERROR,error:$.GENERAL_ERROR}}catch(c){return console.error("[FormulaParser] Formula evaluation error:",c),{value:null,type:o.ERROR,error:$.GENERAL_ERROR}}},xp=r=>{const s={...r},c=new Set,i=y=>{const h=new Set,E=(g,m)=>{if(m.has(g))return console.error(`Circular reference detected: ${g} references itself`),{error:!0};if(c.has(g))return{error:!1};m.add(g);const T=r[g];if(!T)return c.add(g),m.delete(g),{error:!1};if(T.isFormula){const b=ey(T.canonicalValue);if(b.error)return s[g]={...T,isFormula:!0,formulaValue:T.rawValue,type:o.ERROR,displayValue:b.error},c.add(g),m.delete(g),{error:!1};const z=b.filter(O=>/^[$]?[A-Za-z]+[$]?[1-9][0-9]?$/.test(O)).map(O=>O.replace(/\$/g,"").toUpperCase());for(const O of z){const{error:ee}=E(O,m);if(ee)return s[g]={...T,isFormula:!0,formulaValue:T.rawValue,type:o.ERROR,displayValue:$.CIRCULAR},c.add(g),m.delete(g),{error:!0}}const{value:F,type:K,error:k}=Fu(T.canonicalValue,s);s[g]={...T,value:F,isFormula:!0,formulaValue:T.rawValue,type:K||o.NUMBER,error:k}}else{const b=T.type||o.TEXT;s[g]={...T,isFormula:!1,type:b}}return c.add(g),m.delete(g),{error:!1}};return E(y,h)};return Object.keys(r).forEach(y=>{i(y)}),s},Up=(r,s)=>be.getNamesByType(Le.BUILT_IN_FUNCTION).includes(r.toUpperCase())?(console.warn(`[FormulaParser] Custom function registration failed: '${r}' conflicts with built-in function`),!1):be.registerName(r,Le.CUSTOM_FUNCTION)?(vr[r.toUpperCase()]=s,!0):(console.warn(`[FormulaParser] Custom function registration failed: '${r}' is invalid or already exists`),!1),wp=r=>{const s=r.toUpperCase();be.getNamesByType(Le.CUSTOM_FUNCTION).includes(s)?(be.deregisterName(s,Le.CUSTOM_FUNCTION),delete vr[s]):console.warn(`[FormulaParser] Function deregistration ignored: '${r}' is not a custom function`)};typeof window<"u"&&(window.evaluateFormula=Fu);const Lp={evaluateFormula:Fu,registerCustomFunction:Up,deregisterCustomFunction:wp,recalculateGrid:xp},Ip=r=>{try{const s=JSON.stringify(r,null,2),c=new Blob([s],{type:"application/json"}),i=document.createElement("a");return i.href=URL.createObjectURL(c),i.download="spreadsheet.json",document.body.appendChild(i),i.click(),document.body.removeChild(i),{success:!0}}catch(s){return console.error("Error saving spreadsheet:",s),{success:!1,error:s.message}}},Yp=r=>new Promise((s,c)=>{try{const i=new FileReader;i.onload=y=>{try{const h=JSON.parse(y.target.result);s({success:!0,data:h})}catch{c({success:!1,error:"Invalid file format"})}},i.onerror=()=>{c({success:!1,error:"Error reading file"})},i.readAsText(r)}catch(i){c({success:!1,error:i.message})}});function Hp(){try{const r=new Function("return import.meta")();if(r&&r.env)return r.env.VITE_DISABLE_EXTERNAL_CLIPBOARD_CHECK==="true"}catch{}return!1}const zp=()=>N.jsx(yp,{children:N.jsx(jp,{})}),jp=()=>{const[r,s]=re.useState({}),[c,i]=re.useState([]),[y,h]=re.useState([]),[E,g]=re.useState(-1),[m,T]=re.useState(null),[D,b]=re.useState(en()),{openFormatDialog:z}=WE(),[F,K]=re.useState(10),[k,O]=re.useState(!1),ee=re.useRef(null),le=re.useRef(null),X=mp(),se=JE();re.useEffect(()=>{const v=ps();i([{}]),h([v]),g(0)},[]);const te=v=>{var C,U;let R=0;for(const L in v){const q=(U=(C=L.match(/^[A-Za-z]+/))==null?void 0:C[0])==null?void 0:U.toUpperCase();if(q){let Q=0;for(let W=0;W<q.length;W++)Q=Q*26+(q.charCodeAt(W)-65+1);Q--,R=Math.max(R,Q)}}return Math.min(100,Math.max(10,R+1))},ye=()=>{setTimeout(()=>{s(v=>Lp.recalculateGrid(v))},0)},pe=()=>{E<c.length-1&&(i(c.slice(0,E+1)),h(y.slice(0,E+1)));const v=ps(),R=[...c,r],d=[...y,v];i(R),h(d),g(R.length-1)},me=(v,R=!1)=>{E<c.length-1&&(i(c.slice(0,E+1)),h(y.slice(0,E+1)));const d=ps(),C=[...c,v],U=[...y,d];i(C),h(U),g(C.length-1),s(v);const L=te(v);L>F&&K(L),R||ye()},xe=(v,R)=>v[R]?v[R]:Yu(),Ue=v=>{if(!X)return;pe();const R=ue(),d={...r};R.forEach(C=>{const U=`${C.col}${C.row}`,L=xe(d,U),q=L.format||{};let Q={...q};v&&Object.keys(v).forEach(W=>{typeof v[W]=="object"&&v[W]!==null?Q[W]={...q[W],...v[W]}:Q[W]=v[W]}),d[U]={...L,format:Q}}),s(d)},ue=()=>{if(!se)return X?[X]:[];if(!se.start||!se.end)return X?[X]:[];const v=se.start.col,R=se.start.row,d=se.end.col,C=se.end.row,U=Re=>{let Fe=0;for(let P=0;P<Re.length;P++)Fe=Fe*26+(Re.charCodeAt(P)-65+1);return Fe-1},L=U(v),q=U(d),Q=Math.min(L,q),W=Math.max(L,q),Ve=Math.min(R,C),Me=Math.max(R,C),lt=Re=>{let Fe="";do Fe=String.fromCharCode(65+Re%26)+Fe,Re=Math.floor(Re/26)-1;while(Re>=0);return Fe},mt=[];for(let Re=Q;Re<=W;Re++){const Fe=lt(Re);for(let P=Ve;P<=Me;P++)mt.push({col:Fe,row:P})}return mt},ie=()=>{Ip({data:r,defaultFormat:D})},Z=()=>{ee.current.click()},J=async v=>{const R=v.target.files[0];if(R){try{const d=await Yp(R);if(d.success){const{data:C,defaultFormat:U}=d.data;U&&b(U);const L=te(C);K(L),me(C)}else alert("Error loading file: "+d.error)}catch(d){alert("Error loading file: "+d.message)}v.target.value=null}},B=(v,R)=>{if(R&&R.source==="cut")if(R.type==="single"&&R.sourceCell){const d=R.sourceCell;v[d]&&(v[d]={...v[d],markedForCut:!1})}else R.type==="multiple"&&R.data&&Object.keys(R.data).forEach(d=>{v[d]&&(v[d]={...v[d],markedForCut:!1})})},A=async v=>{var U;if(!X&&v!=="clearClipboard"||v==="paste"&&!m)return;const R=ue();if(R.length===0&&v!=="clearClipboard")return;const d={...r};switch(v){case"bold":const L=R.some(P=>{var de,Se;const ge=`${P.col}${P.row}`;return!((Se=(de=r[ge])==null?void 0:de.format)!=null&&Se.bold)});Ue({bold:L});return;case"italic":const q=R.some(P=>{var de,Se;const ge=`${P.col}${P.row}`;return!((Se=(de=r[ge])==null?void 0:de.format)!=null&&Se.italic)});Ue({italic:q});return;case"fontSizeUp":R.forEach(P=>{var Se;const ge=`${P.col}${P.row}`,de=xe(d,ge);d[ge]={...de,format:{...de.format,fontSize:Math.min((((Se=de.format)==null?void 0:Se.fontSize)||14)+2,24)}}});break;case"fontSizeDown":R.forEach(P=>{var Se;const ge=`${P.col}${P.row}`,de=xe(d,ge);d[ge]={...de,format:{...de.format,fontSize:Math.max((((Se=de.format)==null?void 0:Se.fontSize)||14)-2,8)}}});break;case"alignLeft":Ue({align:"left"});return;case"alignCenter":Ue({align:"center"});return;case"alignRight":Ue({align:"right"});return;case"clear":pe(),R.forEach(P=>{const ge=`${P.col}${P.row}`,de=d[ge];if(!de)return;de.format&&Object.keys(de.format).length>0?d[ge]={...de,rawValue:"",value:void 0,canonicalValue:"",type:void 0,displayValue:"",isFormula:!1}:delete d[ge]}),s(d),ye();return;case"copy":case"cut":const Q=v==="cut"?"cut":"copy";console.log(`Spreadsheet: Executing ${Q} action`,{selectedCellsCount:R.length,firstCell:R.length>0?`${R[0].col}${R[0].row}`:null}),B(d,m);const W=Q0(r,R),Ve=xE(W);try{navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(W).then(()=>{}).catch(P=>{console.error("Spreadsheet: Failed to copy to system clipboard",P)}):console.warn("Spreadsheet: Clipboard API not available")}catch(P){console.error("Spreadsheet: Error accessing clipboard API",P)}if(R.length===1){const P=`${R[0].col}${R[0].row}`,ge=r[P]||Yu();T({type:"single",source:Q,data:{...ge},sourceCell:P,contentHash:Ve,isInternalSource:!0}),Q==="cut"&&(d[P]={...d[P],markedForCut:!0},me(d,!0))}else{const P=R[0].col,ge=R[0].row,de=R[R.length-1].col,Se=R[R.length-1].row,Oe={};R.forEach(We=>{const Xe=`${We.col}${We.row}`;Oe[Xe]=r[Xe]||Yu(),Q==="cut"&&(d[Xe]={...d[Xe],markedForCut:!0})}),T({type:"multiple",source:Q,data:Oe,bounds:{startCol:P,startRow:ge,endCol:de,endRow:Se},contentHash:Ve,isInternalSource:!0}),Q==="cut"&&me(d,!0)}if(Q==="copy"){m&&m.source==="cut"&&s(d);return}else break;case"paste":if(!m)return;let Me=!0,lt="";if(!Hp())try{if(navigator.clipboard&&navigator.clipboard.readText&&(lt=await navigator.clipboard.readText(),lt)){const P=xE(lt);(!m.contentHash||m.contentHash!==P||!m.isInternalSource)&&(Me=!1)}}catch(P){console.error("Spreadsheet: Error reading system clipboard",P),Me=!0}const Re=new Set;if(m.type==="single"){if(R.forEach(P=>{const ge=`${P.col}${P.row}`;let de=m.data.canonicalValue||"";if(de&&typeof de=="string"&&de.startsWith("=")){const Oe=m.sourceCell,We=ge,Xe={start:Oe,end:Oe};Re.add(We.replace(/\$/g,"")),de=ms(de,Xe,We,{isCutOperation:m.source==="cut",overwrittenCells:Re})}const Se={...m.data,markedForCut:!1};delete Se.rawValue,Se.canonicalValue=de,d[ge]=Se}),m.source==="cut"&&m.sourceCell){const P=m.sourceCell;delete d[P]}R.forEach(P=>{Re.add(`${P.col}${P.row}`)})}else if(m.type==="multiple"&&X){const{bounds:P}=m;if(!P||!P.startCol||!X.col)return;const ge=X.col.charCodeAt(0)-P.startCol.charCodeAt(0),de=X.row-P.startRow,Se=`${X.col}${X.row}`,Oe=m.source==="cut"?Object.keys(m.data):[],We={start:`${P.startCol}${P.startRow}`,end:`${P.endCol}${P.endRow}`};Object.entries(m.data).forEach(([Xe,Ht])=>{const pt=Xe.match(/^[A-Z]+/),Ml=Xe.match(/\d+$/);if(!pt||!Ml)return;const Ze=pt[0],rt=parseInt(Ml[0]),An=String.fromCharCode(Ze.charCodeAt(0)+ge),tn=rt+de,ot=`${An}${tn}`;let Tt=Ht.canonicalValue||"";if(Re.add(ot),Tt&&typeof Tt=="string"&&Tt.startsWith("=")){const Zu=We;Re.add(ot.replace(/\$/g,"")),Tt=ms(Tt,Zu,Se,{isCutOperation:m.source==="cut",overwrittenCells:Re})}const ft={...Ht,markedForCut:!1};delete ft.rawValue,ft.canonicalValue=Tt,d[ot]=ft}),m.source==="cut"&&Oe.length>0&&Oe.forEach(Xe=>{delete d[Xe]})}if(m.source==="cut"){const P=m.type==="single"&&m.sourceCell?{start:m.sourceCell,end:m.sourceCell}:{start:`${m.bounds.startCol}${m.bounds.startRow}`,end:`${m.bounds.endCol}${m.bounds.endRow}`},ge=`${X.col}${X.row}`;Object.keys(d).forEach(de=>{const Se=d[de];if(!(m.data[de]||Re.has(de))&&Se&&Se.canonicalValue&&typeof Se.canonicalValue=="string"&&Se.canonicalValue.startsWith("=")){const Oe=Se.canonicalValue,We=BE(Oe);let Xe=Oe,Ht=!1;if(We.forEach(pt=>{const Ml=pt.cellRef;Re.has(Ml)&&(Xe=Xe.replace(new RegExp(pt.fullRef.replace(/\$/g,"\\$"),"g"),"#REF!"),Ht=!0)}),Ht||(We.forEach(pt=>{Ea(pt.cellRef,P)&&(Ht=!0)}),Ht&&(Xe=ms(Oe,P,ge,{isCutOperation:!0,overwrittenCells:Re}))),Xe!==Oe){const pt=ZE.process(Xe);d[de]={...Se,rawValue:Xe,canonicalValue:pt.canonicalValue}}}});try{const de=m.type==="single"&&m.sourceCell?{start:m.sourceCell,end:m.sourceCell}:{start:`${m.bounds.startCol}${m.bounds.startRow}`,end:`${m.bounds.endCol}${m.bounds.endRow}`};if(!X||!X.col||!X.row){console.error("[Spreadsheet] Cannot update named ranges: invalid currentActiveCell",X);return}const Se={topLeftCell:`${X.col}${X.row}`,col:X.col,row:X.row};ep(de,Se.topLeftCell,{isCutOperation:!0})}catch(de){console.error("[Spreadsheet] Error updating named ranges:",de)}T(null),me(d)}break;case"cancelCut":console.log("Spreadsheet: Cancelling cut operation"),B(d,m),s(d),T(null);return;case"clearClipboard":console.log("Spreadsheet: Clearing clipboard"),B(d,m),m&&m.source==="cut"&&me(d,!0),T(null);return;case"undo":if(E>0){const P=E-1;g(P),s(c[P]),y[P]&&UE(y[P]);const ge=c[P];let de=!1;const Se=[];if(Object.entries(ge).forEach(([Oe,We])=>{We&&We.markedForCut&&(de=!0,Se.push(Oe))}),de)if(Se.length===1){const Oe=Se[0];T({type:"single",source:"cut",data:{...ge[Oe]},sourceCell:Oe})}else{const Oe={};Se.forEach(Ze=>{Oe[Ze]=ge[Ze]});const We=Se.map(Ze=>{const rt=Ze.match(/^[A-Z]+/),An=Ze.match(/\d+$/);return{col:rt?rt[0]:"A",row:An?parseInt(An[0]):1}}),Xe=We.reduce((Ze,rt)=>rt.col.localeCompare(Ze)<0?rt.col:Ze,"Z"),Ht=We.reduce((Ze,rt)=>rt.row<Ze?rt.row:Ze,9999),pt=We.reduce((Ze,rt)=>rt.col.localeCompare(Ze)>0?rt.col:Ze,"A"),Ml=We.reduce((Ze,rt)=>rt.row>Ze?rt.row:Ze,0);T({type:"multiple",source:"cut",data:Oe,bounds:{startCol:Xe,startRow:Ht,endCol:pt,endRow:Ml}})}ye()}return;case"redo":if(E<c.length-1){const P=E+1;g(P),s(c[P]),y[P]&&UE(y[P]),ye()}return;case"clearFormatting":R.forEach(P=>{const ge=`${P.col}${P.row}`,de=d[ge]||Yu();d[ge]={...de,format:D}});break;case"numberFormat":const Fe=X?(U=r[`${X.col}${X.row}`])==null?void 0:U.format:null;z(D,"cell",Fe);return;case"defaultNumberFormat":z(D,"default");return}me(d,v!=="paste"&&v!=="clear")},S=v=>{let d={...D||en()};v?Object.keys(v).forEach(C=>{C==="NUMBER"&&v[C].currentSubCategory?d[C]=v[C]:d[C]={...d[C],...v[C]}}):console.warn("Invalid format structure:",v),b(d),s(C=>({...C}))};return N.jsxs("div",{className:"max-w-full overflow-hidden bg-gray-900 text-gray-200 h-screen flex flex-col",children:[N.jsxs("div",{className:"flex items-center justify-between px-2 py-1 border-b border-gray-700",children:[N.jsx("h1",{className:"text-xl font-bold text-purple-400",children:"Spreadsheet"}),N.jsxs("div",{className:"flex gap-1",children:[N.jsx("button",{onClick:ie,className:"bg-purple-700 hover:bg-purple-800 text-white px-2 py-1 rounded-md text-sm",children:"Save"}),N.jsx("button",{onClick:Z,className:"bg-teal-700 hover:bg-teal-800 text-white px-2 py-1 rounded-md text-sm",children:"Open"}),N.jsx("input",{type:"file",ref:ee,onChange:J,accept:".json",className:"hidden"})]})]}),N.jsx(Np,{onAction:A,clipboard:m,showInputsOutputs:k,toggleInputsOutputs:()=>O(!k),hasSelection:X!==null,hasCellContent:X!==null&&r[`${X.col}${X.row}`]&&r[`${X.col}${X.row}`].rawValue!==void 0&&r[`${X.col}${X.row}`].rawValue!==""}),N.jsx(Sp,{ref:le,data:r,setData:me}),k&&N.jsx(Cp,{data:r,recalculate:ye}),N.jsx("div",{className:"flex-1 overflow-hidden",children:N.jsx(Rp,{data:r,setData:me,formulaBarRef:le,defaultFormat:D,numColumns:F,setNumColumns:K})}),k&&N.jsx(Mp,{data:r}),N.jsx(Op,{columns:Array.from({length:F},(v,R)=>String.fromCharCode(65+R)),rows:Array.from({length:20},(v,R)=>R+1),formulaBarRef:le,data:r,onToolbarAction:A,clipboard:m}),N.jsx(bp,{onApply:Ue,onDefaultFormatApply:S,data:r,defaultFormat:D})]})};function Vp(){const[r,s]=re.useState(null);re.useEffect(()=>{},[]);try{return N.jsx("div",{className:"bg-gray-900 min-h-screen w-full",children:r?N.jsxs("div",{className:"text-red-500 p-4",children:[N.jsx("h2",{children:"Error rendering spreadsheet:"}),N.jsx("pre",{children:r.toString()}),N.jsx("button",{className:"bg-blue-500 p-2 mt-2 rounded",onClick:()=>s(null),children:"Try again"})]}):N.jsx(zp,{})})}catch(c){return console.error("Error rendering App:",c),s(c),N.jsxs("div",{className:"text-red-500 p-4",children:[N.jsx("h2",{children:"Fatal error in App component:"}),N.jsx("pre",{children:c.toString()})]})}}C0.createRoot(document.getElementById("root")).render(N.jsx(VE.StrictMode,{children:N.jsx(Vp,{})}));</script>
    <style rel="stylesheet" crossorigin>*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.visible{visibility:visible}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{top:0;right:0;bottom:0;left:0}.left-0{left:0}.top-0{top:0}.isolate{isolation:isolate}.z-10{z-index:10}.z-20{z-index:20}.z-40{z-index:40}.z-50{z-index:50}.my-4{margin-top:1rem;margin-bottom:1rem}.mb-1{margin-bottom:.25rem}.mb-2{margin-bottom:.5rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.ml-2{margin-left:.5rem}.mr-1{margin-right:.25rem}.mr-2{margin-right:.5rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-6{margin-top:1.5rem}.block{display:block}.inline{display:inline}.flex{display:flex}.table{display:table}.grid{display:grid}.contents{display:contents}.hidden{display:none}.h-4{height:1rem}.h-6{height:1.5rem}.h-7{height:1.75rem}.h-full{height:100%}.h-screen{height:100vh}.min-h-screen{min-height:100vh}.w-28{width:7rem}.w-4{width:1rem}.w-72{width:18rem}.w-8{width:2rem}.w-96{width:24rem}.w-\[60px\]{width:60px}.w-auto{width:auto}.w-full{width:100%}.min-w-0{min-width:0px}.min-w-16{min-width:4rem}.min-w-\[60px\]{min-width:60px}.max-w-full{max-width:100%}.flex-1{flex:1 1 0%}.flex-grow{flex-grow:1}.border-collapse{border-collapse:collapse}.cursor-move{cursor:move}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-0\.5{gap:.125rem}.gap-1{gap:.25rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.5rem * var(--tw-space-x-reverse));margin-left:calc(.5rem * calc(1 - var(--tw-space-x-reverse)))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-nowrap{white-space:nowrap}.rounded{border-radius:.25rem}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-l{border-left-width:1px}.border-t{border-top-width:1px}.border-blue-600{--tw-border-opacity: 1;border-color:rgb(37 99 235 / var(--tw-border-opacity, 1))}.border-gray-600{--tw-border-opacity: 1;border-color:rgb(75 85 99 / var(--tw-border-opacity, 1))}.border-gray-700{--tw-border-opacity: 1;border-color:rgb(55 65 81 / var(--tw-border-opacity, 1))}.border-purple-400{--tw-border-opacity: 1;border-color:rgb(192 132 252 / var(--tw-border-opacity, 1))}.border-red-500{--tw-border-opacity: 1;border-color:rgb(239 68 68 / var(--tw-border-opacity, 1))}.border-red-700{--tw-border-opacity: 1;border-color:rgb(185 28 28 / var(--tw-border-opacity, 1))}.bg-black{--tw-bg-opacity: 1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-blue-500{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-blue-800\/20{background-color:#1e40af33}.bg-blue-800\/50{background-color:#1e40af80}.bg-gray-600\/30{background-color:#4b55634d}.bg-gray-700{--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.bg-gray-800{--tw-bg-opacity: 1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.bg-gray-900{--tw-bg-opacity: 1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-purple-600{--tw-bg-opacity: 1;background-color:rgb(147 51 234 / var(--tw-bg-opacity, 1))}.bg-purple-700{--tw-bg-opacity: 1;background-color:rgb(126 34 206 / var(--tw-bg-opacity, 1))}.bg-purple-900\/20{background-color:#581c8733}.bg-purple-900\/30{background-color:#581c874d}.bg-red-700{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.bg-red-800{--tw-bg-opacity: 1;background-color:rgb(153 27 27 / var(--tw-bg-opacity, 1))}.bg-red-900{--tw-bg-opacity: 1;background-color:rgb(127 29 29 / var(--tw-bg-opacity, 1))}.bg-teal-700{--tw-bg-opacity: 1;background-color:rgb(15 118 110 / var(--tw-bg-opacity, 1))}.bg-transparent{background-color:transparent}.bg-yellow-900\/30{background-color:#713f124d}.bg-opacity-30{--tw-bg-opacity: .3}.bg-opacity-50{--tw-bg-opacity: .5}.p-0{padding:0}.p-1{padding:.25rem}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0\.5{padding-top:.125rem;padding-bottom:.125rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.pl-1{padding-left:.25rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.lowercase{text-transform:lowercase}.italic{font-style:italic}.text-blue-100{--tw-text-opacity: 1;color:rgb(219 234 254 / var(--tw-text-opacity, 1))}.text-blue-200{--tw-text-opacity: 1;color:rgb(191 219 254 / var(--tw-text-opacity, 1))}.text-blue-300{--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.text-gray-100{--tw-text-opacity: 1;color:rgb(243 244 246 / var(--tw-text-opacity, 1))}.text-gray-200{--tw-text-opacity: 1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.text-gray-300{--tw-text-opacity: 1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-purple-300{--tw-text-opacity: 1;color:rgb(216 180 254 / var(--tw-text-opacity, 1))}.text-purple-400{--tw-text-opacity: 1;color:rgb(192 132 252 / var(--tw-text-opacity, 1))}.text-purple-600{--tw-text-opacity: 1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.text-red-100{--tw-text-opacity: 1;color:rgb(254 226 226 / var(--tw-text-opacity, 1))}.text-red-400{--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.opacity-50{opacity:.5}.shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.ring{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-1{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-purple-500{--tw-ring-opacity: 1;--tw-ring-color: rgb(168 85 247 / var(--tw-ring-opacity, 1))}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.duration-150{transition-duration:.15s}::-webkit-scrollbar{width:8px;height:8px}::-webkit-scrollbar-track{background:#1e293b}::-webkit-scrollbar-thumb{background:#475569;border-radius:4px}::-webkit-scrollbar-thumb:hover{background:#64748b}::-webkit-scrollbar-corner{background:#1e293b}.sticky{position:sticky;z-index:10}.grid-container{height:calc(100vh - 100px);overflow:auto}.fixed-horizontal-scrollbar{position:absolute;bottom:0;left:0;right:0;height:8px;overflow-x:auto;overflow-y:hidden;z-index:20}.fixed-vertical-scrollbar{position:absolute;top:0;right:0;bottom:0;width:8px;overflow-y:auto;overflow-x:hidden;z-index:20}.cell-marked-for-cut{outline:2px dashed #8B5CF6!important;outline-offset:-2px;background-color:#8b5cf61a}.hover\:bg-gray-600:hover{--tw-bg-opacity: 1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-700:hover{--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.hover\:bg-green-700:hover{--tw-bg-opacity: 1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-700:hover{--tw-bg-opacity: 1;background-color:rgb(126 34 206 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-800:hover{--tw-bg-opacity: 1;background-color:rgb(107 33 168 / var(--tw-bg-opacity, 1))}.hover\:bg-red-800:hover{--tw-bg-opacity: 1;background-color:rgb(153 27 27 / var(--tw-bg-opacity, 1))}.hover\:bg-teal-800:hover{--tw-bg-opacity: 1;background-color:rgb(17 94 89 / var(--tw-bg-opacity, 1))}.hover\:text-gray-300:hover{--tw-text-opacity: 1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.hover\:text-red-300:hover{--tw-text-opacity: 1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.hover\:text-red-400:hover{--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.hover\:text-white:hover{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.focus\:border-purple-500:focus{--tw-border-opacity: 1;border-color:rgb(168 85 247 / var(--tw-border-opacity, 1))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-purple-700:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(126 34 206 / var(--tw-ring-opacity, 1))}</style>
  </head>
  <body>
    <div id="root"></div>
  </body>
</html>
